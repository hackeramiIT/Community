#CMS

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione]]
- [[#File di Configurazione]]
    1. [[#Credenziali]]
- [[#Versioni Vulnerabili]]

---

---

---
### Introduzione
*Magento* è una piattaforma open-source per e-commerce scritta in PHP, molto usata in ambito enterprise. Magento offre un'infrastruttura potente ma complessa, che può introdurre una superficie d’attacco estesa, specialmente se l’istanza non è aggiornata, espone interfacce admin o API, o presenta moduli di terze parti vulnerabili.

Magento è stato più volte oggetto di vulnerabilità critiche con impatto RCE, SQLi, deserialization, e path traversal.

Il pannello admin è solitamente accessibile su URL personalizzabile, ma default `/admin`, `/backend` o simili.

---
### Enumerazione
Per l'enumerazione si consiglia il tool [magescan](https://github.com/steverobbins/magescan):

```
php magescan.phar scan:all http://IP_TARGET
```

---
### File di Configurazione
##### Credenziali
Magento salva le configurazioni principali in `/var/www/html/magento/app/etc/env.php`, spesso leggibile localmente su host compromesso.

---
### Versioni Vulnerabili

Magento ha una lunga storia di vulnerabilità critiche, spesso sfruttate da botnet e gruppi come _MageCart_. Di seguito alcune delle CVE più note:

| **Versione / Componente** | **CVE**       | **Writeup**                    |
| ------------------------- | ------------- | ------------------------------ |
| SUPEE-5344                | CVE-2015-1397 | [[Linux#Swagshop\| SwagShop]] |
