#Exploitation_porte

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione Utenti]]
- [[#Invio Email Non Autenticato]]
- [[#Invio Email Da Autenticato]]
- [[#Allegato Malevolo]]

---
---
---
### Introduzione
*SMTP (Simple Mail Transfer Protocol)* Ã¨ il protocollo utilizzato per l'invio di email. Opera sulla porta TCP/25, anche se puÃ² usare la 465 (SMTPS) o 587 (STARTTLS) per trasmissioni cifrate e autenticazione.  
Durante un penetration test, il servizio SMTP puÃ² essere utile per enumerare utenti, testare vulnerabilitÃ  di relay, effettuare spoofing, o in certi casi anche per ottenere una shell remota tramite abusi creativi.

---
### Enumerazione Utenti
Molti server SMTP permettono lâ€™enumerazione degli utenti locali tramite comandi come `VRFY`, `EXPN`, o `RCPT TO`. Per automatizzare il processo si consiglia l'uso di [smtp-user-enum.pl](https://github.com/pentestmonkey/smtp-user-enum/blob/master/smtp-user-enum.pl):

```
perl smtp-user-enum.pl -M VRFY -U names.txt -t IP_TARGET
```

```
nmap -p 25 --script smtp-enum-users target.com
```

Writeups:
- *Linux:*[[Linux#Postfish| Postfish]],
- *Windows:*[[Windows#Hepet| Hepet]],

---
### Invio Email Non Autenticato
In scenari in cui non Ã¨ richiesto autenticarsi, Ã¨ possibile inviare email fittizie o con contenuti dannosi:

```
telnet target.com 25 HELO attacker.com MAIL FROM:<admin@target.com> RCPT TO:<victim@target.com> DATA Subject: Alert You have been hacked! .
```

PuÃ² essere utile per *simulare phishing*, testare alert spoofing o capire le policy DMARC/SPF.

---
### Invio Email Da Autenticato
Se si hanno le credenziali si puÃ² effettuare il login ed inviare email ad altri utenti:

```
swaks --auth-user 'administrator@mailing.htb' --auth LOGIN --auth-password homenetworkingadministrator --quit-after AUTH --server mailing.htb
```

ðŸ“š Writeups:
- *Windows*[[Windows#Mailing| Mailing]],

---
### Allegato Malevolo
Se il server non ha controlli su `MAIL FROM`, Ã¨ possibile falsificare il mittente. Combinato con social engineering o phishing, puÃ² ingannare utenti interni.

```
sendemail -s DOMAIN -f "from_user <from_user@domain>" -t to_user@domain -o tls=no -m "LETTER" -a FILE.format
```

ðŸ“š Writeups:
- *Windows:*[[Windows#Job| Job]],[[Windows#Job2| Job2]],