---

---
#Exploitation_porte

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Login Anonimo]]
- [[#Bruteforce]]
- [[#Download]]
- [[#Upload File Malevoli]]
- [[#Directory Traversal]]
- [[#SSRF]]
- [[#Versioni Vulnerabili]]

---
---
---
### Introduzione
*FTP (File Transfer Protocol)* Ã¨ un protocollo standard utilizzato per il trasferimento di file tra client e server. Opera di default sulla porta TCP/21, mentre la porta 20 viene usata per il canale dati in modalitÃ  attiva.
Sebbene sia ancora largamente utilizzato in ambienti legacy, FTP presenta numerose debolezze che lo rendono un bersaglio frequente durante un penetration test.

---
### Login Anonimo
Molti server FTP permettono il login senza credenziali, offrendo spesso accesso in lettura e talvolta anche in scrittura:
 1. `anonymous:anonymous`
 2. `anonymous:`
 3. `ftp:ftp`

ðŸ“š Writeups:
- *Windows:*[[Windows#Netmon| Netmon]],

---
### Bruteforce
Se le credenziali sono deboli possono essere ottenute tramite bruteforce:

```
hydra -l admin -P ./rockyou.txt ftp://target.com
```

In caso si abbia una wordlist di utenti candidata od Ã¨ possibile utilizzarne una [standard](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt). 

---
### Download
In alcuni casi Ã¨ possibile ottenere dati sensibili o file importanti.

```
get file
```

```
wget --no-passive-ftp -r ftp://anonymous:anonymous@IP_TARGET/
```

ðŸ“š Writeups:
- *Linux:*[[Linux#SpiderSociety| SpiderSociety]],[[Linux#Boiler CTF| Boiler CTF]],
- *Windows:*[[Windows#ServerMon| ServerMon]],

---
### Upload File Malevoli
Se l'utente ha permessi in scrittura Ã¨ possibile caricare file malevoli (es:[[ðŸ”¡ Glossario#Reverse shell| reverse shellÂ°]]), chiavi pubbliche SSH:

```
put shell.php
```

ðŸ“š Writeups:
- *Linux:*[[Linux#Sybaris| Sybaris]],[[Linux#Sync| Sync]],
- *Windows:*[[Windows#Devel| Devel]],

---
### Directory Traversal
Alcuni server FTP mal configurati permettono di navigare *fuori dalla root (chroot jail)* usando `../`, accedendo ad aree del filesystem che dovrebbero essere protette:

```
cd ../../../../etc/
get passwd
```

---
### SSRF
Nel si abbia la possibilitÃ  di manipolare le richieste del server, il servizio FTP potrebbe essere uno dei primi punti d'attacco.

```
http://example.com/upload?u=ftp://USER:PASS@example.com/.ssh/id_rsa
```

ðŸ“š Writeups:
- *Linux:*[[Linux#Forge| Forge]],

---
### Versioni Vulnerabili
Alcune versioni dell'FTP hanno una[[ðŸ”¡ Glossario#CVE| CVEÂ°]] associata:

| **Versione**          | **CVE**                                                    | **Writeups**                |
| --------------------- | ---------------------------------------------------------- | --------------------------- |
| ProFTPD 1.3.5         | [CVE-2015-3306](https://www.exploit-db.com/exploits/36742) | [[Linux#Kenobi\| Kenobi]], |
| FileZilla 0.9.41 beta | [github](https://github.com/NeoTheCapt/FilezillaExploit)   |                             |
