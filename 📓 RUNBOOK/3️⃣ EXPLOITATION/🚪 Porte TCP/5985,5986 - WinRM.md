
#Exploitation_porte

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione WinRM]]
- [[#Bruteforce]]
- [[#Accesso con Credenziali o Hash]]

---
---
---
### Introduzione
*WinRM (Windows Remote Management)* √® un protocollo Microsoft basato su SOAP/HTTP che permette di eseguire comandi su un host remoto via PowerShell.  
Opera di default sulle porte:
- TCP/5985 ‚Üí HTTP (plaintext, ma usato con autenticazione NTLM o Kerberos)
- TCP/5986 ‚Üí HTTPS (pi√π sicuro, ma spesso disabilitato o mal configurato)
Durante un penetration test, WinRM √® un'ottima via per [[üìì RUNBOOK/5Ô∏è‚É£ MOVIMENTI LATERALI/Active Directory]], esecuzione remota, e persino [[0. Post Exploitation| privilege escalation]].

Si pu√≤ vedere il suo utilizzo nei writeup di [[üìö WRITEUPS/üåç Ambienti/Active Directory]].

---
### Enumerazione WinRM
Verifica se WinRM √® attivo:

```
nmap -p 5985,5986 --script http-winrm-info target.com
```

---
### Bruteforce

```
hydra -L users.txt -P passwords.txt -s 5985 -V target.com http-winrm
```

---
### Accesso con Credenziali o Hash
WinRM supporta anche autenticazione tramite hash NTLM:

```
evil-winrm -i target.com -u user -H <NTLM_HASH>
```

‚ö†Ô∏è Solo se il server *permette NTLM* (non sempre attivo su ambienti con Kerberos-only)