#Exploitation_porte

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Comandi]]
- [[#Connessione]]
- [[#Login con Credenziali Deboli]]
- [[#Bruteforce POP3]]
- [[#Spoofing o MITM (STARTTLS downgrade)]]
- [[#Versioni Vulnerabili]]

---
---
---
### Introduzione
_POP3 (Post Office Protocol v3)_ è un protocollo usato dai client email per recuperare i messaggi da un server di posta. Opera sulla porta **TCP/110** per connessioni non cifrate, e sulla **porta 995** se si utilizza _POP3S_ (con SSL/TLS).

In fase di penetration test, un servizio POP3 esposto può offrire vari vettori di attacco, specialmente se non cifrato o se mal configurato.

---
### Comandi

| Comando  | Descrizione                      |
| -------- | -------------------------------- |
| `USER`   | Specifica lo username            |
| `PASS`   | Specifica la password            |
| `LIST`   | Elenca i messaggi disponibili    |
| `RETR n` | Recupera il messaggio numero _n_ |
| `DELE n` | Cancella il messaggio numero _n_ |
| `QUIT`   | Termina la sessione POP3         |

---
### Connessione
Un semplice banner grabbing può rivelare il software usato e la versione:

```
telnet target.com 110
```

---
### Login con Credenziali Deboli
Dopo l'autenticazione è possibile trovare informazioni sensibili. Per l'autenticazione utilizziamo:

```
USER username PASS password`
```

```
LIST RETR 1 #Lista messaggi
```

Writeups:
- *Linux:*[[Linux#Postfish| Postfish]],

---
### Bruteforce POP3
È possibile forzare le credenziali tramite tool automatici:

```
hydra -l user -P rockyou.txt pop3://target.com
```

```
medusa -h target.com -u user -P wordlist.txt -M pop3
```

