
---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione Community]]
- [[#Tools]]
- [[#User Listing]]
- [[#Routing e Interfacce]]
- [[#Download Configurazioni]]
- [[#OID Sensibili]]
- [[#Config Files]]

---
---
---
### Introduzione
*SNMP (Simple Network Management Protocol)* Ã¨ un protocollo usato per monitorare e gestire dispositivi di rete (router, switch, server). La versione 2c, ancora ampiamente utilizzata, non prevede crittografia ed Ã¨ accessibile tramite una semplice **community string**.

SNMP opera solitamente sulla porta **UDP/161**, ed Ã¨ spesso trascurato nella fase di hardening. Questo lo rende un ottimo vettore per **enumerazione informativa** e potenziale **exfiltrazione di credenziali, utenti e configurazioni**.

---
### Enumerazione Community
Lâ€™enumerazione iniziale serve a identificare **community strings** attive (es. `public`, `private`, `openview`).

```
onesixtyone -c community_list.txt -i targets.txt
snmp-check -t IP_TARGET -c public
```

Strumenti alternativi:

```
snmpenum
snmpwalk
snmpbulkwalk
```

ðŸ“š Writeups:
- *Linux:*[[Linux#ClamAV| ClamAV]],[[Linux#Pit| Pit]],

---
### Tools
Per enumerare il servizio in automatico possiamo scaricare [snmpbrute](https://github.com/SECFORCE/SNMP-Brute):

```
python3 snmpbrute.py -t IP_TARGET
```

ðŸ“š Writeups:
- *Linux:*[[Linux#Mentor| Mentor]]

---
### User Listing
Molti sistemi Windows esportano gli utenti locali attraverso il ramo SNMP 1.3.6.1.4.1.77.1.2.25. Questi possono essere decodificati come nomi ASCII:

```
snmpwalk -v2c -c public IP_TARGET 1.3.6.1.4.1.77.1.2.25
```

Output tipico:

```
iso.3.6.1.4.1.77.1.2.25.1.1.5.71.117.101.115.116 = STRING: "Guest"
```

ðŸ“š Writeups:
- *Linux:*[[Linux#Pandora| Pandora]],[[Linux#Underpass| Underpass]],
- *Windows:*[[Windows#Year of the Owl| Year Of The Owl]],

---
### Routing e Interfacce
Puoi elencare interfacce, IP assegnati, e tabelle di routing:

```
snmpwalk -v2c -c public 10.10.10.1 1.3.6.1.2.1.4.21        # Routing Table
snmpwalk -v2c -c public 10.10.10.1 1.3.6.1.2.1.2.2.1.2     # Interface Names
snmpwalk -v2c -c public 10.10.10.1 1.3.6.1.2.1.4.20        # IPs
```

PuÃ² aiutare per:

- mappatura della rete interna
- pivoting
- IP discovery

---
### Download Configurazioni
Alcuni dispositivi (es. router Cisco) permettono il dump di configurazioni:

```
snmpwalk -v2c -c public IP_TARGET 1.3.6.1.4.1.9.2.1.53    # config file
snmpwalk -v2c -c public IP_TARGET 1.3.6.1.4.1.9.2.1.55.1  # config text
```

---
### OID Sensibili
Gli OID seguenti possono contenere dati critici:

|**OID**|**Descrizione**|
|---|---|
|`1.3.6.1.2.1.25.4.2.1.2`|Processi in esecuzione|
|`1.3.6.1.2.1.25.6.3.1.2`|Software installato|
|`1.3.6.1.2.1.25.1.6`|Utenti loggati|
|`1.3.6.1.2.1.1.5.0`|Hostname|
|`1.3.6.1.2.1.1.6.0`|Location|

```
snmpwalk -v2c -c public 10.10.10.1 1.3.6.1.2.1.25.4.2.1.2
```

---
### Config Files
I file di configurazione `/ect/snmp/snmpd.conf` spesso contiene delle credenziali utilizzate per il servizio. 