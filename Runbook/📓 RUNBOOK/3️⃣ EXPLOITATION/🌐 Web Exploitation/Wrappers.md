
---
---
---
#### INDICE

- [[#Introduzione]]
- [[#file://]]
- [[#php://filter]]
- [[#phar://]]
- [[#zip://]]
- [[#data://]]

---
---
---
### Introduzione
I _PHP stream wrappers_ sono protocolli virtuali supportati da PHP che permettono di accedere a risorse locali o remote tramite funzioni standard (`fopen`, `file_get_contents`, `include`, ecc.).

Alcuni di questi wrapper possono essere abusati in fase di penetration test per:

- Leggere file locali non direttamente accessibili (_Local File Inclusion_ â†’ LFI).
- Ottenere lâ€™esecuzione di codice tramite **deserializzazione** o **code injection**.
- Aggirare filtri basati su estensioni o percorsi.

---
### file://
Accesso diretto al filesystem locale.

`file:///etc/passwd`

Utile in LFI per forzare percorsi assoluti.

---
### php://filter
Permette di applicare filtri di codifica/decodifica durante la lettura di un file.  Per esempio estrarre codice sorgente PHP senza eseguirlo

```
php://filter/convert.base64-encode/resource=index.php
```

Sfruttabile per leggere sorgenti sensibili senza eseguirli.

---
### phar://
Consente di accedere a file interni ad un archivio PHAR/ZIP/TAR.  
Durante lâ€™accesso, PHP deserializza automaticamente i metadata con la possibilitÃ  di RCE se contengono oggetti malevoli.

`phar:///var/www/uploads/avatar.jpg`

Sfruttabile anche se il file caricato ha un'estensione diversa dal PHP.

ðŸ“š Writeups:
- *Linux:*[[Linux#UpDown| UpDown]],

---
### zip://
Permettono di navigare archivi compressi come filesystem virtuali.

`zip:///var/www/uploads/archive.zip%23file.php`

Il simbolo `%23` rappresenta `#`, usato per separare il nome dellâ€™archivio dal file interno.

---
### data://
Permette di passare dati inline come stream.  
PuÃ² essere usato per iniettare codice:

`data://text/plain,<?php system('id'); ?>`

Spesso sfruttabile in combinazione con `include` se non ci sono controlli sui protocolli.

