#Exploit_noti 

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Metacaratteri da usare]]
- [[#Command Injection diretta]]
- [[#Command Injection Concatenata]]
- [[#Command Injection cieca]]
    - [[#Delay-based]]
    - [[#Output redirection]]
    - [[#Out-of-band (OAST)]] 

---
---
---
### Introduzione
La **Command Injection**, o piÃ¹ precisamente **OS Command Injection**, Ã¨ una vulnerabilitÃ  che permette a un attaccante di eseguire comandi arbitrari sul sistema operativo del server che ospita l'applicazione web. Questo tipo di vulnerabilitÃ  Ã¨ tra i piÃ¹ critici, in quanto puÃ² portare a compromissione completa del server.

> [!ATTENTION]
 In molti casi, lâ€™attaccante puÃ² sfruttare questa falla per ottenere una [[ðŸ”¡ Glossario#Reverse shell| reverse shellÂ°]].
Durante questo tipo di attacco Ã¨ fondamentale capire che tipo di linguaggio esegue la macchina (es: lua, puthon, PHP, ecc.)

---
### Metacaratteri da usare
Per concatenare comandi nelle shell:

| Simbolo  | Supporto       | Effetto                                     |
| -------- | -------------- | ------------------------------------------- |
| `&`      | Windows + Unix | Separatore di comandi                       |
| `&&`     | Entrambi       | Esegue secondo solo se il primo ha successo |
| `        | `              | Entrambi                                    |
| `        |                | `                                           |
| `;`      | Solo Unix      | Separatore comandi                          |
| `\n`     | Solo Unix      | Newline                                     |
| `cmd`    | Solo Unix      | Esegue cmd inline                           |
| `$(cmd)` | Solo Unix      | Esegue cmd inline                           |

---
### Command Injection Diretta
Alcuni parametri eseguono comandi all'interno della macchina, capire il loro funzionamento puÃ² aiutare un attaccante ad eseguire l'attacco.

```
http://site.com?curl=whoami
```

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Hairct| Haircut]],[[Linux#Hetemi| Hetemit]],[[Linux#Wallpaper Hub| Wallpaper Hub]],[[Linux#ScriptKiddies| Scrip]]

---
### Command Injection Concatenata
Questa si verifica quando lâ€™input dellâ€™utente viene inserito direttamente in una chiamata a un comando del sistema operativo senza validazione.

```
http://site.com?storeID=29&whoami
```

> Il simbolo `&` permette di concatenare comandi nella shell.

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Cronos| Cronos]],[[Linux#Luane| Luane]],

---
### Command Injection cieca (Blind)
Quando lâ€™output del comando **non viene restituito** nella risposta HTTP, ma il comando **viene comunque eseguito** sul sistema. In questi casi, si usano tecniche alternative per confermare l'esecuzione.

##### Delay-based
Usa comandi che **introducono un ritardo** misurabile nella risposta.

```
& ping -c 10 127.0.0.1 && sleep 5 &      #Linux
```

```
& timeout /T 5 &        #Windows
```

Se la risposta HTTP ritarda di *circa 5 o 10 secondi*, Ã¨ segno che lâ€™iniezione ha avuto successo.

---
##### Output redirection
Utile nei casi in cui il server serve file statici da una cartella nota.

```
& whoami > /var/www/static/whoami.txt &
```

Poi accedi via browser a:

```
https://target.com/static/whoami.txt
```

---
### Automatizzato
Consideriamo solo quelle risposte che restituiscono risposte diverse dallo standard.

```
wfuzz -u http://site.com?file=img.jpgFUZZ -w ./special-chars.txt
```
