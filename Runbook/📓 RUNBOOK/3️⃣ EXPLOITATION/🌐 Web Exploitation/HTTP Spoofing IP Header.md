#Exploit_noti 

- [[#Typical Headers]]
# Descrizione
Alcuni server **si fidano** di certi header per capire chi sta facendo la richiesta o da dove viene.  
Se possiamo modificarli, possiamo ingannare il server (**spoofing**), facendo finta di:
- essere **un IP di fiducia** (es: `127.0.0.1`)
- essere **un utente autenticato**
- essere **un proxy trusted**

In questo modo è possibile bypassare controlli ed accedere a risorse interne ([[Disclosure Information]]).

# Typical Headers

| **Header**                  | **Descrizione**                                                | **Writeup**                                                                                                       |
| --------------------------- | -------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| `X-Forwarded-For`           | Dichiarato da proxy o client per dire "il mio IP è..."         |                                                                                                                   |
| `X-Real-IP`                 | Alternativa meno standard per comunicare l'IP reale            |                                                                                                                   |
| `X-Client-IP`               | Identifica l'IP originario del client                          |                                                                                                                   |
| `Forwarded`                 | Header più recente, RFC 7239, standardizzato per IP forwarding |                                                                                                                   |
| `True-Client-IP`            | Usato da alcuni CDN (tipo Akamai) per passare l'IP reale       |                                                                                                                   |
| `X-Custom-IP-Authorization` | A volte applicazioni custom si inventano header interni!       | [link](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass) |
| `CF-Connecting-IP`          | Cloudflare passa l'IP reale qui                                |                                                                                                                   |
| `X-Originating-IP`          | Alcuni mail server o applicazioni web lo usano                 |                                                                                                                   |
