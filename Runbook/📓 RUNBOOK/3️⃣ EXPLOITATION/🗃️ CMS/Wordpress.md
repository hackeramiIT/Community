#CMS

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione Utenti]]
- [[#Bruteforce]]
- [[#Plugin Vulnerabili]]
- [[#Upload File Malevoli]]
- [[#File di Configurazione]]
	1. [[#Credenziali]]
	2. [[#Cracking]]
- [[#Versioni Vulnerabili]]

---

---

---
### Introduzione
_WordPress_ Ã¨ uno dei CMS (Content Management System) piÃ¹ diffusi al mondo. Per questo motivo Ã¨ un bersaglio comune durante un penetration test. Le sue vulnerabilitÃ  derivano spesso da plugin obsoleti o mal configurati, temi non sicuri, o da una scarsa attenzione alla gestione degli utenti.

Accessibile via HTTP/HTTPS, e amministrabile tramite `/wp-admin`.

---
### Enumerazione Utenti
WordPress consente lâ€™enumerazione dei nomi utente in diversi modi. I piÃ¹ comuni:

```
wpscan --url http://target.com --enumerate u
```

---
### Bruteforce
Conoscendo i nomi utente, Ã¨ possibile tentare un attacco di forza bruta tramite WPScan, Hydra o Burp Suite:

```
wpscan --url http://target.com --usernames admin --passwords ./rockyou.txt
```

ðŸ“š Writeups:
- *Linux:*[[Linux#Loly| Loly]],

---
### Plugin Vulnerabili
Lâ€™ecosistema WordPress Ã¨ vasto ma spesso afflitto da vulnerabilitÃ  legate a plugin di terze parti.

ðŸ“š Writeups:
- *Linux:*[[Linux#Stapler| Stapler]],

---
### Upload File Malevoli
Se il sito consente upload (es. in un plugin, nel tema o nel profilo utente), si puÃ² provare a caricare una [[ðŸ”¡ Glossario#Reverse shell| reverse shellÂ°]] ed a tal proposito si rimanda alla sezione [[File Upload]] nel caso sia un utente con bassi privilegi, altrimenti a questa [guida](https://medium.com/@akshadjoshi/from-wordpress-to-reverse-shell-3857ee1f4896) nel caso si abbiano i privilegi come amministratore. Scritture su `/wp-content/uploads/` sono comuni.

ðŸ“š Writeups:
- _Linux:_[[Linux#MrRobot| MrRobot]],[[Linux#Internal| Internal]],[[Linux#Stapler| Stapler]],

---
### File di Configurazione
##### Credenziali
Uno degli obiettivi piÃ¹ comuni durante un penetration test su WordPress Ã¨ lâ€™accesso al file di configurazione principale: `wp-config.php`. Questo file si trova solitamente nella root del sito (`/var/www/html/` o `/htdocs/`) e contiene informazioni sensibili tra cui:

```
define('DB_NAME', 'wordpress');
define('DB_USER', 'wp_user'); 
define('DB_PASSWORD', 'password123'); 
define('DB_HOST', 'localhost');
```

Effettuare l'accesso al database:

```
mysql -u user -p
```

ðŸ“š Writeups:
- *Linux:*[[Linux#Loly| Loly]],
##### Cracking
Nel caso in cui la password sia hashata (ad esempio nelle tabelle `wp_users` di MySQL, dove Ã¨ archiviata come `MD5` o `bcrypt`), Ã¨ possibile effettuare un attacco dizionario con `hashcat` o `john`:

```
john --wordlist=rockyou.txt --format=Wordpress hashes.txt
```

ðŸ“šâ€‹ Writeups:
- *Linux:*[[Linux#Blocky| Blocky]],

---
### Versioni Vulnerabili
Anche il core di WordPress ha avuto CVE assegnate. Ãˆ fondamentale identificare la versione installata:

| **Versione/Plugins**        | **CVE** | **Writeup**                  |
| --------------------------- | ------- | ---------------------------- |
| AdRotate                    |         | [[Linux#Loly\| Loly]]       |
| Advanced Video Embedded 1.0 |         | [[Linux#Stapler\| Stapler]] |


Scritture utili:
- _Linux:_[[Linux#Blog| Blog]],[[Linux#Wordy| Wordy]],

