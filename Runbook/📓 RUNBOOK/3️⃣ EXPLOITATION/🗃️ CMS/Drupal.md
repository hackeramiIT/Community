#CMS

---
---
---
#### INDICE

- [[#Introduzione]]
- [[#Enumerazione]]
- [[#Plugin vulnerabili]]
- [[#File di Configurazione]]
    1. [[#Credenziali]]
    2. [[#Cracking]]
- [[#Versioni Vulnerabili]]

---

---

---
### Introduzione
_Drupal_ Ã¨ un CMS open-source modulare e flessibile, scritto in PHP, utilizzato per la realizzazione di siti web dinamici e scalabili. Ãˆ frequentemente target di attacchi, specialmente quando non aggiornato o mal configurato. Drupal espone una CLI (`drush`) e un'interfaccia di amministrazione accessibile via `/user/login` o `/admin`.

---
### Enumerazione
Per il servizio Ã¨ consigliato l'utilizzo del tool [droopescan](https://github.com/SamJoan/droopescan):

```
droopescan scan drupal -u http://target.com
```

---
### Plugin Vulnerabili
Joomla! fa uso di plugin, delle volte obsoleti e ciÃ² puÃ² indure un attaccante a trovare un exploit.

---
### File di Configurazione
##### Credenziali
Il file di configurazione principale Ã¨ `/var/www/html/drupal/sites/default/settings.php`. All'interno si trovano le credenziali del DB e il `hash_salt`.

ðŸ“š Writeups:
- _Linux:_[[Linux#Armageddon| Armageddon]],

##### Cracking
Le password degli utenti Drupal sono salvate nella tabella `users_field_data`, campo `pass`, in formato `PHPPass`.

```
john --format=Drupal7 --wordlist=rockyou.txt hashes.txt
```

```
hashcat -m 7900 drupal_hashes.txt rockyou.txt
```

---
### Versioni Vulnerabili
Le versioni di Drupal hanno avuto **CVE critiche**, tra cui la famigerata _Drupalgeddon_.

| **Versione** | **CVE**       | **Writeup**                                                      |
| ------------ | ------------- | ---------------------------------------------------------------- |
| Drupal < 8   | CVE-2018-7600 | [[Linux#Armageddon\| Armageddon]],[[Linux#Bastard\| Bastard]], |
