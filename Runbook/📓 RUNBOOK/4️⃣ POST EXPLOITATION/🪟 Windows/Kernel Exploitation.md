#Privesc_Windows 

---
#### INDICE

- [[#Introduzione]]
- [[#Versione]]
- [[#Driver]]

---
---
---
### Introduzione
La **Windows Kernel Exploitation** consiste nello sfruttamento di vulnerabilità nel kernel di Windows (o in suoi componenti caricabili, come i driver) al fine di ottenere **privilegi SYSTEM** a partire da un contesto utente limitato. 

---
### Driver
Per verificare la versione del kernel e il tipo di sistema in uso:

```
systeminfo
```

Verifica se la versione di Windows è affetta da CVE note su internet.

In caso possiamo anche avvalerci del tool 

```
wes.py --os-info "Windows 10 10.0.19041"
```

Questa tecnica prevede l’**upload e caricamento di un driver legittimo ma vulnerabile** per ottenere accesso in scrittura sul kernel.

Per verificare eventuali driver caricati o potenzialmente vulnerabili:

```
driverquery /v /fo list sc query type= driver
```

Raccolta di informazioni specifiche:

`whoami /groups whoami /priv accesschk.exe -uwcqv "Everyone" *`

1. Carica driver vulnerabile (es. `RTCore64.sys`):

```
sc create vulnerableDriver type= kernel binPath= "C:\Users\pentester\Desktop\<vulnerableDriver.sys>"
sc start vulnerableDriver
```

2. Esegui exploit che sfrutta il driver per modificare token o EPROCESS list:

```
exploit-vulnerableDriver.exe --elevate
```
